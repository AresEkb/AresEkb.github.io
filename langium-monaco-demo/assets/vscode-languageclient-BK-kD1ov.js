import{r as Z}from"./vscode-lsp-Cixq1BNr.js";import{g as yr}from"./react-B5nPjNA6.js";import"./langium-5XF2oqgV.js";import{U as Tn,gt as Ln,gu as vr,gv as Sr,gw as Dr,bi as Tr,eU as Rr,gp as _r,gk as br,t as wr,gj as Pr,gi as xr,f7 as Fr,gm as kr,eQ as Ir,eP as Er,em as qr,eH as Lr,eE as Or,eD as Mr,gl as Hr,eC as $r,c1 as Kr,cd as Ar,c5 as On,cq as Nr,cj as Wr,cD as Ur,cz as zr,ci as jr,cl as Br,cB as Vr,cF as Qr,cg as Gr,ck as Yr,cf as Xr,eG as Jr,cm as Zr,cn as Mn,eF as eo,ce as to,c7 as no,ch as io,ca as ro,gn as oo,bV as so,bW as ao,gh as co,bU as uo,bK as lo,bI as go,gg as fo,ea as ho,gf as po,ge as mo,cO as Co,cM as yo,cK as vo,cN as So,gd as Do,gc as To,gb as Ro,bF as _o,ga as bo,C as wo,a8 as Po,dr as xo,eX as Fo,b5 as ko,a$ as Io,b7 as Eo,b6 as qo,g9 as Lo,a_ as Oo,b4 as Mo,b3 as Ho,g8 as $o,eT as Ko,g7 as Ao,g6 as No,g5 as Wo,cU as Uo,g4 as zo,D as jo,fl as Bo,ds as Vo,g3 as Qo,g2 as Go,g0 as Yo,fk as Xo,fm as Jo,d1 as Zo,J as es,a4 as ts,f$ as ns,E as is,eu as rs,az as os,ay as ss,fe as as,fX as cs,cY as us,aT as ls,c as Hn,F as ds,fW as gs,fV as fs,aY as hs,fS as ps,fQ as ms,fj as Cs,fh as ys,fi as vs,eJ as Ss,fU as Ds,fT as Ts,dg as Rs,eo as _s,dk as bs,fY as ws,f_ as Ps,fZ as xs,e3 as Fs,eI as ks,eB as Is,eA as Es,at as qs,es as Ls,aw as Os,as as Ms,ev as Hs,er as $s,av as Ks,au as As,ex as Ns,ew as Ws,ez as Us,ey as zs,dE as js,f1 as Bs,L as Vs,aD as Qs,cI as Gs,el as Ys,ek as Xs,g1 as Js,eq as Zs,ep as ea,c_ as ta,dS as na,d_ as ia,fc as ra,dU as oa,f8 as sa,f9 as aa,f6 as ca,f5 as ua,d$ as la,fb as da,f4 as ga,dM as fa,f3 as ha,N as pa,fa as ma,dY as Ca,fP as ya,eK as va,f2 as Sa,fO as Da,P as Ta,et as Ra,a5 as _a,fN as ba,fM as wa,e1 as Pa,e2 as xa,R as Fa,eN as ka,fL as Ia,aB as Ea,fg as qa,S as La,bw as Oa,bE as Ma,fK as Ha,d8 as $a,d7 as Ka,bC as Aa,ej as Na,a6 as Wa,fJ as Ua,fI as za,fH as ja,fG as Ba,df as Va,fp as Qa,aX as Ga,ff as Ya,eM as Xa,dC as Ja,eV as Za,e5 as ec,bS as tc,fF as nc,fE as ic,d0 as rc,ag as oc,am as sc,ah as ac,ak as cc,aj as uc,ai as lc,ao as dc,af as gc,an as fc,ae as hc,al as pc,a9 as mc,aa as Cc,fC as yc,fB as vc,a7 as Sc,ft as Dc,fs as Tc,fv as Rc,fA as _c,fx as bc,go as wc,fw as Pc,fy as xc,fz as Fc,bk as kc,eW as Ic,e$ as Ec,e_ as qc,f0 as Lc,eY as Oc,aP as Mc,eZ as Hc,cX as $c,fq as Kc,cW as Ac,e8 as Nc,fo as Wc,Q as Uc,e7 as zc,en as jc,b as Bc,T as Vc,eL as Qc,e4 as Gc,b9 as Yc,fd as Xc,ed as Jc,ec as Zc,ee as eu,v as tu,fR as nu,fn as iu,cZ as ru}from"./monaco-vscode-api-CofsR7n8.js";import{a1 as ou,ls as bn,lt as Vi,_ as su,o as Ye,il as au,a0 as cu,bb as uu,aP as lu,mM as du,nY as gu,c4 as fu,cZ as hu,v$ as pu,E as mu,aS as Cu,o1 as $n,U as Rn,o2 as yu,o3 as vu,bM as Kn,nO as Su,Y as Du,cG as Tu,bn as Ru,C as _u,a5 as bu,am as wu,F as Pu,aR as xu,sk as Fu,qW as ku,gT as Iu,d3 as Eu}from"./monaco-vscode-base-service-override-BYqBQsid.js";import{aq as qu}from"./monaco-vscode-editor-api-CVotD80_.js";import{I as Lu,E as Ou,a as Mu,b as Hu,c as $u,d as Ku,e as Au,f as Nu}from"./monaco-vscode-extension-api-CARuSqvA.js";import{m as Wu,w as Uu,cm as zu,I as ju}from"./monaco-vscode-configuration-service-override-C_9dpF2l.js";const Qi=new ou;class Bu extends Hu{constructor(){super(...arguments),this._extApiImpl=new hu}async getApi(e){const[h,R]=await Promise.all([this.getExtensionRegistry(),this._extHostConfiguration.getConfigProvider()]),k={mine:h,all:this._globalRegistry};if(e==null)return this._defaultApiImpl==null&&(this._defaultApiImpl=this._apiFactory(pu,k,R)),this._defaultApiImpl;const S=h.getExtensionDescription(e);if(S==null)throw new Error(`Extension ${e} does not exist or is disabled`);let s=this._extApiImpl.get(S.identifier);return s==null&&(s=this._apiFactory(S,k,R),this._extApiImpl.set(S.identifier,s)),s}}bn(Lu,Bu,Vi.Eager);bn(Mu,Ou,Vi.Eager);bn(Au,new Tu(Ku,[!0],!0));function Vu(){const l=new Ln,e=new Ln;class h{constructor(k,S){this.emitterIn=k,this.emitterOut=S,this.onMessage=this.emitterIn.event}send(k){this.emitterOut.fire(k)}}return[new h(l,e),new h(e,l)]}const Qu=new class{constructor(){this.pid=void 0,this.exit=Uu}async exists(){return!0}async realpath(l){return l}};let _n=class{constructor(e,h,R,k,S,s,c,u,m,y,a){this.runningLocation=e,this.startup=h,this._initDataProvider=R,this._telemetryService=k,this._contextService=S,this._labelService=s,this._logService=c,this._loggerService=u,this._environmentService=m,this._productService=y,this._userDataProfilesService=a,this.remoteAuthority=null,this.extensions=null,this.pid=null,this.onExit=mu.None,this._protocolPromise=null,this._extensionHostLogsLocation=Cu(this._environmentService.extHostLogsPath,"local")}async start(){return this._protocolPromise==null&&(this._protocolPromise=this._start()),await this._protocolPromise}async _start(){const[e,h]=Vu(),R=await this._createExtHostInitData(),S=new $u(h,R,Qu,null).getExtHostExtensionService();return await Qi.complete(s=>S.getApi(s)),e}async _createExtHostInitData(){const e=await this._initDataProvider.getInitData();this.extensions=e.extensions;const h=this._contextService.getWorkspace(),R=this._productService.extensionsGallery?.nlsBaseUrl;let k;return R!=null&&this._productService.commit!=null&&!$n.isDefaultVariant()&&(k=Rn.joinPath(Rn.parse(R),this._productService.commit,this._productService.version,$n.value())),{commit:this._productService.commit,version:this._productService.version,quality:this._productService.quality,parentPid:0,environment:{isExtensionDevelopmentDebug:this._environmentService.debugRenderer,appName:this._productService.nameLong,appHost:this._productService.embedderIdentifier??(Kn?"web":"desktop"),appUriScheme:this._productService.urlProtocol,appLanguage:vu,isExtensionTelemetryLoggingOnly:yu(this._productService,this._environmentService),extensionDevelopmentLocationURI:this._environmentService.extensionDevelopmentLocationURI,extensionTestsLocationURI:this._environmentService.extensionTestsLocationURI,globalStorageHome:this._userDataProfilesService.defaultProfile.globalStorageHome,workspaceStorageHome:this._environmentService.workspaceStorageHome,extensionLogLevel:this._environmentService.extensionLogLevel},workspace:this._contextService.getWorkbenchState()===Du.EMPTY?void 0:{configuration:h.configuration??void 0,id:h.id,name:this._labelService.getWorkspaceLabel(h),transient:h.transient},consoleForward:{includeStack:!1,logNative:this._environmentService.debugRenderer},extensions:e.extensions.toSnapshot(),nlsBaseUrl:k,telemetryInfo:{sessionId:this._telemetryService.sessionId,machineId:this._telemetryService.machineId,firstSessionDate:this._telemetryService.firstSessionDate,msftInternal:this._telemetryService.msftInternal,sqmId:this._telemetryService.sqmId,devDeviceId:this._telemetryService.devDeviceId},logLevel:this._logService.getLevel(),loggers:[...this._loggerService.getRegisteredLoggers()],logsLocation:this._extensionHostLogsLocation,autoStart:this.startup===Su.EagerAutoStart,remote:{authority:this._environmentService.remoteAuthority,connectionData:null,isRemote:!1},uiKind:Kn?Tn.Web:Tn.Desktop}}getInspectPort(){}enableInspectPort(){return Promise.resolve(!1)}dispose(){}};_n=su([Ye(3,au),Ye(4,cu),Ye(5,uu),Ye(6,lu),Ye(7,du),Ye(8,gu),Ye(9,fu),Ye(10,Wu)],_n);async function Gi(l){return await(await Qi.p)(l)}vr(_n);Sr(Gi);let an;Dr(l=>{an=l});zu(async l=>{l.get(ju),an=await Gi()});function pe(l){return new Proxy({},{get(e,h){if(an==null)throw new Error("Default api is not ready yet, do not forget to import 'vscode/localExtensionHost' and wait for services initialization");return an[l][h]}})}const Gu={version:Eu.version,tasks:pe("tasks"),notebooks:pe("notebooks"),scm:pe("scm"),comments:pe("comments"),authentication:pe("authentication"),tests:pe("tests"),extensions:pe("extensions"),debug:pe("debug"),env:pe("env"),commands:pe("commands"),window:pe("window"),workspace:pe("workspace"),languages:pe("languages"),l10n:pe("l10n"),interactive:pe("interactive"),ai:pe("ai"),chat:pe("chat"),speech:pe("speech"),lm:pe("lm"),Breakpoint:_r,TerminalOutputAnchor:wc,ChatResultFeedbackKind:ro,ChatVariableLevel:oo,ChatCompletionItem:kr,CallHierarchyIncomingCall:br,CallHierarchyItem:wr,CallHierarchyOutgoingCall:Pr,CancellationError:Ru,CancellationTokenSource:_u,CandidatePortSource:xr,CodeAction:so,CodeActionKind:ao,CodeActionTriggerKind:co,CodeLens:uo,Color:lo,ColorInformation:go,ColorPresentation:fo,ColorThemeKind:ho,CommentMode:po,CommentState:mo,CommentThreadCollapsibleState:yo,CommentThreadState:So,CommentThreadApplicability:Co,CommentThreadFocus:vo,CompletionItem:Do,CompletionItemKind:To,CompletionItemTag:Ro,CompletionList:_o,CompletionTriggerKind:bo,ConfigurationTarget:wo,CustomExecution:Po,DebugAdapterExecutable:ko,DebugAdapterInlineImplementation:Io,DebugAdapterNamedPipeServer:Eo,DebugAdapterServer:qo,DebugConfigurationProviderTriggerKind:Lo,DebugConsoleMode:Oo,DebugVisualization:$o,DecorationRangeBehavior:Ao,Diagnostic:No,DiagnosticRelatedInformation:Wo,DiagnosticSeverity:Uo,DiagnosticTag:zo,Disposable:jo,DocumentHighlight:Qo,DocumentHighlightKind:Go,MultiDocumentHighlight:Js,DocumentLink:Yo,DocumentSymbol:Zo,EndOfLine:es,EnvironmentVariableMutatorType:ts,EvaluatableExpression:ns,InlineValueText:Ps,InlineValueVariableLookup:xs,InlineValueEvaluatableExpression:ws,InlineCompletionTriggerKind:Rs,EventEmitter:bu,ExtensionKind:os,ExtensionMode:ss,ExternalUriOpenerPriority:cs,FileChangeType:us,FileDecoration:Hn,FileDecoration2:Hn,FileSystemError:ds,FileType:Pu,FilePermission:wu,FoldingRange:gs,FoldingRangeKind:fs,FunctionBreakpoint:hs,InlineCompletionItem:Ds,InlineCompletionList:Ts,Hover:ps,VerboseHover:nu,HoverVerbosityAction:ms,IndentAction:qu,Location:Vs,MarkdownString:Gs,OverviewRulerLane:Fu,ParameterInformation:ya,PortAutoForwardAction:Da,Position:Ta,ProcessExecution:_a,ProgressLocation:ba,QuickInputButtonLocation:wa,QuickInputButtons:Pa,Range:Fa,RelativePattern:Ia,Selection:La,SelectionRange:Oa,SemanticTokens:Ma,SemanticTokensBuilder:Ha,SemanticTokensEdit:$a,SemanticTokensEdits:Ka,SemanticTokensLegend:Aa,ShellExecution:Wa,ShellQuoting:Ua,SignatureHelp:za,SignatureHelpTriggerKind:ja,SignatureInformation:Ba,SnippetString:Va,SourceBreakpoint:Ga,StandardTokenType:Ja,StatusBarAlignment:ec,SymbolInformation:tc,SymbolKind:nc,SymbolTag:ic,Task:mc,TaskGroup:Cc,TaskPanelKind:yc,TaskRevealKind:vc,TaskScope:Sc,TerminalLink:_c,TerminalQuickFixTerminalCommand:Fc,TerminalQuickFixOpener:xc,TerminalLocation:bc,TerminalProfile:Pc,TerminalExitReason:Rc,TerminalShellExecutionCommandLineConfidence:kc,TextDocumentSaveReason:Kc,TextEdit:Ac,SnippetTextEdit:Qa,TextEditorCursorStyle:Iu,TextEditorLineNumbersStyle:Wc,TextEditorRevealType:Uc,TextEditorSelectionChangeKind:zc,SyntaxTokenType:rc,TextDocumentChangeReason:$c,ThemeColor:Gc,ThemeIcon:Yc,TreeItem:Jc,TreeItemCheckboxState:Zc,TreeItemCollapsibleState:eu,TypeHierarchyItem:tu,UIKind:Tn,Uri:Rn,ViewColumn:iu,WorkspaceEdit:ru,DocumentPasteTriggerKind:Jo,DocumentDropEdit:Bo,DocumentDropOrPasteEditKind:Vo,DocumentPasteEdit:Xo,InlayHint:Cs,InlayHintLabelPart:vs,InlayHintKind:ys,RemoteAuthorityResolverError:Ea,ResolvedAuthority:qa,ManagedResolvedAuthority:Qs,SourceControlInputBoxValidationType:Ya,ExtensionRuntime:as,TimelineItem:Xc,NotebookRange:pa,NotebookCellKind:ra,NotebookCellExecutionState:ia,NotebookCellData:na,NotebookData:da,NotebookRendererScript:ma,NotebookCellStatusBarAlignment:aa,NotebookEditorRevealType:fa,NotebookCellOutput:oa,NotebookCellOutputItem:sa,NotebookCellStatusBarItem:ca,NotebookControllerAffinity:ua,NotebookControllerAffinity2:la,NotebookEdit:ga,NotebookKernelSourceAction:ha,NotebookVariablesRequestKind:Ca,PortAttributes:Sa,LinkedEditingRanges:Bs,TestResultState:Lc,TestRunRequest:Mc,TestMessage:Ec,TestMessageStackFrame:qc,TestTag:Hc,TestRunProfileKind:Oc,TextSearchCompleteMessageType:jc,DataTransfer:xo,DataTransferItem:Fo,TestCoverageCount:Ic,FileCoverage:ls,StatementCoverage:Za,BranchCoverage:Rr,DeclarationCoverage:Ko,LanguageStatusSeverity:js,QuickPickItemKind:xa,InputBoxValidationSeverity:Fs,TabInputText:dc,TabInputTextDiff:gc,TabInputTextMerge:fc,TabInputCustom:sc,TabInputNotebook:cc,TabInputNotebookDiff:uc,TabInputWebview:pc,TabInputTerminal:lc,TabInputInteractiveWindow:ac,TabInputChat:oc,TabInputTextMultiDiff:hc,TelemetryTrustedValue:ku,LogLevel:xu,EditSessionIdentityMatch:Nu,ChatCopyKind:Ir,DebugStackFrame:Mo,DebugThread:Ho,RelatedInformationType:ka,SpeechToTextStatus:Xa,TextToSpeechStatus:Qc,PartialAcceptTriggerKind:va,KeywordRecognitionStatus:ks,ChatResponseMarkdownPart:Qr,ChatResponseFileTreePart:Vr,ChatResponseAnchorPart:Nr,ChatResponseProgressPart:Jr,ChatResponseProgressPart2:Zr,ChatResponseReferencePart:Mn,ChatResponseReferencePart2:Mn,ChatResponseCodeCitationPart:Wr,ChatResponseWarningPart:io,ChatResponseTextEditPart:to,ChatResponseMarkdownWithVulnerabilitiesPart:Gr,ChatResponseCommandButtonPart:zr,ChatResponseConfirmationPart:jr,ChatResponseReferencePartStatusKind:eo,ChatRequestTurn:On,ChatResponseTurn:no,ChatLocation:Or,ChatRequestEditorData:Kr,ChatRequestNotebookData:Ar,ChatResponseMovePart:Yr,LanguageModelChatMessageRole:qs,LanguageModelChatMessage:Is,LanguageModelError:Ms,NewSymbolName:Zs,NewSymbolNameTag:ea,NewSymbolNameTriggerKind:ta,InlineEdit:_s,InlineEditTriggerKind:bs,ExcludeSettingOptions:is,ChatResponseCodeblockUriPart:Ur,ChatEditingSessionActionOutcome:Er,LanguageModelChatToolMode:Ls,LanguageModelToolCallPart:As,LanguageModelToolResultPart:Us,LanguageModelTextPart:Ks,LanguageModelPromptTsxPart:$s,LanguageModelToolResult:Ns,ChatReferenceBinaryData:Mr,CellErrorStackFrame:Fr,TerminalCompletionItemKind:Dc,TerminalCompletionList:Tc,TextEditorChangeKind:Nc,TextSearchMatch2:Vc,TextSearchContext2:Bc,ChatResponseNotebookEditPart:Xr,ChatErrorLevel:qr,PreparedTerminalToolInvocation:Ra,ExtendedLanguageModelToolResult:rs,ChatReferenceDiagnostic:Hr,LanguageModelChatMessage2:Es,LanguageModelDataPart:Os,ChatImageMimeType:Lr,McpStdioServerDefinition:Xs,SettingsSearchResultKind:Na,ChatResponseExtensionsPart:Br,ChatRequestEditedFileEventKind:$r,ChatRequestTurn2:On,InlineCompletionEndOfLifeReasonKind:Ss,LanguageModelExtraDataPart:Hs,LanguageModelToolResultPart2:zs,LanguageModelToolResult2:Ws,McpHttpServerDefinition:Ys,AISearchKeyword:Tr},{version:Yu,tasks:Xu,notebooks:Ju,scm:Zu,comments:el,authentication:tl,tests:nl,extensions:il,debug:rl,env:ol,commands:sl,window:al,workspace:cl,languages:ul,l10n:ll,interactive:dl,ai:gl,chat:fl,speech:hl,lm:pl,Breakpoint:ml,TerminalOutputAnchor:Cl,ChatResultFeedbackKind:yl,ChatVariableLevel:vl,ChatCompletionItem:Sl,CallHierarchyIncomingCall:Dl,CallHierarchyItem:Tl,CallHierarchyOutgoingCall:Rl,CancellationError:_l,CancellationTokenSource:bl,CandidatePortSource:wl,CodeAction:Pl,CodeActionKind:xl,CodeActionTriggerKind:Fl,CodeLens:kl,Color:Il,ColorInformation:El,ColorPresentation:ql,ColorThemeKind:Ll,CommentMode:Ol,CommentState:Ml,CommentThreadCollapsibleState:Hl,CommentThreadState:$l,CommentThreadApplicability:Kl,CommentThreadFocus:Al,CompletionItem:Nl,CompletionItemKind:Wl,CompletionItemTag:Ul,CompletionList:zl,CompletionTriggerKind:jl,ConfigurationTarget:Bl,CustomExecution:Vl,DebugAdapterExecutable:Ql,DebugAdapterInlineImplementation:Gl,DebugAdapterNamedPipeServer:Yl,DebugAdapterServer:Xl,DebugConfigurationProviderTriggerKind:Jl,DebugConsoleMode:Zl,DebugVisualization:ed,DecorationRangeBehavior:td,Diagnostic:nd,DiagnosticRelatedInformation:id,DiagnosticSeverity:rd,DiagnosticTag:od,Disposable:sd,DocumentHighlight:ad,DocumentHighlightKind:cd,MultiDocumentHighlight:ud,DocumentLink:ld,DocumentSymbol:dd,EndOfLine:gd,EnvironmentVariableMutatorType:fd,EvaluatableExpression:hd,InlineValueText:pd,InlineValueVariableLookup:md,InlineValueEvaluatableExpression:Cd,InlineCompletionTriggerKind:yd,EventEmitter:vd,ExtensionKind:Sd,ExtensionMode:Dd,ExternalUriOpenerPriority:Td,FileChangeType:Rd,FileDecoration:_d,FileDecoration2:bd,FileSystemError:wd,FileType:Pd,FilePermission:xd,FoldingRange:Fd,FoldingRangeKind:kd,FunctionBreakpoint:Id,InlineCompletionItem:Ed,InlineCompletionList:qd,Hover:Ld,VerboseHover:Od,HoverVerbosityAction:Md,IndentAction:Hd,Location:$d,MarkdownString:Kd,OverviewRulerLane:Ad,ParameterInformation:Nd,PortAutoForwardAction:Wd,Position:Ud,ProcessExecution:zd,ProgressLocation:jd,QuickInputButtonLocation:Bd,QuickInputButtons:Vd,Range:Qd,RelativePattern:Gd,Selection:Yd,SelectionRange:Xd,SemanticTokens:Jd,SemanticTokensBuilder:Zd,SemanticTokensEdit:eg,SemanticTokensEdits:tg,SemanticTokensLegend:ng,ShellExecution:ig,ShellQuoting:rg,SignatureHelp:og,SignatureHelpTriggerKind:sg,SignatureInformation:ag,SnippetString:cg,SourceBreakpoint:ug,StandardTokenType:lg,StatusBarAlignment:dg,SymbolInformation:gg,SymbolKind:fg,SymbolTag:hg,Task:pg,TaskGroup:mg,TaskPanelKind:Cg,TaskRevealKind:yg,TaskScope:vg,TerminalLink:Sg,TerminalQuickFixTerminalCommand:Dg,TerminalQuickFixOpener:Tg,TerminalLocation:Rg,TerminalProfile:_g,TerminalExitReason:bg,TerminalShellExecutionCommandLineConfidence:wg,TextDocumentSaveReason:Pg,TextEdit:xg,SnippetTextEdit:Fg,TextEditorCursorStyle:kg,TextEditorLineNumbersStyle:Ig,TextEditorRevealType:Eg,TextEditorSelectionChangeKind:qg,SyntaxTokenType:Lg,TextDocumentChangeReason:Og,ThemeColor:Mg,ThemeIcon:Hg,TreeItem:$g,TreeItemCheckboxState:Kg,TreeItemCollapsibleState:Ag,TypeHierarchyItem:Ng,UIKind:Wg,Uri:Ug,ViewColumn:zg,WorkspaceEdit:jg,DocumentPasteTriggerKind:Bg,DocumentDropEdit:Vg,DocumentDropOrPasteEditKind:Qg,DocumentPasteEdit:Gg,InlayHint:Yg,InlayHintLabelPart:Xg,InlayHintKind:Jg,RemoteAuthorityResolverError:Zg,ResolvedAuthority:ef,ManagedResolvedAuthority:tf,SourceControlInputBoxValidationType:nf,ExtensionRuntime:rf,TimelineItem:of,NotebookRange:sf,NotebookCellKind:af,NotebookCellExecutionState:cf,NotebookCellData:uf,NotebookData:lf,NotebookRendererScript:df,NotebookCellStatusBarAlignment:gf,NotebookEditorRevealType:ff,NotebookCellOutput:hf,NotebookCellOutputItem:pf,NotebookCellStatusBarItem:mf,NotebookControllerAffinity:Cf,NotebookControllerAffinity2:yf,NotebookEdit:vf,NotebookKernelSourceAction:Sf,NotebookVariablesRequestKind:Df,PortAttributes:Tf,LinkedEditingRanges:Rf,TestResultState:_f,TestRunRequest:bf,TestMessage:wf,TestMessageStackFrame:Pf,TestTag:xf,TestRunProfileKind:Ff,TextSearchCompleteMessageType:kf,DataTransfer:If,DataTransferItem:Ef,TestCoverageCount:qf,FileCoverage:Lf,StatementCoverage:Of,BranchCoverage:Mf,DeclarationCoverage:Hf,LanguageStatusSeverity:$f,QuickPickItemKind:Kf,InputBoxValidationSeverity:Af,TabInputText:Nf,TabInputTextDiff:Wf,TabInputTextMerge:Uf,TabInputCustom:zf,TabInputNotebook:jf,TabInputNotebookDiff:Bf,TabInputWebview:Vf,TabInputTerminal:Qf,TabInputInteractiveWindow:Gf,TabInputChat:Yf,TabInputTextMultiDiff:Xf,TelemetryTrustedValue:Jf,LogLevel:Zf,EditSessionIdentityMatch:eh,ChatCopyKind:th,DebugStackFrame:nh,DebugThread:ih,RelatedInformationType:rh,SpeechToTextStatus:oh,TextToSpeechStatus:sh,PartialAcceptTriggerKind:ah,KeywordRecognitionStatus:ch,ChatResponseMarkdownPart:uh,ChatResponseFileTreePart:lh,ChatResponseAnchorPart:dh,ChatResponseProgressPart:gh,ChatResponseProgressPart2:fh,ChatResponseReferencePart:hh,ChatResponseReferencePart2:ph,ChatResponseCodeCitationPart:mh,ChatResponseWarningPart:Ch,ChatResponseTextEditPart:yh,ChatResponseMarkdownWithVulnerabilitiesPart:vh,ChatResponseCommandButtonPart:Sh,ChatResponseConfirmationPart:Dh,ChatResponseReferencePartStatusKind:Th,ChatRequestTurn:Rh,ChatResponseTurn:_h,ChatLocation:bh,ChatRequestEditorData:wh,ChatRequestNotebookData:Ph,ChatResponseMovePart:xh,LanguageModelChatMessageRole:Fh,LanguageModelChatMessage:kh,LanguageModelError:Ih,NewSymbolName:Eh,NewSymbolNameTag:qh,NewSymbolNameTriggerKind:Lh,InlineEdit:Oh,InlineEditTriggerKind:Mh,ExcludeSettingOptions:Hh,ChatResponseCodeblockUriPart:$h,ChatEditingSessionActionOutcome:Kh,LanguageModelChatToolMode:Ah,LanguageModelToolCallPart:Nh,LanguageModelToolResultPart:Wh,LanguageModelTextPart:Uh,LanguageModelPromptTsxPart:zh,LanguageModelToolResult:jh,ChatReferenceBinaryData:Bh,CellErrorStackFrame:Vh,TerminalCompletionItemKind:Qh,TerminalCompletionList:Gh,TextEditorChangeKind:Yh,TextSearchMatch2:Xh,TextSearchContext2:Jh,ChatResponseNotebookEditPart:Zh,ChatErrorLevel:ep,PreparedTerminalToolInvocation:tp,ExtendedLanguageModelToolResult:np,ChatReferenceDiagnostic:ip,LanguageModelChatMessage2:rp,LanguageModelDataPart:op,ChatImageMimeType:sp,McpStdioServerDefinition:ap,SettingsSearchResultKind:cp,ChatResponseExtensionsPart:up,ChatRequestEditedFileEventKind:lp,ChatRequestTurn2:dp,InlineCompletionEndOfLifeReasonKind:gp,LanguageModelExtraDataPart:fp,LanguageModelToolResultPart2:hp,LanguageModelToolResult2:pp,McpHttpServerDefinition:mp,AISearchKeyword:Cp}=Gu,yp=Object.freeze(Object.defineProperty({__proto__:null,AISearchKeyword:Cp,BranchCoverage:Mf,Breakpoint:ml,CallHierarchyIncomingCall:Dl,CallHierarchyItem:Tl,CallHierarchyOutgoingCall:Rl,CancellationError:_l,CancellationTokenSource:bl,CandidatePortSource:wl,CellErrorStackFrame:Vh,ChatCompletionItem:Sl,ChatCopyKind:th,ChatEditingSessionActionOutcome:Kh,ChatErrorLevel:ep,ChatImageMimeType:sp,ChatLocation:bh,ChatReferenceBinaryData:Bh,ChatReferenceDiagnostic:ip,ChatRequestEditedFileEventKind:lp,ChatRequestEditorData:wh,ChatRequestNotebookData:Ph,ChatRequestTurn:Rh,ChatRequestTurn2:dp,ChatResponseAnchorPart:dh,ChatResponseCodeCitationPart:mh,ChatResponseCodeblockUriPart:$h,ChatResponseCommandButtonPart:Sh,ChatResponseConfirmationPart:Dh,ChatResponseExtensionsPart:up,ChatResponseFileTreePart:lh,ChatResponseMarkdownPart:uh,ChatResponseMarkdownWithVulnerabilitiesPart:vh,ChatResponseMovePart:xh,ChatResponseNotebookEditPart:Zh,ChatResponseProgressPart:gh,ChatResponseProgressPart2:fh,ChatResponseReferencePart:hh,ChatResponseReferencePart2:ph,ChatResponseReferencePartStatusKind:Th,ChatResponseTextEditPart:yh,ChatResponseTurn:_h,ChatResponseWarningPart:Ch,ChatResultFeedbackKind:yl,ChatVariableLevel:vl,CodeAction:Pl,CodeActionKind:xl,CodeActionTriggerKind:Fl,CodeLens:kl,Color:Il,ColorInformation:El,ColorPresentation:ql,ColorThemeKind:Ll,CommentMode:Ol,CommentState:Ml,CommentThreadApplicability:Kl,CommentThreadCollapsibleState:Hl,CommentThreadFocus:Al,CommentThreadState:$l,CompletionItem:Nl,CompletionItemKind:Wl,CompletionItemTag:Ul,CompletionList:zl,CompletionTriggerKind:jl,ConfigurationTarget:Bl,CustomExecution:Vl,DataTransfer:If,DataTransferItem:Ef,DebugAdapterExecutable:Ql,DebugAdapterInlineImplementation:Gl,DebugAdapterNamedPipeServer:Yl,DebugAdapterServer:Xl,DebugConfigurationProviderTriggerKind:Jl,DebugConsoleMode:Zl,DebugStackFrame:nh,DebugThread:ih,DebugVisualization:ed,DeclarationCoverage:Hf,DecorationRangeBehavior:td,Diagnostic:nd,DiagnosticRelatedInformation:id,DiagnosticSeverity:rd,DiagnosticTag:od,Disposable:sd,DocumentDropEdit:Vg,DocumentDropOrPasteEditKind:Qg,DocumentHighlight:ad,DocumentHighlightKind:cd,DocumentLink:ld,DocumentPasteEdit:Gg,DocumentPasteTriggerKind:Bg,DocumentSymbol:dd,EditSessionIdentityMatch:eh,EndOfLine:gd,EnvironmentVariableMutatorType:fd,EvaluatableExpression:hd,EventEmitter:vd,ExcludeSettingOptions:Hh,ExtendedLanguageModelToolResult:np,ExtensionKind:Sd,ExtensionMode:Dd,ExtensionRuntime:rf,ExternalUriOpenerPriority:Td,FileChangeType:Rd,FileCoverage:Lf,FileDecoration:_d,FileDecoration2:bd,FilePermission:xd,FileSystemError:wd,FileType:Pd,FoldingRange:Fd,FoldingRangeKind:kd,FunctionBreakpoint:Id,Hover:Ld,HoverVerbosityAction:Md,IndentAction:Hd,InlayHint:Yg,InlayHintKind:Jg,InlayHintLabelPart:Xg,InlineCompletionEndOfLifeReasonKind:gp,InlineCompletionItem:Ed,InlineCompletionList:qd,InlineCompletionTriggerKind:yd,InlineEdit:Oh,InlineEditTriggerKind:Mh,InlineValueEvaluatableExpression:Cd,InlineValueText:pd,InlineValueVariableLookup:md,InputBoxValidationSeverity:Af,KeywordRecognitionStatus:ch,LanguageModelChatMessage:kh,LanguageModelChatMessage2:rp,LanguageModelChatMessageRole:Fh,LanguageModelChatToolMode:Ah,LanguageModelDataPart:op,LanguageModelError:Ih,LanguageModelExtraDataPart:fp,LanguageModelPromptTsxPart:zh,LanguageModelTextPart:Uh,LanguageModelToolCallPart:Nh,LanguageModelToolResult:jh,LanguageModelToolResult2:pp,LanguageModelToolResultPart:Wh,LanguageModelToolResultPart2:hp,LanguageStatusSeverity:$f,LinkedEditingRanges:Rf,Location:$d,LogLevel:Zf,ManagedResolvedAuthority:tf,MarkdownString:Kd,McpHttpServerDefinition:mp,McpStdioServerDefinition:ap,MultiDocumentHighlight:ud,NewSymbolName:Eh,NewSymbolNameTag:qh,NewSymbolNameTriggerKind:Lh,NotebookCellData:uf,NotebookCellExecutionState:cf,NotebookCellKind:af,NotebookCellOutput:hf,NotebookCellOutputItem:pf,NotebookCellStatusBarAlignment:gf,NotebookCellStatusBarItem:mf,NotebookControllerAffinity:Cf,NotebookControllerAffinity2:yf,NotebookData:lf,NotebookEdit:vf,NotebookEditorRevealType:ff,NotebookKernelSourceAction:Sf,NotebookRange:sf,NotebookRendererScript:df,NotebookVariablesRequestKind:Df,OverviewRulerLane:Ad,ParameterInformation:Nd,PartialAcceptTriggerKind:ah,PortAttributes:Tf,PortAutoForwardAction:Wd,Position:Ud,PreparedTerminalToolInvocation:tp,ProcessExecution:zd,ProgressLocation:jd,QuickInputButtonLocation:Bd,QuickInputButtons:Vd,QuickPickItemKind:Kf,Range:Qd,RelatedInformationType:rh,RelativePattern:Gd,RemoteAuthorityResolverError:Zg,ResolvedAuthority:ef,Selection:Yd,SelectionRange:Xd,SemanticTokens:Jd,SemanticTokensBuilder:Zd,SemanticTokensEdit:eg,SemanticTokensEdits:tg,SemanticTokensLegend:ng,SettingsSearchResultKind:cp,ShellExecution:ig,ShellQuoting:rg,SignatureHelp:og,SignatureHelpTriggerKind:sg,SignatureInformation:ag,SnippetString:cg,SnippetTextEdit:Fg,SourceBreakpoint:ug,SourceControlInputBoxValidationType:nf,SpeechToTextStatus:oh,StandardTokenType:lg,StatementCoverage:Of,StatusBarAlignment:dg,SymbolInformation:gg,SymbolKind:fg,SymbolTag:hg,SyntaxTokenType:Lg,TabInputChat:Yf,TabInputCustom:zf,TabInputInteractiveWindow:Gf,TabInputNotebook:jf,TabInputNotebookDiff:Bf,TabInputTerminal:Qf,TabInputText:Nf,TabInputTextDiff:Wf,TabInputTextMerge:Uf,TabInputTextMultiDiff:Xf,TabInputWebview:Vf,Task:pg,TaskGroup:mg,TaskPanelKind:Cg,TaskRevealKind:yg,TaskScope:vg,TelemetryTrustedValue:Jf,TerminalCompletionItemKind:Qh,TerminalCompletionList:Gh,TerminalExitReason:bg,TerminalLink:Sg,TerminalLocation:Rg,TerminalOutputAnchor:Cl,TerminalProfile:_g,TerminalQuickFixOpener:Tg,TerminalQuickFixTerminalCommand:Dg,TerminalShellExecutionCommandLineConfidence:wg,TestCoverageCount:qf,TestMessage:wf,TestMessageStackFrame:Pf,TestResultState:_f,TestRunProfileKind:Ff,TestRunRequest:bf,TestTag:xf,TextDocumentChangeReason:Og,TextDocumentSaveReason:Pg,TextEdit:xg,TextEditorChangeKind:Yh,TextEditorCursorStyle:kg,TextEditorLineNumbersStyle:Ig,TextEditorRevealType:Eg,TextEditorSelectionChangeKind:qg,TextSearchCompleteMessageType:kf,TextSearchContext2:Jh,TextSearchMatch2:Xh,TextToSpeechStatus:sh,ThemeColor:Mg,ThemeIcon:Hg,TimelineItem:of,TreeItem:$g,TreeItemCheckboxState:Kg,TreeItemCollapsibleState:Ag,TypeHierarchyItem:Ng,UIKind:Wg,Uri:Ug,VerboseHover:Od,ViewColumn:zg,WorkspaceEdit:jg,ai:gl,authentication:tl,chat:fl,commands:sl,comments:el,debug:rl,env:ol,extensions:il,interactive:dl,l10n:ll,languages:ul,lm:pl,notebooks:Ju,scm:Zu,speech:hl,tasks:Xu,tests:nl,version:Yu,window:al,workspace:cl},Symbol.toStringTag,{value:"Module"}));var Cn,An;function Nn(){return An||(An=1,Cn=Z()),Cn}var Xe={},Je={},me={};const Q=yr(yp);var ge={},Wn;function Ue(){if(Wn)return ge;Wn=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.asPromise=ge.thenable=ge.typedArray=ge.stringArray=ge.array=ge.func=ge.error=ge.number=ge.string=ge.boolean=void 0;function l(y){return y===!0||y===!1}ge.boolean=l;function e(y){return typeof y=="string"||y instanceof String}ge.string=e;function h(y){return typeof y=="number"||y instanceof Number}ge.number=h;function R(y){return y instanceof Error}ge.error=R;function k(y){return typeof y=="function"}ge.func=k;function S(y){return Array.isArray(y)}ge.array=S;function s(y){return S(y)&&y.every(a=>e(a))}ge.stringArray=s;function c(y,a){return Array.isArray(y)&&y.every(a)}ge.typedArray=c;function u(y){return y&&k(y.then)}ge.thenable=u;function m(y){return y instanceof Promise?y:u(y)?new Promise((a,p)=>{y.then(r=>a(r),r=>p(r))}):Promise.resolve(y)}return ge.asPromise=m,ge}var Me={},Un;function fe(){if(Un)return Me;Un=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.generateUuid=Me.parse=Me.isUUID=Me.v4=Me.empty=void 0;class l{constructor(u){this._value=u}asHex(){return this._value}equals(u){return this.asHex()===u.asHex()}}class e extends l{static _oneOf(u){return u[Math.floor(u.length*Math.random())]}static _randomHex(){return e._oneOf(e._chars)}constructor(){super([e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),"-",e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),"-","4",e._randomHex(),e._randomHex(),e._randomHex(),"-",e._oneOf(e._timeHighBits),e._randomHex(),e._randomHex(),e._randomHex(),"-",e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex()].join(""))}}e._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],e._timeHighBits=["8","9","a","b"],Me.empty=new l("00000000-0000-0000-0000-000000000000");function h(){return new e}Me.v4=h;const R=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function k(c){return R.test(c)}Me.isUUID=k;function S(c){if(!k(c))throw new Error("invalid uuid");return new l(c)}Me.parse=S;function s(){return h().asHex()}return Me.generateUuid=s,Me}var zn;function ie(){if(zn)return me;zn=1,Object.defineProperty(me,"__esModule",{value:!0}),me.WorkspaceFeature=me.TextDocumentLanguageFeature=me.TextDocumentEventFeature=me.DynamicDocumentFeature=me.DynamicFeature=me.StaticFeature=me.ensure=me.LSPCancellationError=void 0;const l=Q,e=Z(),h=Ue(),R=fe();class k extends l.CancellationError{constructor(r){super(),this.data=r}}me.LSPCancellationError=k;function S(p,r){return p[r]===void 0&&(p[r]={}),p[r]}me.ensure=S;var s;(function(p){function r(i){const d=i;return d!=null&&h.func(d.fillClientCapabilities)&&h.func(d.initialize)&&h.func(d.getState)&&h.func(d.clear)&&(d.fillInitializeParams===void 0||h.func(d.fillInitializeParams))}p.is=r})(s||(me.StaticFeature=s={}));var c;(function(p){function r(i){const d=i;return d!=null&&h.func(d.fillClientCapabilities)&&h.func(d.initialize)&&h.func(d.getState)&&h.func(d.clear)&&(d.fillInitializeParams===void 0||h.func(d.fillInitializeParams))&&h.func(d.register)&&h.func(d.unregister)&&d.registrationType!==void 0}p.is=r})(c||(me.DynamicFeature=c={}));class u{constructor(r){this._client=r}getState(){const r=this.getDocumentSelectors();let i=0;for(const f of r){i++;for(const C of l.workspace.textDocuments)if(l.languages.match(f,C)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}const d=i>0;return{kind:"document",id:this.registrationType.method,registrations:d,matches:!1}}}me.DynamicDocumentFeature=u;class m extends u{static textDocumentFilter(r,i){for(const d of r)if(l.languages.match(d,i)>0)return!0;return!1}constructor(r,i,d,f,C,n,g){super(r),this._event=i,this._type=d,this._middleware=f,this._createParams=C,this._textDocument=n,this._selectorFilter=g,this._selectors=new Map,this._onNotificationSent=new l.EventEmitter}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(r){r.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(i=>{this.callback(i).catch(d=>{this._client.error(`Sending document notification ${this._type.method} failed.`,d)})})),this._selectors.set(r.id,this._client.protocol2CodeConverter.asDocumentSelector(r.registerOptions.documentSelector)))}async callback(r){const i=async d=>{const f=this._createParams(d);await this._client.sendNotification(this._type,f),this.notificationSent(this.getTextDocument(d),this._type,f)};if(this.matches(r)){const d=this._middleware();return d?d(r,f=>i(f)):i(r)}}matches(r){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(r))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),r)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(r,i,d){this._onNotificationSent.fire({textDocument:r,type:i,params:d})}unregister(r){this._selectors.delete(r),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(r){for(const i of this._selectors.values())if(l.languages.match(i,r)>0)return{send:d=>this.callback(d)}}}me.TextDocumentEventFeature=m;class y extends u{constructor(r,i){super(r),this._registrationType=i,this._registrations=new Map}*getDocumentSelectors(){for(const r of this._registrations.values()){const i=r.data.registerOptions.documentSelector;i!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(i))}}get registrationType(){return this._registrationType}register(r){if(!r.registerOptions.documentSelector)return;let i=this.registerLanguageProvider(r.registerOptions,r.id);this._registrations.set(r.id,{disposable:i[0],data:r,provider:i[1]})}unregister(r){let i=this._registrations.get(r);i!==void 0&&i.disposable.dispose()}clear(){this._registrations.forEach(r=>{r.disposable.dispose()}),this._registrations.clear()}getRegistration(r,i){if(i){if(e.TextDocumentRegistrationOptions.is(i)){const d=e.StaticRegistrationOptions.hasId(i)?i.id:R.generateUuid(),f=i.documentSelector??r;if(f)return[d,Object.assign({},i,{documentSelector:f})]}else if(h.boolean(i)&&i===!0||e.WorkDoneProgressOptions.is(i)){if(!r)return[void 0,void 0];const d=h.boolean(i)&&i===!0?{documentSelector:r}:Object.assign({},i,{documentSelector:r});return[R.generateUuid(),d]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(r,i){if(!(!r||!i))return h.boolean(i)&&i===!0?{documentSelector:r}:Object.assign({},i,{documentSelector:r})}getProvider(r){for(const i of this._registrations.values()){let d=i.data.registerOptions.documentSelector;if(d!==null&&l.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(d),r)>0)return i.provider}}getAllProviders(){const r=[];for(const i of this._registrations.values())r.push(i.provider);return r}}me.TextDocumentLanguageFeature=y;class a{constructor(r,i){this._client=r,this._registrationType=i,this._registrations=new Map}getState(){const r=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:r}}get registrationType(){return this._registrationType}register(r){const i=this.registerLanguageProvider(r.registerOptions);this._registrations.set(r.id,{disposable:i[0],provider:i[1]})}unregister(r){let i=this._registrations.get(r);i!==void 0&&i.disposable.dispose()}clear(){this._registrations.forEach(r=>{r.disposable.dispose()}),this._registrations.clear()}getProviders(){const r=[];for(const i of this._registrations.values())r.push(i.provider);return r}}return me.WorkspaceFeature=a,me}var je={},yn,jn;function vp(){return jn||(jn=1,yn=typeof process=="object"&&process&&process.platform==="win32"?{sep:"\\"}:{sep:"/"}),yn}var vn,Bn;function Sp(){if(Bn)return vn;Bn=1,vn=l;function l(R,k,S){R instanceof RegExp&&(R=e(R,S)),k instanceof RegExp&&(k=e(k,S));var s=h(R,k,S);return s&&{start:s[0],end:s[1],pre:S.slice(0,s[0]),body:S.slice(s[0]+R.length,s[1]),post:S.slice(s[1]+k.length)}}function e(R,k){var S=k.match(R);return S?S[0]:null}l.range=h;function h(R,k,S){var s,c,u,m,y,a=S.indexOf(R),p=S.indexOf(k,a+1),r=a;if(a>=0&&p>0){if(R===k)return[a,p];for(s=[],u=S.length;r>=0&&!y;)r==a?(s.push(r),a=S.indexOf(R,r+1)):s.length==1?y=[s.pop(),p]:(c=s.pop(),c<u&&(u=c,m=p),p=S.indexOf(k,r+1)),r=a<p&&a>=0?a:p;s.length&&(y=[u,m])}return y}return vn}var Sn,Vn;function Dp(){if(Vn)return Sn;Vn=1;var l=Sp();Sn=y;var e="\0SLASH"+Math.random()+"\0",h="\0OPEN"+Math.random()+"\0",R="\0CLOSE"+Math.random()+"\0",k="\0COMMA"+Math.random()+"\0",S="\0PERIOD"+Math.random()+"\0";function s(f){return parseInt(f,10)==f?parseInt(f,10):f.charCodeAt(0)}function c(f){return f.split("\\\\").join(e).split("\\{").join(h).split("\\}").join(R).split("\\,").join(k).split("\\.").join(S)}function u(f){return f.split(e).join("\\").split(h).join("{").split(R).join("}").split(k).join(",").split(S).join(".")}function m(f){if(!f)return[""];var C=[],n=l("{","}",f);if(!n)return f.split(",");var g=n.pre,v=n.body,x=n.post,L=g.split(",");L[L.length-1]+="{"+v+"}";var E=m(x);return x.length&&(L[L.length-1]+=E.shift(),L.push.apply(L,E)),C.push.apply(C,L),C}function y(f){return f?(f.substr(0,2)==="{}"&&(f="\\{\\}"+f.substr(2)),d(c(f),!0).map(u)):[]}function a(f){return"{"+f+"}"}function p(f){return/^-?0\d/.test(f)}function r(f,C){return f<=C}function i(f,C){return f>=C}function d(f,C){var n=[],g=l("{","}",f);if(!g)return[f];var v=g.pre,x=g.post.length?d(g.post,!1):[""];if(/\$$/.test(g.pre))for(var L=0;L<x.length;L++){var E=v+"{"+g.body+"}"+x[L];n.push(E)}else{var D=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(g.body),I=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(g.body),F=D||I,P=g.body.indexOf(",")>=0;if(!F&&!P)return g.post.match(/,(?!,).*\}/)?(f=g.pre+"{"+g.body+R+g.post,d(f)):[f];var O;if(F)O=g.body.split(/\.\./);else if(O=m(g.body),O.length===1&&(O=d(O[0],!1).map(a),O.length===1))return x.map(function(He){return g.pre+O[0]+He});var W;if(F){var N=s(O[0]),A=s(O[1]),j=Math.max(O[0].length,O[1].length),V=O.length==3?Math.abs(s(O[2])):1,ee=r,ae=A<N;ae&&(V*=-1,ee=i);var ye=O.some(p);W=[];for(var ne=N;ee(ne,A);ne+=V){var de;if(I)de=String.fromCharCode(ne),de==="\\"&&(de="");else if(de=String(ne),ye){var qe=j-de.length;if(qe>0){var Ae=new Array(qe+1).join("0");ne<0?de="-"+Ae+de.slice(1):de=Ae+de}}W.push(de)}}else{W=[];for(var _e=0;_e<O.length;_e++)W.push.apply(W,d(O[_e],!1))}for(var _e=0;_e<W.length;_e++)for(var L=0;L<x.length;L++){var E=v+W[_e]+x[L];(!C||F||E)&&n.push(E)}}return n}return Sn}var Xt,Qn;function wn(){if(Qn)return Xt;Qn=1;const l=Xt=(E,D,I={})=>(f(D),!I.nocomment&&D.charAt(0)==="#"?!1:new L(D,I).match(E));Xt=l;const e=vp();l.sep=e.sep;const h=Symbol("globstar **");l.GLOBSTAR=h;const R=Dp(),k={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},S="[^/]",s=S+"*?",c="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",u="(?:(?!(?:\\/|^)\\.).)*?",m=E=>E.split("").reduce((D,I)=>(D[I]=!0,D),{}),y=m("().*{}+?[]^$\\!"),a=m("[.("),p=/\/+/;l.filter=(E,D={})=>(I,F,P)=>l(I,E,D);const r=(E,D={})=>{const I={};return Object.keys(E).forEach(F=>I[F]=E[F]),Object.keys(D).forEach(F=>I[F]=D[F]),I};l.defaults=E=>{if(!E||typeof E!="object"||!Object.keys(E).length)return l;const D=l,I=(F,P,O)=>D(F,P,r(E,O));return I.Minimatch=class extends D.Minimatch{constructor(P,O){super(P,r(E,O))}},I.Minimatch.defaults=F=>D.defaults(r(E,F)).Minimatch,I.filter=(F,P)=>D.filter(F,r(E,P)),I.defaults=F=>D.defaults(r(E,F)),I.makeRe=(F,P)=>D.makeRe(F,r(E,P)),I.braceExpand=(F,P)=>D.braceExpand(F,r(E,P)),I.match=(F,P,O)=>D.match(F,P,r(E,O)),I},l.braceExpand=(E,D)=>i(E,D);const i=(E,D={})=>(f(E),D.nobrace||!/\{(?:(?!\{).)*\}/.test(E)?[E]:R(E)),d=1024*64,f=E=>{if(typeof E!="string")throw new TypeError("invalid pattern");if(E.length>d)throw new TypeError("pattern is too long")},C=Symbol("subparse");l.makeRe=(E,D)=>new L(E,D||{}).makeRe(),l.match=(E,D,I={})=>{const F=new L(D,I);return E=E.filter(P=>F.match(P)),F.options.nonull&&!E.length&&E.push(D),E};const n=E=>E.replace(/\\(.)/g,"$1"),g=E=>E.replace(/\\([^-\]])/g,"$1"),v=E=>E.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),x=E=>E.replace(/[[\]\\]/g,"\\$&");class L{constructor(D,I){f(D),I||(I={}),this.options=I,this.set=[],this.pattern=D,this.windowsPathsNoEscape=!!I.windowsPathsNoEscape||I.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!I.partial,this.make()}debug(){}make(){const D=this.pattern,I=this.options;if(!I.nocomment&&D.charAt(0)==="#"){this.comment=!0;return}if(!D){this.empty=!0;return}this.parseNegate();let F=this.globSet=this.braceExpand();I.debug&&(this.debug=(...P)=>console.error(...P)),this.debug(this.pattern,F),F=this.globParts=F.map(P=>P.split(p)),this.debug(this.pattern,F),F=F.map((P,O,W)=>P.map(this.parse,this)),this.debug(this.pattern,F),F=F.filter(P=>P.indexOf(!1)===-1),this.debug(this.pattern,F),this.set=F}parseNegate(){if(this.options.nonegate)return;const D=this.pattern;let I=!1,F=0;for(let P=0;P<D.length&&D.charAt(P)==="!";P++)I=!I,F++;F&&(this.pattern=D.slice(F)),this.negate=I}matchOne(D,I,F){var P=this.options;this.debug("matchOne",{this:this,file:D,pattern:I}),this.debug("matchOne",D.length,I.length);for(var O=0,W=0,N=D.length,A=I.length;O<N&&W<A;O++,W++){this.debug("matchOne loop");var j=I[W],V=D[O];if(this.debug(I,j,V),j===!1)return!1;if(j===h){this.debug("GLOBSTAR",[I,j,V]);var ee=O,ae=W+1;if(ae===A){for(this.debug("** at the end");O<N;O++)if(D[O]==="."||D[O]===".."||!P.dot&&D[O].charAt(0)===".")return!1;return!0}for(;ee<N;){var ye=D[ee];if(this.debug(`
globstar while`,D,ee,I,ae,ye),this.matchOne(D.slice(ee),I.slice(ae),F))return this.debug("globstar found match!",ee,N,ye),!0;if(ye==="."||ye===".."||!P.dot&&ye.charAt(0)==="."){this.debug("dot detected!",D,ee,I,ae);break}this.debug("globstar swallow a segment, and continue"),ee++}return!!(F&&(this.debug(`
>>> no match, partial?`,D,ee,I,ae),ee===N))}var ne;if(typeof j=="string"?(ne=V===j,this.debug("string match",j,V,ne)):(ne=V.match(j),this.debug("pattern match",j,V,ne)),!ne)return!1}if(O===N&&W===A)return!0;if(O===N)return F;if(W===A)return O===N-1&&D[O]==="";throw new Error("wtf?")}braceExpand(){return i(this.pattern,this.options)}parse(D,I){f(D);const F=this.options;if(D==="**")if(F.noglobstar)D="*";else return h;if(D==="")return"";let P="",O=!1,W=!1;const N=[],A=[];let j,V=!1,ee=-1,ae=-1,ye,ne,de,qe=D.charAt(0)===".",Ae=F.dot||qe;const _e=()=>qe?"":Ae?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",He=G=>G.charAt(0)==="."?"":F.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",xe=()=>{if(j){switch(j){case"*":P+=s,O=!0;break;case"?":P+=S,O=!0;break;default:P+="\\"+j;break}this.debug("clearStateChar %j %j",j,P),j=!1}};for(let G=0,Y;G<D.length&&(Y=D.charAt(G));G++){if(this.debug("%s	%s %s %j",D,G,P,Y),W){if(Y==="/")return!1;y[Y]&&(P+="\\"),P+=Y,W=!1;continue}switch(Y){case"/":return!1;case"\\":if(V&&D.charAt(G+1)==="-"){P+=Y;continue}xe(),W=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",D,G,P,Y),V){this.debug("  in class"),Y==="!"&&G===ae+1&&(Y="^"),P+=Y;continue}this.debug("call clearStateChar %j",j),xe(),j=Y,F.noext&&xe();continue;case"(":{if(V){P+="(";continue}if(!j){P+="\\(";continue}const ce={type:j,start:G-1,reStart:P.length,open:k[j].open,close:k[j].close};this.debug(this.pattern,"	",ce),N.push(ce),P+=ce.open,ce.start===0&&ce.type!=="!"&&(qe=!0,P+=He(D.slice(G+1))),this.debug("plType %j %j",j,P),j=!1;continue}case")":{const ce=N[N.length-1];if(V||!ce){P+="\\)";continue}N.pop(),xe(),O=!0,ne=ce,P+=ne.close,ne.type==="!"&&A.push(Object.assign(ne,{reEnd:P.length}));continue}case"|":{const ce=N[N.length-1];if(V||!ce){P+="\\|";continue}xe(),P+="|",ce.start===0&&ce.type!=="!"&&(qe=!0,P+=He(D.slice(G+1)));continue}case"[":if(xe(),V){P+="\\"+Y;continue}V=!0,ae=G,ee=P.length,P+=Y;continue;case"]":if(G===ae+1||!V){P+="\\"+Y;continue}ye=D.substring(ae+1,G);try{RegExp("["+x(g(ye))+"]"),P+=Y}catch{P=P.substring(0,ee)+"(?:$.)"}O=!0,V=!1;continue;default:xe(),y[Y]&&!(Y==="^"&&V)&&(P+="\\"),P+=Y;break}}for(V&&(ye=D.slice(ae+1),de=this.parse(ye,C),P=P.substring(0,ee)+"\\["+de[0],O=O||de[1]),ne=N.pop();ne;ne=N.pop()){let G;G=P.slice(ne.reStart+ne.open.length),this.debug("setting tail",P,ne),G=G.replace(/((?:\\{2}){0,64})(\\?)\|/g,(ce,$e,oe)=>(oe||(oe="\\"),$e+$e+oe+"|")),this.debug(`tail=%j
   %s`,G,G,ne,P);const Y=ne.type==="*"?s:ne.type==="?"?S:"\\"+ne.type;O=!0,P=P.slice(0,ne.reStart)+Y+"\\("+G}xe(),W&&(P+="\\\\");const Le=a[P.charAt(0)];for(let G=A.length-1;G>-1;G--){const Y=A[G],ce=P.slice(0,Y.reStart),$e=P.slice(Y.reStart,Y.reEnd-8);let oe=P.slice(Y.reEnd);const X=P.slice(Y.reEnd-8,Y.reEnd)+oe,Oe=ce.split(")").length,be=ce.split("(").length-Oe;let Fe=oe;for(let Ne=0;Ne<be;Ne++)Fe=Fe.replace(/\)[+*?]?/,"");oe=Fe;const Qe=oe===""&&I!==C?"(?:$|\\/)":"";P=ce+$e+oe+Qe+X}if(P!==""&&O&&(P="(?=.)"+P),Le&&(P=_e()+P),I===C)return[P,O];if(F.nocase&&!O&&(O=D.toUpperCase()!==D.toLowerCase()),!O)return n(D);const Ke=F.nocase?"i":"";try{return Object.assign(new RegExp("^"+P+"$",Ke),{_glob:D,_src:P})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;const D=this.set;if(!D.length)return this.regexp=!1,this.regexp;const I=this.options,F=I.noglobstar?s:I.dot?c:u,P=I.nocase?"i":"";let O=D.map(W=>(W=W.map(N=>typeof N=="string"?v(N):N===h?h:N._src).reduce((N,A)=>(N[N.length-1]===h&&A===h||N.push(A),N),[]),W.forEach((N,A)=>{N!==h||W[A-1]===h||(A===0?W.length>1?W[A+1]="(?:\\/|"+F+"\\/)?"+W[A+1]:W[A]=F:A===W.length-1?W[A-1]+="(?:\\/|"+F+")?":(W[A-1]+="(?:\\/|\\/"+F+"\\/)"+W[A+1],W[A+1]=h))}),W.filter(N=>N!==h).join("/"))).join("|");O="^(?:"+O+")$",this.negate&&(O="^(?!"+O+").*$");try{this.regexp=new RegExp(O,P)}catch{this.regexp=!1}return this.regexp}match(D,I=this.partial){if(this.debug("match",D,this.pattern),this.comment)return!1;if(this.empty)return D==="";if(D==="/"&&I)return!0;const F=this.options;e.sep!=="/"&&(D=D.split(e.sep).join("/")),D=D.split(p),this.debug(this.pattern,"split",D);const P=this.set;this.debug(this.pattern,"set",P);let O;for(let W=D.length-1;W>=0&&(O=D[W],!O);W--);for(let W=0;W<P.length;W++){const N=P[W];let A=D;if(F.matchBase&&N.length===1&&(A=[O]),this.matchOne(A,N,I))return F.flipNegate?!0:!this.negate}return F.flipNegate?!1:this.negate}static defaults(D){return l.defaults(D).Minimatch}}return l.Minimatch=L,Xt}var Gn;function Yi(){if(Gn)return je;Gn=1,Object.defineProperty(je,"__esModule",{value:!0}),je.DiagnosticFeature=je.DiagnosticPullMode=je.vsdiag=void 0;const l=wn(),e=Q,h=Z(),R=fe(),k=ie();function S(C,n){return C[n]===void 0&&(C[n]={}),C[n]}var s;(function(C){(function(n){n.full="full",n.unChanged="unChanged"})(C.DocumentDiagnosticReportKind||(C.DocumentDiagnosticReportKind={}))})(s||(je.vsdiag=s={}));var c;(function(C){C.onType="onType",C.onSave="onSave"})(c||(je.DiagnosticPullMode=c={}));var u;(function(C){C.active="open",C.reschedule="reschedule",C.outDated="drop"})(u||(u={}));class m{constructor(){this.open=new Set,this._onOpen=new e.EventEmitter,this._onClose=new e.EventEmitter,m.fillTabResources(this.open);const n=g=>{if(g.closed.length===0&&g.opened.length===0)return;const v=this.open,x=new Set;m.fillTabResources(x);const L=new Set,E=new Set(x);for(const D of v.values())x.has(D)?E.delete(D):L.add(D);if(this.open=x,L.size>0){const D=new Set;for(const I of L)D.add(e.Uri.parse(I));this._onClose.fire(D)}if(E.size>0){const D=new Set;for(const I of E)D.add(e.Uri.parse(I));this._onOpen.fire(D)}};e.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=e.window.tabGroups.onDidChangeTabs(n):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(n){return n instanceof e.Uri?e.window.activeTextEditor?.document.uri===n:e.window.activeTextEditor?.document===n}isVisible(n){const g=n instanceof e.Uri?n:n.uri;return this.open.has(g.toString())}getTabResources(){const n=new Set;return m.fillTabResources(new Set,n),n}static fillTabResources(n,g){const v=n??new Set;for(const x of e.window.tabGroups.all)for(const L of x.tabs){const E=L.input;let D;E instanceof e.TabInputText?D=E.uri:E instanceof e.TabInputTextDiff?D=E.modified:E instanceof e.TabInputCustom&&(D=E.uri),D!==void 0&&!v.has(D.toString())&&(v.add(D.toString()),g!==void 0&&g.add(D))}}}var y;(function(C){C[C.document=1]="document",C[C.workspace=2]="workspace"})(y||(y={}));var a;(function(C){function n(g){return g instanceof e.Uri?g.toString():g.uri.toString()}C.asKey=n})(a||(a={}));class p{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(n,g,v){const x=n===y.document?this.documentPullStates:this.workspacePullStates,[L,E,D]=g instanceof e.Uri?[g.toString(),g,v]:[g.uri.toString(),g.uri,g.version];let I=x.get(L);return I===void 0&&(I={document:E,pulledVersion:D,resultId:void 0},x.set(L,I)),I}update(n,g,v,x){const L=n===y.document?this.documentPullStates:this.workspacePullStates,[E,D,I,F]=g instanceof e.Uri?[g.toString(),g,v,x]:[g.uri.toString(),g.uri,g.version,v];let P=L.get(E);P===void 0?(P={document:D,pulledVersion:I,resultId:F},L.set(E,P)):(P.pulledVersion=I,P.resultId=F)}unTrack(n,g){const v=a.asKey(g);(n===y.document?this.documentPullStates:this.workspacePullStates).delete(v)}tracks(n,g){const v=a.asKey(g);return(n===y.document?this.documentPullStates:this.workspacePullStates).has(v)}getResultId(n,g){const v=a.asKey(g);return(n===y.document?this.documentPullStates:this.workspacePullStates).get(v)?.resultId}getAllResultIds(){const n=[];for(let[g,v]of this.workspacePullStates)this.documentPullStates.has(g)&&(v=this.documentPullStates.get(g)),v.resultId!==void 0&&n.push({uri:g,value:v.resultId});return n}}class r{constructor(n,g,v){this.client=n,this.tabs=g,this.options=v,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new e.EventEmitter,this.provider=this.createProvider(),this.diagnostics=e.languages.createDiagnosticCollection(v.identifier),this.openRequests=new Map,this.documentStates=new p,this.workspaceErrorCounter=0}knows(n,g){const v=g instanceof e.Uri?g:g.uri;return this.documentStates.tracks(n,g)||this.openRequests.has(v.toString())}forget(n,g){this.documentStates.unTrack(n,g)}pull(n,g){if(this.isDisposed)return;const v=n instanceof e.Uri?n:n.uri;this.pullAsync(n).then(()=>{g&&g()},x=>{this.client.error(`Document pull failed for text document ${v.toString()}`,x,!1)})}async pullAsync(n,g){if(this.isDisposed)return;const v=n instanceof e.Uri,x=v?n:n.uri,L=x.toString();g=v?g:n.version;const E=this.openRequests.get(L),D=v?this.documentStates.track(y.document,n,g):this.documentStates.track(y.document,n);if(E===void 0){const I=new e.CancellationTokenSource;this.openRequests.set(L,{state:u.active,document:n,version:g,tokenSource:I});let F,P;try{F=await this.provider.provideDiagnostics(n,D.resultId,I.token)??{kind:s.DocumentDiagnosticReportKind.full,items:[]}}catch(O){if(O instanceof k.LSPCancellationError&&h.DiagnosticServerCancellationData.is(O.data)&&O.data.retriggerRequest===!1&&(P={state:u.outDated,document:n}),P===void 0&&O instanceof e.CancellationError)P={state:u.reschedule,document:n};else throw O}if(P=P??this.openRequests.get(L),P===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${L}`),this.diagnostics.delete(x);return}if(this.openRequests.delete(L),!this.tabs.isVisible(n)){this.documentStates.unTrack(y.document,n);return}if(P.state===u.outDated)return;F!==void 0&&(F.kind===s.DocumentDiagnosticReportKind.full&&this.diagnostics.set(x,F.items),D.pulledVersion=g,D.resultId=F.resultId),P.state===u.reschedule&&this.pull(n)}else E.state===u.active?(E.tokenSource.cancel(),this.openRequests.set(L,{state:u.reschedule,document:E.document})):E.state===u.outDated&&this.openRequests.set(L,{state:u.reschedule,document:E.document})}forgetDocument(n){const g=n instanceof e.Uri?n:n.uri,v=g.toString(),x=this.openRequests.get(v);this.options.workspaceDiagnostics?x!==void 0?this.openRequests.set(v,{state:u.reschedule,document:n}):this.pull(n,()=>{this.forget(y.document,n)}):(x!==void 0&&(x.state===u.active&&x.tokenSource.cancel(),this.openRequests.set(v,{state:u.outDated,document:n})),this.diagnostics.delete(g),this.forget(y.document,n))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,h.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},n=>{!(n instanceof k.LSPCancellationError)&&!h.DiagnosticServerCancellationData.is(n.data)&&(this.client.error("Workspace diagnostic pull failed.",n,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,h.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new e.CancellationTokenSource;const n=this.documentStates.getAllResultIds().map(g=>({uri:this.client.protocol2CodeConverter.asUri(g.uri),value:g.value}));await this.provider.provideWorkspaceDiagnostics(n,this.workspaceCancellation.token,g=>{if(!(!g||this.isDisposed))for(const v of g.items)v.kind===s.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(y.document,v.uri)||this.diagnostics.set(v.uri,v.items)),this.documentStates.update(y.workspace,v.uri,v.version??void 0,v.resultId)})}createProvider(){const n={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(g,v,x)=>{const L=(D,I,F)=>{const P={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(D instanceof e.Uri?D:D.uri)},previousResultId:I};return this.isDisposed===!0||!this.client.isRunning()?{kind:s.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(h.DocumentDiagnosticRequest.type,P,F).then(async O=>O==null||this.isDisposed||F.isCancellationRequested?{kind:s.DocumentDiagnosticReportKind.full,items:[]}:O.kind===h.DocumentDiagnosticReportKind.Full?{kind:s.DocumentDiagnosticReportKind.full,resultId:O.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(O.items,F)}:{kind:s.DocumentDiagnosticReportKind.unChanged,resultId:O.resultId},O=>this.client.handleFailedRequest(h.DocumentDiagnosticRequest.type,F,O,{kind:s.DocumentDiagnosticReportKind.full,items:[]}))},E=this.client.middleware;return E.provideDiagnostics?E.provideDiagnostics(g,v,x,L):L(g,v,x)}};return this.options.workspaceDiagnostics&&(n.provideWorkspaceDiagnostics=(g,v,x)=>{const L=async F=>F.kind===h.DocumentDiagnosticReportKind.Full?{kind:s.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(F.uri),resultId:F.resultId,version:F.version,items:await this.client.protocol2CodeConverter.asDiagnostics(F.items,v)}:{kind:s.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(F.uri),resultId:F.resultId,version:F.version},E=F=>{const P=[];for(const O of F)P.push({uri:this.client.code2ProtocolConverter.asUri(O.uri),value:O.value});return P},D=(F,P)=>{const O=(0,R.generateUuid)(),W=this.client.onProgress(h.WorkspaceDiagnosticRequest.partialResult,O,async A=>{if(A==null){x(null);return}const j={items:[]};for(const V of A.items)try{j.items.push(await L(V))}catch(ee){this.client.error("Converting workspace diagnostics failed.",ee)}x(j)}),N={identifier:this.options.identifier,previousResultIds:E(F),partialResultToken:O};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(h.WorkspaceDiagnosticRequest.type,N,P).then(async A=>{if(P.isCancellationRequested)return{items:[]};const j={items:[]};for(const V of A.items)j.items.push(await L(V));return W.dispose(),x(j),{items:[]}},A=>(W.dispose(),this.client.handleFailedRequest(h.DocumentDiagnosticRequest.type,P,A,{items:[]})))},I=this.client.middleware;return I.provideWorkspaceDiagnostics?I.provideWorkspaceDiagnostics(g,v,x,D):D(g,v)}),n}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(const[n,g]of this.openRequests)g.state===u.active&&g.tokenSource.cancel(),this.openRequests.set(n,{state:u.outDated,document:g.document});this.diagnostics.dispose()}}class i{constructor(n){this.diagnosticRequestor=n,this.documents=new h.LinkedMap,this.isDisposed=!1}add(n){if(this.isDisposed===!0)return;const g=a.asKey(n);this.documents.has(g)||(this.documents.set(g,n,h.Touch.Last),this.trigger())}remove(n){const g=a.asKey(n);this.documents.delete(g),this.documents.size===0?this.stop():g===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,h.RAL)().timer.setInterval(()=>{const n=this.documents.first;if(n!==void 0){const g=a.asKey(n);this.diagnosticRequestor.pull(n),this.documents.set(g,n,h.Touch.Last),g===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?a.asKey(this.endDocument):void 0}}class d{constructor(n,g,v){const x=n.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},L=n.protocol2CodeConverter.asDocumentSelector(v.documentSelector),E=[],D=A=>{const j=v.documentSelector;if(x.match!==void 0)return x.match(j,A);for(const V of j)if(h.TextDocumentFilter.is(V)){if(typeof V=="string"||V.language!==void 0&&V.language!=="*"||V.scheme!==void 0&&V.scheme!=="*"&&V.scheme!==A.scheme)return!1;if(V.pattern!==void 0){const ee=new l.Minimatch(V.pattern,{noext:!0});if(!ee.makeRe()||!ee.match(A.fsPath))return!1}}return!0},I=A=>A instanceof e.Uri?D(A):e.languages.match(L,A)>0&&g.isVisible(A),F=A=>A instanceof e.Uri?this.activeTextDocument?.uri.toString()===A.toString():this.activeTextDocument===A;this.diagnosticRequestor=new r(n,g,v),this.backgroundScheduler=new i(this.diagnosticRequestor);const P=A=>{!I(A)||!v.interFileDependencies||F(A)||this.backgroundScheduler.add(A)};this.activeTextDocument=e.window.activeTextEditor?.document,e.window.onDidChangeActiveTextEditor(A=>{const j=this.activeTextDocument;this.activeTextDocument=A?.document,j!==void 0&&P(j),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});const O=n.getFeature(h.DidOpenTextDocumentNotification.method);E.push(O.onNotificationSent(A=>{const j=A.textDocument;this.diagnosticRequestor.knows(y.document,j)||I(j)&&this.diagnosticRequestor.pull(j,()=>{P(j)})})),E.push(g.onOpen(A=>{for(const j of A){if(this.diagnosticRequestor.knows(y.document,j))continue;const V=j.toString();let ee;for(const ae of e.workspace.textDocuments)if(V===ae.uri.toString()){ee=ae;break}ee!==void 0&&I(ee)&&this.diagnosticRequestor.pull(ee,()=>{P(ee)})}}));const W=new Set;for(const A of e.workspace.textDocuments)I(A)&&(this.diagnosticRequestor.pull(A,()=>{P(A)}),W.add(A.uri.toString()));if(x.onTabs===!0)for(const A of g.getTabResources())!W.has(A.toString())&&I(A)&&this.diagnosticRequestor.pull(A,()=>{P(A)});if(x.onChange===!0){const A=n.getFeature(h.DidChangeTextDocumentNotification.method);E.push(A.onNotificationSent(async j=>{const V=j.textDocument;(x.filter===void 0||!x.filter(V,c.onType))&&this.diagnosticRequestor.knows(y.document,V)&&this.diagnosticRequestor.pull(V,()=>{this.backgroundScheduler.trigger()})}))}if(x.onSave===!0){const A=n.getFeature(h.DidSaveTextDocumentNotification.method);E.push(A.onNotificationSent(j=>{const V=j.textDocument;(x.filter===void 0||!x.filter(V,c.onSave))&&this.diagnosticRequestor.knows(y.document,V)&&this.diagnosticRequestor.pull(j.textDocument,()=>{this.backgroundScheduler.trigger()})}))}const N=n.getFeature(h.DidCloseTextDocumentNotification.method);E.push(N.onNotificationSent(A=>{this.cleanUpDocument(A.textDocument)})),g.onClose(A=>{for(const j of A)this.cleanUpDocument(j)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(const A of e.workspace.textDocuments)I(A)&&this.diagnosticRequestor.pull(A)}),v.workspaceDiagnostics===!0&&v.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=e.Disposable.from(...E,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(n){this.diagnosticRequestor.knows(y.document,n)&&(this.diagnosticRequestor.forgetDocument(n),this.backgroundScheduler.remove(n))}}class f extends k.TextDocumentLanguageFeature{constructor(n){super(n,h.DocumentDiagnosticRequest.type)}fillClientCapabilities(n){let g=S(S(n,"textDocument"),"diagnostic");g.dynamicRegistration=!0,g.relatedDocumentSupport=!1,S(S(n,"workspace"),"diagnostics").refreshSupport=!0}initialize(n,g){this._client.onRequest(h.DiagnosticRefreshRequest.type,async()=>{for(const E of this.getAllProviders())E.onDidChangeDiagnosticsEmitter.fire()});let[x,L]=this.getRegistration(g,n.diagnosticProvider);!x||!L||this.register({id:x,registerOptions:L})}clear(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.clear()}registerLanguageProvider(n){this.tabs===void 0&&(this.tabs=new m);const g=new d(this._client,this.tabs,n);return[g.disposable,g]}}return je.DiagnosticFeature=f,je}var Ce={},at={},Re={},Yn;function Pn(){if(Yn)return Re;Yn=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.forEach=Re.mapAsync=Re.map=Re.clearTestMode=Re.setTestMode=Re.Semaphore=Re.Delayer=void 0;const l=Z();class e{constructor(p){this.defaultDelay=p,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(p,r=this.defaultDelay){return this.task=p,r>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(i=>{this.onSuccess=i}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var i=this.task();return this.task=void 0,i})),(r>=0||this.timeout===void 0)&&(this.timeout=(0,l.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},r>=0?r:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let p=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,p}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}}Re.Delayer=e;class h{constructor(p=1){if(p<=0)throw new Error("Capacity must be greater than 0");this._capacity=p,this._active=0,this._waiting=[]}lock(p){return new Promise((r,i)=>{this._waiting.push({thunk:p,resolve:r,reject:i}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,l.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const p=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const r=p.thunk();r instanceof Promise?r.then(i=>{this._active--,p.resolve(i),this.runNext()},i=>{this._active--,p.reject(i),this.runNext()}):(this._active--,p.resolve(r),this.runNext())}catch(r){this._active--,p.reject(r),this.runNext()}}}Re.Semaphore=h;let R=!1;function k(){R=!0}Re.setTestMode=k;function S(){R=!1}Re.clearTestMode=S;const s=15;class c{constructor(p=s){this.yieldAfter=R===!0?Math.max(p,2):Math.max(p,s),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){const p=Date.now()-this.startTime,r=Math.max(0,this.yieldAfter-p);if(this.total+=this.counter,this.counter=0,p>=this.yieldAfter||r<=1)return this.counterInterval=1,this.total=0,!0;switch(p){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}}async function u(a,p,r,i){if(a.length===0)return[];const d=new Array(a.length),f=new c(i?.yieldAfter);function C(g){f.start();for(let v=g;v<a.length;v++)if(d[v]=p(a[v]),f.shouldYield())return i?.yieldCallback&&i.yieldCallback(),v+1;return-1}let n=C(0);for(;n!==-1&&!(r!==void 0&&r.isCancellationRequested);)n=await new Promise(g=>{(0,l.RAL)().timer.setImmediate(()=>{g(C(n))})});return d}Re.map=u;async function m(a,p,r,i){if(a.length===0)return[];const d=new Array(a.length),f=new c(i?.yieldAfter);async function C(g){f.start();for(let v=g;v<a.length;v++)if(d[v]=await p(a[v],r),f.shouldYield())return i?.yieldCallback&&i.yieldCallback(),v+1;return-1}let n=await C(0);for(;n!==-1&&!(r!==void 0&&r.isCancellationRequested);)n=await new Promise(g=>{(0,l.RAL)().timer.setImmediate(()=>{g(C(n))})});return d}Re.mapAsync=m;async function y(a,p,r,i){if(a.length===0)return;const d=new c(i?.yieldAfter);function f(n){d.start();for(let g=n;g<a.length;g++)if(p(a[g]),d.shouldYield())return i?.yieldCallback&&i.yieldCallback(),g+1;return-1}let C=f(0);for(;C!==-1&&!(r!==void 0&&r.isCancellationRequested);)C=await new Promise(n=>{(0,l.RAL)().timer.setImmediate(()=>{n(f(C))})})}return Re.forEach=y,Re}var Jt={},Xn;function Xi(){if(Xn)return Jt;Xn=1,Object.defineProperty(Jt,"__esModule",{value:!0});const l=Q;class e extends l.CompletionItem{constructor(R){super(R)}}return Jt.default=e,Jt}var Zt={},Jn;function Ji(){if(Jn)return Zt;Jn=1,Object.defineProperty(Zt,"__esModule",{value:!0});const l=Q;class e extends l.CodeLens{constructor(R){super(R)}}return Zt.default=e,Zt}var en={},Zn;function Zi(){if(Zn)return en;Zn=1,Object.defineProperty(en,"__esModule",{value:!0});const l=Q;class e extends l.DocumentLink{constructor(R,k){super(R,k)}}return en.default=e,en}var tn={},ei;function er(){if(ei)return tn;ei=1,Object.defineProperty(tn,"__esModule",{value:!0});const l=Q;class e extends l.CodeAction{constructor(R,k){super(R),this.data=k}}return tn.default=e,tn}var Ze={},ti;function tr(){if(ti)return Ze;ti=1,Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.ProtocolDiagnostic=Ze.DiagnosticCode=void 0;const l=Q,e=Ue();var h;(function(k){function S(s){const c=s;return c!=null&&(e.number(c.value)||e.string(c.value))&&e.string(c.target)}k.is=S})(h||(Ze.DiagnosticCode=h={}));class R extends l.Diagnostic{constructor(S,s,c,u){super(S,s,c),this.data=u,this.hasDiagnosticCode=!1}}return Ze.ProtocolDiagnostic=R,Ze}var nn={},ni;function nr(){if(ni)return nn;ni=1,Object.defineProperty(nn,"__esModule",{value:!0});const l=Q;class e extends l.CallHierarchyItem{constructor(R,k,S,s,c,u,m){super(R,k,S,s,c,u),m!==void 0&&(this.data=m)}}return nn.default=e,nn}var rn={},ii;function ir(){if(ii)return rn;ii=1,Object.defineProperty(rn,"__esModule",{value:!0});const l=Q;class e extends l.TypeHierarchyItem{constructor(R,k,S,s,c,u,m){super(R,k,S,s,c,u),m!==void 0&&(this.data=m)}}return rn.default=e,rn}var on={},ri;function rr(){if(ri)return on;ri=1,Object.defineProperty(on,"__esModule",{value:!0});const l=Q;class e extends l.SymbolInformation{constructor(R,k,S,s,c){const u=!(s instanceof l.Uri);super(R,k,S,u?s:new l.Location(s,new l.Range(0,0,0,0))),this.hasRange=u,c!==void 0&&(this.data=c)}}return on.default=e,on}var sn={},oi;function or(){if(oi)return sn;oi=1,Object.defineProperty(sn,"__esModule",{value:!0});const l=Q;class e extends l.InlayHint{constructor(R,k,S){super(R,k,S)}}return sn.default=e,sn}var si;function Tp(){if(si)return at;si=1,Object.defineProperty(at,"__esModule",{value:!0}),at.createConverter=void 0;const l=Q,e=Z(),h=Ue(),R=Pn(),k=Xi(),S=Ji(),s=Zi(),c=er(),u=tr(),m=nr(),y=ir(),a=rr(),p=or();var r;(function(d){function f(C){const n=C;return n&&!!n.inserting&&!!n.replacing}d.is=f})(r||(r={}));function i(d){const C=d||(o=>o.toString());function n(o){return C(o)}function g(o){return{uri:C(o.uri)}}function v(o){return{uri:C(o.uri),languageId:o.languageId,version:o.version,text:o.getText()}}function x(o){return{uri:C(o.uri),version:o.version}}function L(o){return{textDocument:v(o)}}function E(o){const q=o;return!!q.document&&!!q.contentChanges}function D(o){const q=o;return!!q.uri&&!!q.version}function I(o,q,U){if(D(o))return{textDocument:{uri:C(o.uri),version:o.version},contentChanges:[{text:o.getText()}]};if(E(o)){const ue=q,re=U;return{textDocument:{uri:C(ue),version:re},contentChanges:o.contentChanges.map(Ee=>{const ze=Ee.range;return{range:{start:{line:ze.start.line,character:ze.start.character},end:{line:ze.end.line,character:ze.end.character}},rangeLength:Ee.rangeLength,text:Ee.text}})}}else throw Error("Unsupported text document change parameter")}function F(o){return{textDocument:g(o)}}function P(o,q=!1){let U={textDocument:g(o)};return q&&(U.text=o.getText()),U}function O(o){switch(o){case l.TextDocumentSaveReason.Manual:return e.TextDocumentSaveReason.Manual;case l.TextDocumentSaveReason.AfterDelay:return e.TextDocumentSaveReason.AfterDelay;case l.TextDocumentSaveReason.FocusOut:return e.TextDocumentSaveReason.FocusOut}return e.TextDocumentSaveReason.Manual}function W(o){return{textDocument:g(o.document),reason:O(o.reason)}}function N(o){return{files:o.files.map(q=>({uri:C(q)}))}}function A(o){return{files:o.files.map(q=>({oldUri:C(q.oldUri),newUri:C(q.newUri)}))}}function j(o){return{files:o.files.map(q=>({uri:C(q)}))}}function V(o){return{files:o.files.map(q=>({uri:C(q)}))}}function ee(o){return{files:o.files.map(q=>({oldUri:C(q.oldUri),newUri:C(q.newUri)}))}}function ae(o){return{files:o.files.map(q=>({uri:C(q)}))}}function ye(o,q){return{textDocument:g(o),position:G(q)}}function ne(o){switch(o){case l.CompletionTriggerKind.TriggerCharacter:return e.CompletionTriggerKind.TriggerCharacter;case l.CompletionTriggerKind.TriggerForIncompleteCompletions:return e.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return e.CompletionTriggerKind.Invoked}}function de(o,q,U){return{textDocument:g(o),position:G(q),context:{triggerKind:ne(U.triggerKind),triggerCharacter:U.triggerCharacter}}}function qe(o){switch(o){case l.SignatureHelpTriggerKind.Invoke:return e.SignatureHelpTriggerKind.Invoked;case l.SignatureHelpTriggerKind.TriggerCharacter:return e.SignatureHelpTriggerKind.TriggerCharacter;case l.SignatureHelpTriggerKind.ContentChange:return e.SignatureHelpTriggerKind.ContentChange}}function Ae(o){return{label:o.label}}function _e(o){return o.map(Ae)}function He(o){return{label:o.label,parameters:_e(o.parameters)}}function xe(o){return o.map(He)}function Le(o){return o===void 0?o:{signatures:xe(o.signatures),activeSignature:o.activeSignature,activeParameter:o.activeParameter}}function Ke(o,q,U){return{textDocument:g(o),position:G(q),context:{isRetrigger:U.isRetrigger,triggerCharacter:U.triggerCharacter,triggerKind:qe(U.triggerKind),activeSignatureHelp:Le(U.activeSignatureHelp)}}}function G(o){return{line:o.line,character:o.character}}function Y(o){return o==null?o:{line:o.line>e.uinteger.MAX_VALUE?e.uinteger.MAX_VALUE:o.line,character:o.character>e.uinteger.MAX_VALUE?e.uinteger.MAX_VALUE:o.character}}function ce(o,q){return R.map(o,Y,q)}function $e(o){return o.map(Y)}function oe(o){return o==null?o:{start:Y(o.start),end:Y(o.end)}}function X(o){return o.map(oe)}function Oe(o){return o==null?o:e.Location.create(n(o.uri),oe(o.range))}function be(o){switch(o){case l.DiagnosticSeverity.Error:return e.DiagnosticSeverity.Error;case l.DiagnosticSeverity.Warning:return e.DiagnosticSeverity.Warning;case l.DiagnosticSeverity.Information:return e.DiagnosticSeverity.Information;case l.DiagnosticSeverity.Hint:return e.DiagnosticSeverity.Hint}}function Fe(o){if(!o)return;let q=[];for(let U of o){let ue=Qe(U);ue!==void 0&&q.push(ue)}return q.length>0?q:void 0}function Qe(o){switch(o){case l.DiagnosticTag.Unnecessary:return e.DiagnosticTag.Unnecessary;case l.DiagnosticTag.Deprecated:return e.DiagnosticTag.Deprecated;default:return}}function Ne(o){return{message:o.message,location:Oe(o.location)}}function B(o){return o.map(Ne)}function T(o){if(o!=null)return h.number(o)||h.string(o)?o:{value:o.value,target:n(o.target)}}function b(o){const q=e.Diagnostic.create(oe(o.range),o.message),U=o instanceof u.ProtocolDiagnostic?o:void 0;U!==void 0&&U.data!==void 0&&(q.data=U.data);const ue=T(o.code);return u.DiagnosticCode.is(ue)?U!==void 0&&U.hasDiagnosticCode?q.code=ue:(q.code=ue.value,q.codeDescription={href:ue.target}):q.code=ue,h.number(o.severity)&&(q.severity=be(o.severity)),Array.isArray(o.tags)&&(q.tags=Fe(o.tags)),o.relatedInformation&&(q.relatedInformation=B(o.relatedInformation)),o.source&&(q.source=o.source),q}function w(o,q){return o==null?o:R.map(o,b,q)}function H(o){return o==null?o:o.map(b)}function M(o,q){switch(o){case"$string":return q;case e.MarkupKind.PlainText:return{kind:o,value:q};case e.MarkupKind.Markdown:return{kind:o,value:q.value};default:return`Unsupported Markup content received. Kind is: ${o}`}}function K(o){switch(o){case l.CompletionItemTag.Deprecated:return e.CompletionItemTag.Deprecated}}function te(o){if(o===void 0)return o;const q=[];for(let U of o){const ue=K(U);ue!==void 0&&q.push(ue)}return q}function J(o,q){return q!==void 0?q:o+1}function ve(o,q=!1){let U,ue;h.string(o.label)?U=o.label:(U=o.label.label,q&&(o.label.detail!==void 0||o.label.description!==void 0)&&(ue={detail:o.label.detail,description:o.label.description}));let re={label:U};ue!==void 0&&(re.labelDetails=ue);let De=o instanceof k.default?o:void 0;o.detail&&(re.detail=o.detail),o.documentation&&(!De||De.documentationFormat==="$string"?re.documentation=o.documentation:re.documentation=M(De.documentationFormat,o.documentation)),o.filterText&&(re.filterText=o.filterText),he(re,o),h.number(o.kind)&&(re.kind=J(o.kind,De&&De.originalItemKind)),o.sortText&&(re.sortText=o.sortText),o.additionalTextEdits&&(re.additionalTextEdits=it(o.additionalTextEdits)),o.commitCharacters&&(re.commitCharacters=o.commitCharacters.slice()),o.command&&(re.command=Ge(o.command)),(o.preselect===!0||o.preselect===!1)&&(re.preselect=o.preselect);const Ee=te(o.tags);if(De){if(De.data!==void 0&&(re.data=De.data),De.deprecated===!0||De.deprecated===!1){if(De.deprecated===!0&&Ee!==void 0&&Ee.length>0){const ze=Ee.indexOf(l.CompletionItemTag.Deprecated);ze!==-1&&Ee.splice(ze,1)}re.deprecated=De.deprecated}De.insertTextMode!==void 0&&(re.insertTextMode=De.insertTextMode)}return Ee!==void 0&&Ee.length>0&&(re.tags=Ee),re.insertTextMode===void 0&&o.keepWhitespace===!0&&(re.insertTextMode=e.InsertTextMode.adjustIndentation),re}function he(o,q){let U=e.InsertTextFormat.PlainText,ue,re;q.textEdit?(ue=q.textEdit.newText,re=q.textEdit.range):q.insertText instanceof l.SnippetString?(U=e.InsertTextFormat.Snippet,ue=q.insertText.value):ue=q.insertText,q.range&&(re=q.range),o.insertTextFormat=U,q.fromEdit&&ue!==void 0&&re!==void 0?o.textEdit=nt(ue,re):o.insertText=ue}function nt(o,q){return r.is(q)?e.InsertReplaceEdit.create(o,oe(q.inserting),oe(q.replacing)):{newText:o,range:oe(q)}}function tt(o){return{range:oe(o.range),newText:o.newText}}function it(o){return o==null?o:o.map(tt)}function ke(o){return o<=l.SymbolKind.TypeParameter?o+1:e.SymbolKind.Property}function $t(o){return o}function Ie(o){return o.map($t)}function rt(o,q,U){return{textDocument:g(o),position:G(q),context:{includeDeclaration:U.includeDeclaration}}}async function cn(o,q){let U=e.CodeAction.create(o.title);if(o instanceof c.default&&o.data!==void 0&&(U.data=o.data),o.kind!==void 0&&(U.kind=ot(o.kind)),o.diagnostics!==void 0&&(U.diagnostics=await w(o.diagnostics,q)),o.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return o.command!==void 0&&(U.command=Ge(o.command)),o.isPreferred!==void 0&&(U.isPreferred=o.isPreferred),o.disabled!==void 0&&(U.disabled={reason:o.disabled.reason}),U}function Kt(o){let q=e.CodeAction.create(o.title);if(o instanceof c.default&&o.data!==void 0&&(q.data=o.data),o.kind!==void 0&&(q.kind=ot(o.kind)),o.diagnostics!==void 0&&(q.diagnostics=H(o.diagnostics)),o.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return o.command!==void 0&&(q.command=Ge(o.command)),o.isPreferred!==void 0&&(q.isPreferred=o.isPreferred),o.disabled!==void 0&&(q.disabled={reason:o.disabled.reason}),q}async function un(o,q){if(o==null)return o;let U;return o.only&&h.string(o.only.value)&&(U=[o.only.value]),e.CodeActionContext.create(await w(o.diagnostics,q),U,Nt(o.triggerKind))}function At(o){if(o==null)return o;let q;return o.only&&h.string(o.only.value)&&(q=[o.only.value]),e.CodeActionContext.create(H(o.diagnostics),q,Nt(o.triggerKind))}function Nt(o){switch(o){case l.CodeActionTriggerKind.Invoke:return e.CodeActionTriggerKind.Invoked;case l.CodeActionTriggerKind.Automatic:return e.CodeActionTriggerKind.Automatic;default:return}}function ot(o){if(o!=null)return o.value}function ln(o){return o==null?o:e.InlineValueContext.create(o.frameId,oe(o.stoppedLocation))}function Wt(o,q,U){return{context:e.InlineCompletionContext.create(U.triggerKind,U.selectedCompletionInfo),textDocument:g(o),position:Y(q)}}function Ge(o){let q=e.Command.create(o.title,o.command);return o.arguments&&(q.arguments=o.arguments),q}function Ut(o){let q=e.CodeLens.create(oe(o.range));return o.command&&(q.command=Ge(o.command)),o instanceof S.default&&o.data&&(q.data=o.data),q}function zt(o,q){const U={tabSize:o.tabSize,insertSpaces:o.insertSpaces};return q.trimTrailingWhitespace&&(U.trimTrailingWhitespace=!0),q.trimFinalNewlines&&(U.trimFinalNewlines=!0),q.insertFinalNewline&&(U.insertFinalNewline=!0),U}function dn(o){return{textDocument:g(o)}}function jt(o){return{textDocument:g(o)}}function gn(o){let q=e.DocumentLink.create(oe(o.range));o.target&&(q.target=n(o.target)),o.tooltip!==void 0&&(q.tooltip=o.tooltip);let U=o instanceof s.default?o:void 0;return U&&U.data&&(q.data=U.data),q}function Bt(o){return{textDocument:g(o)}}function Vt(o){const q={name:o.name,kind:ke(o.kind),uri:n(o.uri),range:oe(o.range),selectionRange:oe(o.selectionRange)};return o.detail!==void 0&&o.detail.length>0&&(q.detail=o.detail),o.tags!==void 0&&(q.tags=Ie(o.tags)),o instanceof m.default&&o.data!==void 0&&(q.data=o.data),q}function fn(o){const q={name:o.name,kind:ke(o.kind),uri:n(o.uri),range:oe(o.range),selectionRange:oe(o.selectionRange)};return o.detail!==void 0&&o.detail.length>0&&(q.detail=o.detail),o.tags!==void 0&&(q.tags=Ie(o.tags)),o instanceof y.default&&o.data!==void 0&&(q.data=o.data),q}function st(o){const q=o instanceof a.default?{name:o.name,kind:ke(o.kind),location:o.hasRange?Oe(o.location):{uri:C(o.location.uri)},data:o.data}:{name:o.name,kind:ke(o.kind),location:Oe(o.location)};return o.tags!==void 0&&(q.tags=Ie(o.tags)),o.containerName!==""&&(q.containerName=o.containerName),q}function hn(o){const q=typeof o.label=="string"?o.label:o.label.map(Qt),U=e.InlayHint.create(Y(o.position),q);return o.kind!==void 0&&(U.kind=o.kind),o.textEdits!==void 0&&(U.textEdits=it(o.textEdits)),o.tooltip!==void 0&&(U.tooltip=Gt(o.tooltip)),o.paddingLeft!==void 0&&(U.paddingLeft=o.paddingLeft),o.paddingRight!==void 0&&(U.paddingRight=o.paddingRight),o instanceof p.default&&o.data!==void 0&&(U.data=o.data),U}function Qt(o){const q=e.InlayHintLabelPart.create(o.value);return o.location!==void 0&&(q.location=Oe(o.location)),o.command!==void 0&&(q.command=Ge(o.command)),o.tooltip!==void 0&&(q.tooltip=Gt(o.tooltip)),q}function Gt(o){return typeof o=="string"?o:{kind:e.MarkupKind.Markdown,value:o.value}}return{asUri:n,asTextDocumentIdentifier:g,asTextDocumentItem:v,asVersionedTextDocumentIdentifier:x,asOpenTextDocumentParams:L,asChangeTextDocumentParams:I,asCloseTextDocumentParams:F,asSaveTextDocumentParams:P,asWillSaveTextDocumentParams:W,asDidCreateFilesParams:N,asDidRenameFilesParams:A,asDidDeleteFilesParams:j,asWillCreateFilesParams:V,asWillRenameFilesParams:ee,asWillDeleteFilesParams:ae,asTextDocumentPositionParams:ye,asCompletionParams:de,asSignatureHelpParams:Ke,asWorkerPosition:G,asRange:oe,asRanges:X,asPosition:Y,asPositions:ce,asPositionsSync:$e,asLocation:Oe,asDiagnosticSeverity:be,asDiagnosticTag:Qe,asDiagnostic:b,asDiagnostics:w,asDiagnosticsSync:H,asCompletionItem:ve,asTextEdit:tt,asSymbolKind:ke,asSymbolTag:$t,asSymbolTags:Ie,asReferenceParams:rt,asCodeAction:cn,asCodeActionSync:Kt,asCodeActionContext:un,asCodeActionContextSync:At,asInlineValueContext:ln,asCommand:Ge,asCodeLens:Ut,asFormattingOptions:zt,asDocumentSymbolParams:dn,asCodeLensParams:jt,asDocumentLink:gn,asDocumentLinkParams:Bt,asCallHierarchyItem:Vt,asTypeHierarchyItem:fn,asInlayHint:hn,asWorkspaceSymbol:st,asInlineCompletionParams:Wt}}return at.createConverter=i,at}var ct={},ai;function Rp(){if(ai)return ct;ai=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.createConverter=void 0;const l=Q,e=Z(),h=Ue(),R=Pn(),k=Xi(),S=Ji(),s=Zi(),c=er(),u=tr(),m=nr(),y=ir(),a=rr(),p=or(),r=Z();var i;(function(f){function C(n){let g=n;return g&&h.string(g.language)&&h.string(g.value)}f.is=C})(i||(i={}));function d(f,C,n){const v=f||(t=>l.Uri.parse(t));function x(t){return v(t)}function L(t){const _=[];for(const $ of t)if(typeof $=="string")_.push($);else if(r.NotebookCellTextDocumentFilter.is($))if(typeof $.notebook=="string")_.push({notebookType:$.notebook,language:$.language});else{const z=$.notebook.notebookType??"*";_.push({notebookType:z,scheme:$.notebook.scheme,pattern:$.notebook.pattern,language:$.language})}else r.TextDocumentFilter.is($)&&_.push({language:$.language,scheme:$.scheme,pattern:$.pattern});return _}async function E(t,_){return R.map(t,I,_)}function D(t){const _=new Array(t.length);for(let $=0;$<t.length;$++)_[$]=I(t[$]);return _}function I(t){let _=new u.ProtocolDiagnostic(N(t.range),t.message,j(t.severity),t.data);if(t.code!==void 0){if(typeof t.code=="string"||typeof t.code=="number")e.CodeDescription.is(t.codeDescription)?_.code={value:t.code,target:x(t.codeDescription.href)}:_.code=t.code;else if(u.DiagnosticCode.is(t.code)){_.hasDiagnosticCode=!0;const $=t.code;_.code={value:$.value,target:x($.target)}}}return t.source&&(_.source=t.source),t.relatedInformation&&(_.relatedInformation=F(t.relatedInformation)),Array.isArray(t.tags)&&(_.tags=P(t.tags)),_}function F(t){const _=new Array(t.length);for(let $=0;$<t.length;$++){const z=t[$];_[$]=new l.DiagnosticRelatedInformation(Fe(z.location),z.message)}return _}function P(t){if(!t)return;let _=[];for(let $ of t){let z=O($);z!==void 0&&_.push(z)}return _.length>0?_:void 0}function O(t){switch(t){case e.DiagnosticTag.Unnecessary:return l.DiagnosticTag.Unnecessary;case e.DiagnosticTag.Deprecated:return l.DiagnosticTag.Deprecated;default:return}}function W(t){return t?new l.Position(t.line,t.character):void 0}function N(t){return t?new l.Range(t.start.line,t.start.character,t.end.line,t.end.character):void 0}async function A(t,_){return R.map(t,$=>new l.Range($.start.line,$.start.character,$.end.line,$.end.character),_)}function j(t){if(t==null)return l.DiagnosticSeverity.Error;switch(t){case e.DiagnosticSeverity.Error:return l.DiagnosticSeverity.Error;case e.DiagnosticSeverity.Warning:return l.DiagnosticSeverity.Warning;case e.DiagnosticSeverity.Information:return l.DiagnosticSeverity.Information;case e.DiagnosticSeverity.Hint:return l.DiagnosticSeverity.Hint}return l.DiagnosticSeverity.Error}function V(t){if(h.string(t))return ae(t);if(i.is(t))return ae().appendCodeblock(t.value,t.language);if(Array.isArray(t)){let _=[];for(let $ of t){let z=ae();i.is($)?z.appendCodeblock($.value,$.language):z.appendMarkdown($),_.push(z)}return _}else return ae(t)}function ee(t){if(h.string(t))return t;switch(t.kind){case e.MarkupKind.Markdown:return ae(t.value);case e.MarkupKind.PlainText:return t.value;default:return`Unsupported Markup content received. Kind is: ${t.kind}`}}function ae(t){let _;if(t===void 0||typeof t=="string")_=new l.MarkdownString(t);else switch(t.kind){case e.MarkupKind.Markdown:_=new l.MarkdownString(t.value);break;case e.MarkupKind.PlainText:_=new l.MarkdownString,_.appendText(t.value);break;default:_=new l.MarkdownString,_.appendText(`Unsupported Markup content received. Kind is: ${t.kind}`);break}return _.isTrusted=C,_.supportHtml=n,_}function ye(t){if(t)return new l.Hover(V(t.contents),N(t.range))}async function ne(t,_,$){if(!t)return;if(Array.isArray(t))return R.map(t,We=>He(We,_),$);const z=t,{defaultRange:Se,commitCharacters:Te}=de(z,_),se=await R.map(z.items,We=>He(We,Te,Se,z.itemDefaults?.insertTextMode,z.itemDefaults?.insertTextFormat,z.itemDefaults?.data),$);return new l.CompletionList(se,z.isIncomplete)}function de(t,_){const $=t.itemDefaults?.editRange,z=t.itemDefaults?.commitCharacters??_;return e.Range.is($)?{defaultRange:N($),commitCharacters:z}:$!==void 0?{defaultRange:{inserting:N($.insert),replacing:N($.replace)},commitCharacters:z}:{defaultRange:void 0,commitCharacters:z}}function qe(t){return e.CompletionItemKind.Text<=t&&t<=e.CompletionItemKind.TypeParameter?[t-1,void 0]:[l.CompletionItemKind.Text,t]}function Ae(t){switch(t){case e.CompletionItemTag.Deprecated:return l.CompletionItemTag.Deprecated}}function _e(t){if(t==null)return[];const _=[];for(const $ of t){const z=Ae($);z!==void 0&&_.push(z)}return _}function He(t,_,$,z,Se,Te){const se=_e(t.tags),We=xe(t),le=new k.default(We);t.detail&&(le.detail=t.detail),t.documentation&&(le.documentation=ee(t.documentation),le.documentationFormat=h.string(t.documentation)?"$string":t.documentation.kind),t.filterText&&(le.filterText=t.filterText);const Yt=Le(t,$,Se);if(Yt&&(le.insertText=Yt.text,le.range=Yt.range,le.fromEdit=Yt.fromEdit),h.number(t.kind)){let[Cr,qn]=qe(t.kind);le.kind=Cr,qn&&(le.originalItemKind=qn)}t.sortText&&(le.sortText=t.sortText),t.additionalTextEdits&&(le.additionalTextEdits=ce(t.additionalTextEdits));const In=t.commitCharacters!==void 0?h.stringArray(t.commitCharacters)?t.commitCharacters:void 0:_;In&&(le.commitCharacters=In.slice()),t.command&&(le.command=ke(t.command)),(t.deprecated===!0||t.deprecated===!1)&&(le.deprecated=t.deprecated,t.deprecated===!0&&se.push(l.CompletionItemTag.Deprecated)),(t.preselect===!0||t.preselect===!1)&&(le.preselect=t.preselect);const En=t.data??Te;En!==void 0&&(le.data=En),se.length>0&&(le.tags=se);const mn=t.insertTextMode??z;return mn!==void 0&&(le.insertTextMode=mn,mn===e.InsertTextMode.asIs&&(le.keepWhitespace=!0)),le}function xe(t){return e.CompletionItemLabelDetails.is(t.labelDetails)?{label:t.label,detail:t.labelDetails.detail,description:t.labelDetails.description}:t.label}function Le(t,_,$){const z=t.insertTextFormat??$;if(t.textEdit!==void 0||_!==void 0){const[Se,Te]=t.textEdit!==void 0?Ke(t.textEdit):[_,t.textEditText??t.label];return z===e.InsertTextFormat.Snippet?{text:new l.SnippetString(Te),range:Se,fromEdit:!0}:{text:Te,range:Se,fromEdit:!0}}else return t.insertText?z===e.InsertTextFormat.Snippet?{text:new l.SnippetString(t.insertText),fromEdit:!1}:{text:t.insertText,fromEdit:!1}:void 0}function Ke(t){return e.InsertReplaceEdit.is(t)?[{inserting:N(t.insert),replacing:N(t.replace)},t.newText]:[N(t.range),t.newText]}function G(t){if(t)return new l.TextEdit(N(t.range),t.newText)}async function Y(t,_){if(t)return R.map(t,G,_)}function ce(t){if(!t)return;const _=new Array(t.length);for(let $=0;$<t.length;$++)_[$]=G(t[$]);return _}async function $e(t,_){if(!t)return;let $=new l.SignatureHelp;return h.number(t.activeSignature)?$.activeSignature=t.activeSignature:$.activeSignature=0,h.number(t.activeParameter)?$.activeParameter=t.activeParameter:$.activeParameter=0,t.signatures&&($.signatures=await oe(t.signatures,_)),$}async function oe(t,_){return R.mapAsync(t,X,_)}async function X(t,_){let $=new l.SignatureInformation(t.label);return t.documentation!==void 0&&($.documentation=ee(t.documentation)),t.parameters!==void 0&&($.parameters=await Oe(t.parameters,_)),t.activeParameter!==void 0&&($.activeParameter=t.activeParameter),$}function Oe(t,_){return R.map(t,be,_)}function be(t){let _=new l.ParameterInformation(t.label);return t.documentation&&(_.documentation=ee(t.documentation)),_}function Fe(t){return t?new l.Location(v(t.uri),N(t.range)):void 0}async function Qe(t,_){if(t)return T(t,_)}async function Ne(t,_){if(t)return T(t,_)}function B(t){if(!t)return;let _={targetUri:v(t.targetUri),targetRange:N(t.targetRange),originSelectionRange:N(t.originSelectionRange),targetSelectionRange:N(t.targetSelectionRange)};if(!_.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return _}async function T(t,_){if(t)if(h.array(t)){if(t.length===0)return[];if(e.LocationLink.is(t[0])){const $=t;return R.map($,B,_)}else{const $=t;return R.map($,Fe,_)}}else return e.LocationLink.is(t)?[B(t)]:Fe(t)}async function b(t,_){if(t)return R.map(t,Fe,_)}async function w(t,_){if(t)return R.map(t,H,_)}function H(t){let _=new l.DocumentHighlight(N(t.range));return h.number(t.kind)&&(_.kind=M(t.kind)),_}function M(t){switch(t){case e.DocumentHighlightKind.Text:return l.DocumentHighlightKind.Text;case e.DocumentHighlightKind.Read:return l.DocumentHighlightKind.Read;case e.DocumentHighlightKind.Write:return l.DocumentHighlightKind.Write}return l.DocumentHighlightKind.Text}async function K(t,_){if(t)return R.map(t,he,_)}function te(t){return t<=e.SymbolKind.TypeParameter?t-1:l.SymbolKind.Property}function J(t){switch(t){case e.SymbolTag.Deprecated:return l.SymbolTag.Deprecated;default:return}}function ve(t){if(t==null)return;const _=[];for(const $ of t){const z=J($);z!==void 0&&_.push(z)}return _.length===0?void 0:_}function he(t){const _=t.data,$=t.location,z=$.range===void 0||_!==void 0?new a.default(t.name,te(t.kind),t.containerName??"",$.range===void 0?v($.uri):new l.Location(v(t.location.uri),N($.range)),_):new l.SymbolInformation(t.name,te(t.kind),t.containerName??"",new l.Location(v(t.location.uri),N($.range)));return it(z,t),z}async function nt(t,_){if(t!=null)return R.map(t,tt,_)}function tt(t){let _=new l.DocumentSymbol(t.name,t.detail||"",te(t.kind),N(t.range),N(t.selectionRange));if(it(_,t),t.children!==void 0&&t.children.length>0){let $=[];for(let z of t.children)$.push(tt(z));_.children=$}return _}function it(t,_){t.tags=ve(_.tags),_.deprecated&&(t.tags?t.tags.includes(l.SymbolTag.Deprecated)||(t.tags=t.tags.concat(l.SymbolTag.Deprecated)):t.tags=[l.SymbolTag.Deprecated])}function ke(t){let _={title:t.title,command:t.command};return t.arguments&&(_.arguments=t.arguments),_}async function $t(t,_){if(t)return R.map(t,ke,_)}const Ie=new Map;Ie.set(e.CodeActionKind.Empty,l.CodeActionKind.Empty),Ie.set(e.CodeActionKind.QuickFix,l.CodeActionKind.QuickFix),Ie.set(e.CodeActionKind.Refactor,l.CodeActionKind.Refactor),Ie.set(e.CodeActionKind.RefactorExtract,l.CodeActionKind.RefactorExtract),Ie.set(e.CodeActionKind.RefactorInline,l.CodeActionKind.RefactorInline),Ie.set(e.CodeActionKind.RefactorRewrite,l.CodeActionKind.RefactorRewrite),Ie.set(e.CodeActionKind.Source,l.CodeActionKind.Source),Ie.set(e.CodeActionKind.SourceOrganizeImports,l.CodeActionKind.SourceOrganizeImports);function rt(t){if(t==null)return;let _=Ie.get(t);if(_)return _;let $=t.split(".");_=l.CodeActionKind.Empty;for(let z of $)_=_.append(z);return _}function cn(t){if(t!=null)return t.map(_=>rt(_))}async function Kt(t,_){if(t==null)return;let $=new c.default(t.title,t.data);return t.kind!==void 0&&($.kind=rt(t.kind)),t.diagnostics!==void 0&&($.diagnostics=D(t.diagnostics)),t.edit!==void 0&&($.edit=await ot(t.edit,_)),t.command!==void 0&&($.command=ke(t.command)),t.isPreferred!==void 0&&($.isPreferred=t.isPreferred),t.disabled!==void 0&&($.disabled={reason:t.disabled.reason}),$}function un(t,_){return R.mapAsync(t,async $=>e.Command.is($)?ke($):Kt($,_),_)}function At(t){if(!t)return;let _=new S.default(N(t.range));return t.command&&(_.command=ke(t.command)),t.data!==void 0&&t.data!==null&&(_.data=t.data),_}async function Nt(t,_){if(t)return R.map(t,At,_)}async function ot(t,_){if(!t)return;const $=new Map;if(t.changeAnnotations!==void 0){const Te=t.changeAnnotations;await R.forEach(Object.keys(Te),se=>{const We=ln(Te[se]);$.set(se,We)},_)}const z=Te=>{if(Te!==void 0)return $.get(Te)},Se=new l.WorkspaceEdit;if(t.documentChanges){const Te=t.documentChanges;await R.forEach(Te,se=>{if(e.CreateFile.is(se))Se.createFile(v(se.uri),se.options,z(se.annotationId));else if(e.RenameFile.is(se))Se.renameFile(v(se.oldUri),v(se.newUri),se.options,z(se.annotationId));else if(e.DeleteFile.is(se))Se.deleteFile(v(se.uri),se.options,z(se.annotationId));else if(e.TextDocumentEdit.is(se)){const We=v(se.textDocument.uri);for(const le of se.edits)e.AnnotatedTextEdit.is(le)?Se.replace(We,N(le.range),le.newText,z(le.annotationId)):Se.replace(We,N(le.range),le.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(se,void 0,4)}`)},_)}else if(t.changes){const Te=t.changes;await R.forEach(Object.keys(Te),se=>{Se.set(v(se),ce(Te[se]))},_)}return Se}function ln(t){if(t!==void 0)return{label:t.label,needsConfirmation:!!t.needsConfirmation,description:t.description}}function Wt(t){let _=N(t.range),$=t.target?x(t.target):void 0,z=new s.default(_,$);return t.tooltip!==void 0&&(z.tooltip=t.tooltip),t.data!==void 0&&t.data!==null&&(z.data=t.data),z}async function Ge(t,_){if(t)return R.map(t,Wt,_)}function Ut(t){return new l.Color(t.red,t.green,t.blue,t.alpha)}function zt(t){return new l.ColorInformation(N(t.range),Ut(t.color))}async function dn(t,_){if(t)return R.map(t,zt,_)}function jt(t){let _=new l.ColorPresentation(t.label);return _.additionalTextEdits=ce(t.additionalTextEdits),t.textEdit&&(_.textEdit=G(t.textEdit)),_}async function gn(t,_){if(t)return R.map(t,jt,_)}function Bt(t){if(t)switch(t){case e.FoldingRangeKind.Comment:return l.FoldingRangeKind.Comment;case e.FoldingRangeKind.Imports:return l.FoldingRangeKind.Imports;case e.FoldingRangeKind.Region:return l.FoldingRangeKind.Region}}function Vt(t){return new l.FoldingRange(t.startLine,t.endLine,Bt(t.kind))}async function fn(t,_){if(t)return R.map(t,Vt,_)}function st(t){return new l.SelectionRange(N(t.range),t.parent?st(t.parent):void 0)}async function hn(t,_){return Array.isArray(t)?R.map(t,st,_):[]}function Qt(t){return e.InlineValueText.is(t)?new l.InlineValueText(N(t.range),t.text):e.InlineValueVariableLookup.is(t)?new l.InlineValueVariableLookup(N(t.range),t.variableName,t.caseSensitiveLookup):new l.InlineValueEvaluatableExpression(N(t.range),t.expression)}async function Gt(t,_){return Array.isArray(t)?R.map(t,Qt,_):[]}async function o(t,_){const $=typeof t.label=="string"?t.label:await R.map(t.label,q,_),z=new p.default(W(t.position),$);return t.kind!==void 0&&(z.kind=t.kind),t.textEdits!==void 0&&(z.textEdits=await Y(t.textEdits,_)),t.tooltip!==void 0&&(z.tooltip=U(t.tooltip)),t.paddingLeft!==void 0&&(z.paddingLeft=t.paddingLeft),t.paddingRight!==void 0&&(z.paddingRight=t.paddingRight),t.data!==void 0&&(z.data=t.data),z}function q(t){const _=new l.InlayHintLabelPart(t.value);return t.location!==void 0&&(_.location=Fe(t.location)),t.tooltip!==void 0&&(_.tooltip=U(t.tooltip)),t.command!==void 0&&(_.command=ke(t.command)),_}function U(t){return typeof t=="string"?t:ae(t)}async function ue(t,_){if(Array.isArray(t))return R.mapAsync(t,o,_)}function re(t){if(t===null)return;const _=new m.default(te(t.kind),t.name,t.detail||"",x(t.uri),N(t.range),N(t.selectionRange),t.data);return t.tags!==void 0&&(_.tags=ve(t.tags)),_}async function De(t,_){if(t!==null)return R.map(t,re,_)}async function Ee(t,_){return new l.CallHierarchyIncomingCall(re(t.from),await A(t.fromRanges,_))}async function ze(t,_){if(t!==null)return R.mapAsync(t,Ee,_)}async function xn(t,_){return new l.CallHierarchyOutgoingCall(re(t.to),await A(t.fromRanges,_))}async function cr(t,_){if(t!==null)return R.mapAsync(t,xn,_)}async function ur(t,_){if(t!=null)return new l.SemanticTokens(new Uint32Array(t.data),t.resultId)}function Fn(t){return new l.SemanticTokensEdit(t.start,t.deleteCount,t.data!==void 0?new Uint32Array(t.data):void 0)}async function lr(t,_){if(t!=null)return new l.SemanticTokensEdits(t.edits.map(Fn),t.resultId)}function dr(t){return t}async function gr(t,_){if(t!=null)return new l.LinkedEditingRanges(await A(t.ranges,_),fr(t.wordPattern))}function fr(t){if(t!=null)return new RegExp(t)}function kn(t){if(t===null)return;let _=new y.default(te(t.kind),t.name,t.detail||"",x(t.uri),N(t.range),N(t.selectionRange),t.data);return t.tags!==void 0&&(_.tags=ve(t.tags)),_}async function hr(t,_){if(t!==null)return R.map(t,kn,_)}function pr(t){if(h.string(t))return t;if(e.RelativePattern.is(t)){if(e.URI.is(t.baseUri))return new l.RelativePattern(x(t.baseUri),t.pattern);if(e.WorkspaceFolder.is(t.baseUri)){const _=l.workspace.getWorkspaceFolder(x(t.baseUri.uri));return _!==void 0?new l.RelativePattern(_,t.pattern):void 0}}}async function mr(t,_){if(!t)return;if(Array.isArray(t))return R.map(t,Se=>pn(Se),_);const $=t,z=await R.map($.items,Se=>pn(Se),_);return new l.InlineCompletionList(z)}function pn(t){let _;typeof t.insertText=="string"?_=t.insertText:_=new l.SnippetString(t.insertText.value);let $;t.command&&($=ke(t.command));const z=new l.InlineCompletionItem(_,N(t.range),$);return t.filterText&&(z.filterText=t.filterText),z}return{asUri:x,asDocumentSelector:L,asDiagnostics:E,asDiagnostic:I,asRange:N,asRanges:A,asPosition:W,asDiagnosticSeverity:j,asDiagnosticTag:O,asHover:ye,asCompletionResult:ne,asCompletionItem:He,asTextEdit:G,asTextEdits:Y,asSignatureHelp:$e,asSignatureInformations:oe,asSignatureInformation:X,asParameterInformations:Oe,asParameterInformation:be,asDeclarationResult:Qe,asDefinitionResult:Ne,asLocation:Fe,asReferences:b,asDocumentHighlights:w,asDocumentHighlight:H,asDocumentHighlightKind:M,asSymbolKind:te,asSymbolTag:J,asSymbolTags:ve,asSymbolInformations:K,asSymbolInformation:he,asDocumentSymbols:nt,asDocumentSymbol:tt,asCommand:ke,asCommands:$t,asCodeAction:Kt,asCodeActionKind:rt,asCodeActionKinds:cn,asCodeActionResult:un,asCodeLens:At,asCodeLenses:Nt,asWorkspaceEdit:ot,asDocumentLink:Wt,asDocumentLinks:Ge,asFoldingRangeKind:Bt,asFoldingRange:Vt,asFoldingRanges:fn,asColor:Ut,asColorInformation:zt,asColorInformations:dn,asColorPresentation:jt,asColorPresentations:gn,asSelectionRange:st,asSelectionRanges:hn,asInlineValue:Qt,asInlineValues:Gt,asInlayHint:o,asInlayHints:ue,asSemanticTokensLegend:dr,asSemanticTokens:ur,asSemanticTokensEdit:Fn,asSemanticTokensEdits:lr,asCallHierarchyItem:re,asCallHierarchyItems:De,asCallHierarchyIncomingCall:Ee,asCallHierarchyIncomingCalls:ze,asCallHierarchyOutgoingCall:xn,asCallHierarchyOutgoingCalls:cr,asLinkedEditingRanges:gr,asTypeHierarchyItem:kn,asTypeHierarchyItems:hr,asGlobPattern:pr,asInlineCompletionResult:mr,asInlineCompletionItem:pn}}return ct.createConverter=d,ct}var ut={},ci;function sr(){if(ci)return ut;ci=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.ProgressPart=void 0;const l=Q,e=Z(),h=Ue();class R{constructor(S,s,c){this._client=S,this._token=s,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(e.WorkDoneProgress.type,this._token,u=>{switch(u.kind){case"begin":this.begin(u);break;case"report":this.report(u);break;case"end":this.done(),c&&c(this);break}})}begin(S){this._infinite=S.percentage===void 0,this._lspProgressDisposable!==void 0&&l.window.withProgress({location:l.ProgressLocation.Window,cancellable:S.cancellable,title:S.title},async(s,c)=>{if(this._lspProgressDisposable!==void 0)return this._progress=s,this._cancellationToken=c,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(e.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(S),new Promise((u,m)=>{this._resolve=u,this._reject=m})})}report(S){if(this._infinite&&h.string(S.message))this._progress!==void 0&&this._progress.report({message:S.message});else if(h.number(S.percentage)){const s=Math.max(0,Math.min(S.percentage,100)),c=Math.max(0,s-this._reported);this._reported+=c,this._progress!==void 0&&this._progress.report({message:S.message,increment:c})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}}return ut.ProgressPart=R,ut}var lt={},ui;function _p(){if(ui)return lt;ui=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.NotebookDocumentSyncFeature=void 0;const l=Q,e=wn(),h=Z(),R=fe(),k=Ue();function S(r,i){return r[i]===void 0&&(r[i]={}),r[i]}var s;(function(r){(function(i){function d(D,I){return{version:D.version,uri:I.asUri(D.uri)}}i.asVersionedNotebookDocumentIdentifier=d;function f(D,I,F){const P=h.NotebookDocument.create(F.asUri(D.uri),D.notebookType,D.version,C(I,F));return Object.keys(D.metadata).length>0&&(P.metadata=n(D.metadata)),P}i.asNotebookDocument=f;function C(D,I){return D.map(F=>g(F,I))}i.asNotebookCells=C;function n(D){return x(new Set,D)}i.asMetadata=n;function g(D,I){const F=h.NotebookCell.create(v(D.kind),I.asUri(D.document.uri));return Object.keys(D.metadata).length>0&&(F.metadata=n(D.metadata)),D.executionSummary!==void 0&&k.number(D.executionSummary.executionOrder)&&k.boolean(D.executionSummary.success)&&(F.executionSummary={executionOrder:D.executionSummary.executionOrder,success:D.executionSummary.success}),F}i.asNotebookCell=g;function v(D){switch(D){case l.NotebookCellKind.Markup:return h.NotebookCellKind.Markup;case l.NotebookCellKind.Code:return h.NotebookCellKind.Code}}function x(D,I){if(D.has(I))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(I)){const F=[];for(const P of I)if(P!==null&&typeof P=="object"||Array.isArray(P))F.push(x(D,P));else{if(P instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");F.push(P)}return F}else{const F=Object.keys(I),P=Object.create(null);for(const O of F){const W=I[O];if(W!==null&&typeof W=="object"||Array.isArray(W))P[O]=x(D,W);else{if(W instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");P[O]=W}}return P}}function L(D,I){const F=I.asChangeTextDocumentParams(D,D.document.uri,D.document.version);return{document:F.textDocument,changes:F.contentChanges}}i.asTextContentChange=L;function E(D,I){const F=Object.create(null);if(D.metadata&&(F.metadata=r.c2p.asMetadata(D.metadata)),D.cells!==void 0){const P=Object.create(null),O=D.cells;O.structure&&(P.structure={array:{start:O.structure.array.start,deleteCount:O.structure.array.deleteCount,cells:O.structure.array.cells!==void 0?O.structure.array.cells.map(W=>r.c2p.asNotebookCell(W,I)):void 0},didOpen:O.structure.didOpen!==void 0?O.structure.didOpen.map(W=>I.asOpenTextDocumentParams(W.document).textDocument):void 0,didClose:O.structure.didClose!==void 0?O.structure.didClose.map(W=>I.asCloseTextDocumentParams(W.document).textDocument):void 0}),O.data!==void 0&&(P.data=O.data.map(W=>r.c2p.asNotebookCell(W,I))),O.textContent!==void 0&&(P.textContent=O.textContent.map(W=>r.c2p.asTextContentChange(W,I))),Object.keys(P).length>0&&(F.cells=P)}return F}i.asNotebookDocumentChangeEvent=E})(r.c2p||(r.c2p={}))})(s||(s={}));var c;(function(r){function i(v,x,L){const E=v.length,D=x.length;let I=0;for(;I<D&&I<E&&d(v[I],x[I],L);)I++;if(I<D&&I<E){let F=E-1,P=D-1;for(;F>=0&&P>=0&&d(v[F],x[P],L);)F--,P--;const O=F+1-I,W=I===P+1?void 0:x.slice(I,P+1);return W!==void 0?{start:I,deleteCount:O,cells:W}:{start:I,deleteCount:O}}else return I<D?{start:I,deleteCount:0,cells:x.slice(I)}:I<E?{start:I,deleteCount:E-I}:void 0}r.computeDiff=i;function d(v,x,L=!0){return v.kind!==x.kind||v.document.uri.toString()!==x.document.uri.toString()||v.document.languageId!==x.document.languageId||!f(v.executionSummary,x.executionSummary)?!1:!L||L&&n(v.metadata,x.metadata)}function f(v,x){return v===x?!0:v===void 0||x===void 0?!1:v.executionOrder===x.executionOrder&&v.success===x.success&&C(v.timing,x.timing)}function C(v,x){return v===x?!0:v===void 0||x===void 0?!1:v.startTime===x.startTime&&v.endTime===x.endTime}function n(v,x){if(v===x)return!0;if(v==null||x===null||x===void 0||typeof v!=typeof x||typeof v!="object")return!1;const L=Array.isArray(v),E=Array.isArray(x);if(L!==E)return!1;if(L&&E){if(v.length!==x.length)return!1;for(let D=0;D<v.length;D++)if(!n(v[D],x[D]))return!1}if(g(v)&&g(x)){const D=Object.keys(v),I=Object.keys(x);if(D.length!==I.length||(D.sort(),I.sort(),!n(D,I)))return!1;for(let F=0;F<D.length;F++){const P=D[F];if(!n(v[P],x[P]))return!1}return!0}return!1}function g(v){return v!==null&&typeof v=="object"}r.isObjectLiteral=g})(c||(c={}));var u;(function(r){function i(d,f){if(typeof d=="string")return d==="*"||f.notebookType===d;if(d.notebookType!==void 0&&d.notebookType!=="*"&&f.notebookType!==d.notebookType)return!1;const C=f.uri;if(d.scheme!==void 0&&d.scheme!=="*"&&C.scheme!==d.scheme)return!1;if(d.pattern!==void 0){const n=new e.Minimatch(d.pattern,{noext:!0});if(!n.makeRe()||!n.match(C.fsPath))return!1}return!0}r.matchNotebook=i})(u||(u={}));var m;(function(r){function i(f){const C=f.notebookSelector,n=[];for(const g of C){const v=(typeof g.notebook=="string"?g.notebook:g.notebook?.notebookType)??"*",x=typeof g.notebook=="string"?void 0:g.notebook?.scheme,L=typeof g.notebook=="string"?void 0:g.notebook?.pattern;if(g.cells!==void 0)for(const E of g.cells)n.push(d(v,x,L,E.language));else n.push(d(v,x,L,void 0))}return n}r.asDocumentSelector=i;function d(f,C,n,g){return C===void 0&&n===void 0?{notebook:f,language:g}:{notebook:{notebookType:f,scheme:C,pattern:n},language:g}}})(m||(m={}));var y;(function(r){function i(d){return{cells:d,uris:new Set(d.map(f=>f.document.uri.toString()))}}r.create=i})(y||(y={}));class a{constructor(i,d){this.client=i,this.options=d,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=i.protocol2CodeConverter.asDocumentSelector(m.asDocumentSelector(d)),l.workspace.onDidOpenNotebookDocument(f=>{this.notebookDidOpen.add(f.uri.toString()),this.didOpen(f)},void 0,this.disposables);for(const f of l.workspace.notebookDocuments)this.notebookDidOpen.add(f.uri.toString()),this.didOpen(f);l.workspace.onDidChangeNotebookDocument(f=>this.didChangeNotebookDocument(f),void 0,this.disposables),this.options.save===!0&&l.workspace.onDidSaveNotebookDocument(f=>this.didSave(f),void 0,this.disposables),l.workspace.onDidCloseNotebookDocument(f=>{this.didClose(f),this.notebookDidOpen.delete(f.uri.toString())},void 0,this.disposables)}getState(){for(const i of l.workspace.notebookDocuments)if(this.getMatchingCells(i)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(i){return l.languages.match(this.selector,i)>0}didOpenNotebookCellTextDocument(i,d){if(l.languages.match(this.selector,d.document)===0||!this.notebookDidOpen.has(i.uri.toString()))return;const f=this.notebookSyncInfo.get(i.uri.toString()),C=this.cellMatches(i,d);if(f!==void 0){const n=f.uris.has(d.document.uri.toString());if(C&&n||!C&&!n)return;if(C){const g=this.getMatchingCells(i);if(g!==void 0){const v=this.asNotebookDocumentChangeEvent(i,void 0,f,g);v!==void 0&&this.doSendChange(v,g).catch(()=>{})}}}else C&&this.doSendOpen(i,[d]).catch(()=>{})}didChangeNotebookCellTextDocument(i,d){l.languages.match(this.selector,d.document)!==0&&this.doSendChange({notebook:i,cells:{textContent:[d]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(i,d){const f=this.notebookSyncInfo.get(i.uri.toString());if(f===void 0)return;const C=d.document.uri,n=f.cells.findIndex(g=>g.document.uri.toString()===C.toString());if(n!==-1)if(n===0&&f.cells.length===1)this.doSendClose(i,f.cells).catch(()=>{});else{const g=f.cells.slice(),v=g.splice(n,1);this.doSendChange({notebook:i,cells:{structure:{array:{start:n,deleteCount:1},didClose:v}}},g).catch(()=>{})}}dispose(){for(const i of this.disposables)i.dispose()}didOpen(i,d=this.getMatchingCells(i),f=this.notebookSyncInfo.get(i.uri.toString())){if(f!==void 0)if(d!==void 0){const C=this.asNotebookDocumentChangeEvent(i,void 0,f,d);C!==void 0&&this.doSendChange(C,d).catch(()=>{})}else this.doSendClose(i,[]).catch(()=>{});else{if(d===void 0)return;this.doSendOpen(i,d).catch(()=>{})}}didChangeNotebookDocument(i){const d=i.notebook,f=this.notebookSyncInfo.get(d.uri.toString());if(f===void 0){if(i.contentChanges.length===0)return;const C=this.getMatchingCells(d);if(C===void 0)return;this.didOpen(d,C,f)}else{const C=this.getMatchingCells(d);if(C===void 0){this.didClose(d,f);return}const n=this.asNotebookDocumentChangeEvent(i.notebook,i,f,C);n!==void 0&&this.doSendChange(n,C).catch(()=>{})}}didSave(i){this.notebookSyncInfo.get(i.uri.toString())!==void 0&&this.doSendSave(i).catch(()=>{})}didClose(i,d=this.notebookSyncInfo.get(i.uri.toString())){if(d===void 0)return;const f=i.getCells().filter(C=>d.uris.has(C.document.uri.toString()));this.doSendClose(i,f).catch(()=>{})}async sendDidOpenNotebookDocument(i){const d=this.getMatchingCells(i);if(d!==void 0)return this.doSendOpen(i,d)}async doSendOpen(i,d){const f=async(n,g)=>{const v=s.c2p.asNotebookDocument(n,g,this.client.code2ProtocolConverter),x=g.map(L=>this.client.code2ProtocolConverter.asTextDocumentItem(L.document));try{await this.client.sendNotification(h.DidOpenNotebookDocumentNotification.type,{notebookDocument:v,cellTextDocuments:x})}catch(L){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",L),L}},C=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(i.uri.toString(),y.create(d)),C?.didOpen!==void 0?C.didOpen(i,d,f):f(i,d)}async sendDidChangeNotebookDocument(i){return this.doSendChange(i,void 0)}async doSendChange(i,d=this.getMatchingCells(i.notebook)){const f=async n=>{try{await this.client.sendNotification(h.DidChangeNotebookDocumentNotification.type,{notebookDocument:s.c2p.asVersionedNotebookDocumentIdentifier(n.notebook,this.client.code2ProtocolConverter),change:s.c2p.asNotebookDocumentChangeEvent(n,this.client.code2ProtocolConverter)})}catch(g){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",g),g}},C=this.client.middleware?.notebooks;return i.cells?.structure!==void 0&&this.notebookSyncInfo.set(i.notebook.uri.toString(),y.create(d??[])),C?.didChange!==void 0?C?.didChange(i,f):f(i)}async sendDidSaveNotebookDocument(i){return this.doSendSave(i)}async doSendSave(i){const d=async C=>{try{await this.client.sendNotification(h.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(C.uri)}})}catch(n){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",n),n}},f=this.client.middleware?.notebooks;return f?.didSave!==void 0?f.didSave(i,d):d(i)}async sendDidCloseNotebookDocument(i){return this.doSendClose(i,this.getMatchingCells(i)??[])}async doSendClose(i,d){const f=async(n,g)=>{try{await this.client.sendNotification(h.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(n.uri)},cellTextDocuments:g.map(v=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(v.document))})}catch(v){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",v),v}},C=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(i.uri.toString()),C?.didClose!==void 0?C.didClose(i,d,f):f(i,d)}asNotebookDocumentChangeEvent(i,d,f,C){if(d!==void 0&&d.notebook!==i)throw new Error("Notebook must be identical");const n={notebook:i};d?.metadata!==void 0&&(n.metadata=s.c2p.asMetadata(d.metadata));let g;if(d?.cellChanges!==void 0&&d.cellChanges.length>0){const v=[];g=new Set(C.map(x=>x.document.uri.toString()));for(const x of d.cellChanges)g.has(x.cell.document.uri.toString())&&(x.executionSummary!==void 0||x.metadata!==void 0)&&v.push(x.cell);v.length>0&&(n.cells=n.cells??{},n.cells.data=v)}if((d?.contentChanges!==void 0&&d.contentChanges.length>0||d===void 0)&&f!==void 0&&C!==void 0){const v=f.cells,x=C,L=c.computeDiff(v,x,!1);let E,D;if(L!==void 0){E=L.cells===void 0?new Map:new Map(L.cells.map(P=>[P.document.uri.toString(),P])),D=L.deleteCount===0?new Map:new Map(v.slice(L.start,L.start+L.deleteCount).map(P=>[P.document.uri.toString(),P]));for(const P of Array.from(D.keys()))E.has(P)&&(D.delete(P),E.delete(P));n.cells=n.cells??{};const I=[],F=[];if(E.size>0||D.size>0){for(const P of E.values())I.push(P);for(const P of D.values())F.push(P)}n.cells.structure={array:L,didOpen:I,didClose:F}}}return Object.keys(n).length>1?n:void 0}getMatchingCells(i,d=i.getCells()){if(this.options.notebookSelector!==void 0){for(const f of this.options.notebookSelector)if(f.notebook===void 0||u.matchNotebook(f.notebook,i)){const C=this.filterCells(i,d,f.cells);return C.length===0?void 0:C}}}cellMatches(i,d){const f=this.getMatchingCells(i,[d]);return f!==void 0&&f[0]===d}filterCells(i,d,f){const C=f!==void 0?d.filter(n=>{const g=n.document.languageId;return f.some(v=>v.language==="*"||g===v.language)}):d;return typeof this.client.clientOptions.notebookDocumentOptions?.filterCells=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(i,C):C}}class p{constructor(i){this.client=i,this.registrations=new Map,this.registrationType=h.NotebookDocumentSyncRegistrationType.type,l.workspace.onDidOpenTextDocument(d=>{if(d.uri.scheme!==p.CellScheme)return;const[f,C]=this.findNotebookDocumentAndCell(d);if(!(f===void 0||C===void 0))for(const n of this.registrations.values())n instanceof a&&n.didOpenNotebookCellTextDocument(f,C)}),l.workspace.onDidChangeTextDocument(d=>{if(d.contentChanges.length===0)return;const f=d.document;if(f.uri.scheme!==p.CellScheme)return;const[C]=this.findNotebookDocumentAndCell(f);if(C!==void 0)for(const n of this.registrations.values())n instanceof a&&n.didChangeNotebookCellTextDocument(C,d)}),l.workspace.onDidCloseTextDocument(d=>{if(d.uri.scheme!==p.CellScheme)return;const[f,C]=this.findNotebookDocumentAndCell(d);if(!(f===void 0||C===void 0))for(const n of this.registrations.values())n instanceof a&&n.didCloseNotebookCellTextDocument(f,C)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(const i of this.registrations.values()){const d=i.getState();if(d.kind==="document"&&d.registrations===!0&&d.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(i){const d=S(S(i,"notebookDocument"),"synchronization");d.dynamicRegistration=!0,d.executionSummarySupport=!0}preInitialize(i){const d=i.notebookDocumentSync;d!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(m.asDocumentSelector(d)))}initialize(i){const d=i.notebookDocumentSync;if(d===void 0)return;const f=d.id??R.generateUuid();this.register({id:f,registerOptions:d})}register(i){const d=new a(this.client,i.registerOptions);this.registrations.set(i.id,d)}unregister(i){const d=this.registrations.get(i);d&&d.dispose()}clear(){for(const i of this.registrations.values())i.dispose();this.registrations.clear()}handles(i){if(i.uri.scheme!==p.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&l.languages.match(this.dedicatedChannel,i)>0)return!0;for(const d of this.registrations.values())if(d.handles(i))return!0;return!1}getProvider(i){for(const d of this.registrations.values())if(d.handles(i.document))return d}findNotebookDocumentAndCell(i){const d=i.uri.toString();for(const f of l.workspace.notebookDocuments)for(const C of f.getCells())if(C.document.uri.toString()===d)return[f,C];return[void 0,void 0]}}return lt.NotebookDocumentSyncFeature=p,p.CellScheme="vscode-notebook-cell",lt}var Be={},li;function bp(){if(li)return Be;li=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.SyncConfigurationFeature=Be.toJSONObject=Be.ConfigurationFeature=void 0;const l=Q,e=Z(),h=Ue(),R=fe(),k=ie();class S{constructor(m){this._client=m}getState(){return{kind:"static"}}fillClientCapabilities(m){m.workspace=m.workspace||{},m.workspace.configuration=!0}initialize(){let m=this._client;m.onRequest(e.ConfigurationRequest.type,(y,a)=>{let p=i=>{let d=[];for(let f of i.items){let C=f.scopeUri!==void 0&&f.scopeUri!==null?this._client.protocol2CodeConverter.asUri(f.scopeUri):void 0;d.push(this.getConfiguration(C,f.section!==null?f.section:void 0))}return d},r=m.middleware.workspace;return r&&r.configuration?r.configuration(y,a,p):p(y)})}getConfiguration(m,y){let a=null;if(y){let p=y.lastIndexOf(".");if(p===-1)a=s(l.workspace.getConfiguration(void 0,m).get(y));else{let r=l.workspace.getConfiguration(y.substr(0,p),m);r&&(a=s(r.get(y.substr(p+1))))}}else{let p=l.workspace.getConfiguration(void 0,m);a={};for(let r of Object.keys(p))p.has(r)&&(a[r]=s(p.get(r)))}return a===void 0&&(a=null),a}clear(){}}Be.ConfigurationFeature=S;function s(u){if(u){if(Array.isArray(u))return u.map(s);if(typeof u=="object"){const m=Object.create(null);for(const y in u)Object.prototype.hasOwnProperty.call(u,y)&&(m[y]=s(u[y]));return m}}return u}Be.toJSONObject=s;class c{constructor(m){this._client=m,this.isCleared=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return e.DidChangeConfigurationNotification.type}fillClientCapabilities(m){(0,k.ensure)((0,k.ensure)(m,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){this.isCleared=!1;let m=this._client.clientOptions.synchronize?.configurationSection;m!==void 0&&this.register({id:R.generateUuid(),registerOptions:{section:m}})}register(m){let y=l.workspace.onDidChangeConfiguration(a=>{this.onDidChangeConfiguration(m.registerOptions.section,a)});this._listeners.set(m.id,y),m.registerOptions.section!==void 0&&this.onDidChangeConfiguration(m.registerOptions.section,void 0)}unregister(m){let y=this._listeners.get(m);y&&(this._listeners.delete(m),y.dispose())}clear(){for(const m of this._listeners.values())m.dispose();this._listeners.clear(),this.isCleared=!0}onDidChangeConfiguration(m,y){if(this.isCleared)return;let a;if(h.string(m)?a=[m]:a=m,a!==void 0&&y!==void 0&&!a.some(d=>y.affectsConfiguration(d)))return;const p=async i=>i===void 0?this._client.sendNotification(e.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(e.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(i)});let r=this._client.middleware.workspace?.didChangeConfiguration;(r?r(a,p):p(a)).catch(i=>{this._client.error(`Sending notification ${e.DidChangeConfigurationNotification.type.method} failed`,i)})}extractSettingsInformation(m){function y(r,i){let d=r;for(let f=0;f<i.length-1;f++){let C=d[i[f]];C||(C=Object.create(null),d[i[f]]=C),d=C}return d}let a=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,p=Object.create(null);for(let r=0;r<m.length;r++){let i=m[r],d=i.indexOf("."),f=null;if(d>=0?f=l.workspace.getConfiguration(i.substr(0,d),a).get(i.substr(d+1)):f=l.workspace.getConfiguration(void 0,a).get(i),f){let C=m[r].split(".");y(p,C)[C[C.length-1]]=s(f)}}return p}}return Be.SyncConfigurationFeature=c,Be}var we={},di;function wp(){if(di)return we;di=1,Object.defineProperty(we,"__esModule",{value:!0}),we.DidSaveTextDocumentFeature=we.WillSaveWaitUntilFeature=we.WillSaveFeature=we.DidChangeTextDocumentFeature=we.DidCloseTextDocumentFeature=we.DidOpenTextDocumentFeature=void 0;const l=Q,e=Z(),h=ie(),R=fe();class k extends h.TextDocumentEventFeature{constructor(a,p){super(a,l.workspace.onDidOpenTextDocument,e.DidOpenTextDocumentNotification.type,()=>a.middleware.didOpen,r=>a.code2ProtocolConverter.asOpenTextDocumentParams(r),r=>r,h.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=p}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(a){(0,h.ensure)((0,h.ensure)(a,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(a,p){const r=a.resolvedTextDocumentSync;p&&r&&r.openClose&&this.register({id:R.generateUuid(),registerOptions:{documentSelector:p}})}get registrationType(){return e.DidOpenTextDocumentNotification.type}register(a){if(super.register(a),!a.registerOptions.documentSelector)return;const p=this._client.protocol2CodeConverter.asDocumentSelector(a.registerOptions.documentSelector);l.workspace.textDocuments.forEach(r=>{const i=r.uri.toString();if(!this._syncedDocuments.has(i)&&l.languages.match(p,r)>0&&!this._client.hasDedicatedTextSynchronizationFeature(r)){const d=this._client.middleware,f=C=>this._client.sendNotification(this._type,this._createParams(C));(d.didOpen?d.didOpen(r,f):f(r)).catch(C=>{this._client.error(`Sending document notification ${this._type.method} failed`,C)}),this._syncedDocuments.set(i,r)}})}getTextDocument(a){return a}notificationSent(a,p,r){this._syncedDocuments.set(a.uri.toString(),a),super.notificationSent(a,p,r)}}we.DidOpenTextDocumentFeature=k;class S extends h.TextDocumentEventFeature{constructor(a,p,r){super(a,l.workspace.onDidCloseTextDocument,e.DidCloseTextDocumentNotification.type,()=>a.middleware.didClose,i=>a.code2ProtocolConverter.asCloseTextDocumentParams(i),i=>i,h.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=p,this._pendingTextDocumentChanges=r}get registrationType(){return e.DidCloseTextDocumentNotification.type}fillClientCapabilities(a){(0,h.ensure)((0,h.ensure)(a,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(a,p){let r=a.resolvedTextDocumentSync;p&&r&&r.openClose&&this.register({id:R.generateUuid(),registerOptions:{documentSelector:p}})}async callback(a){await super.callback(a),this._pendingTextDocumentChanges.delete(a.uri.toString())}getTextDocument(a){return a}notificationSent(a,p,r){this._syncedDocuments.delete(a.uri.toString()),super.notificationSent(a,p,r)}unregister(a){const p=this._selectors.get(a);super.unregister(a);const r=this._selectors.values();this._syncedDocuments.forEach(i=>{if(l.languages.match(p,i)>0&&!this._selectorFilter(r,i)&&!this._client.hasDedicatedTextSynchronizationFeature(i)){let d=this._client.middleware,f=C=>this._client.sendNotification(this._type,this._createParams(C));this._syncedDocuments.delete(i.uri.toString()),(d.didClose?d.didClose(i,f):f(i)).catch(C=>{this._client.error(`Sending document notification ${this._type.method} failed`,C)})}})}}we.DidCloseTextDocumentFeature=S;class s extends h.DynamicDocumentFeature{constructor(a,p){super(a),this._changeData=new Map,this._onNotificationSent=new l.EventEmitter,this._onPendingChangeAdded=new l.EventEmitter,this._pendingTextDocumentChanges=p,this._syncKind=e.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return e.DidChangeTextDocumentNotification.type}fillClientCapabilities(a){(0,h.ensure)((0,h.ensure)(a,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(a,p){let r=a.resolvedTextDocumentSync;p&&r&&r.change!==void 0&&r.change!==e.TextDocumentSyncKind.None&&this.register({id:R.generateUuid(),registerOptions:Object.assign({},{documentSelector:p},{syncKind:r.change})})}register(a){a.registerOptions.documentSelector&&(this._listener||(this._listener=l.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(a.id,{syncKind:a.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(a.registerOptions.documentSelector)}),this.updateSyncKind(a.registerOptions.syncKind))}*getDocumentSelectors(){for(const a of this._changeData.values())yield a.documentSelector}async callback(a){if(a.contentChanges.length===0)return;const p=a.document.uri,r=a.document.version,i=[];for(const d of this._changeData.values())if(l.languages.match(d.documentSelector,a.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(a.document)){const f=this._client.middleware;if(d.syncKind===e.TextDocumentSyncKind.Incremental){const C=async n=>{const g=this._client.code2ProtocolConverter.asChangeTextDocumentParams(n,p,r);await this._client.sendNotification(e.DidChangeTextDocumentNotification.type,g),this.notificationSent(n.document,e.DidChangeTextDocumentNotification.type,g)};i.push(f.didChange?f.didChange(a,n=>C(n)):C(a))}else if(d.syncKind===e.TextDocumentSyncKind.Full){const C=async n=>{const g=n.document.uri.toString();this._pendingTextDocumentChanges.set(g,n.document),this._onPendingChangeAdded.fire()};i.push(f.didChange?f.didChange(a,n=>C(n)):C(a))}}return Promise.all(i).then(void 0,d=>{throw this._client.error(`Sending document notification ${e.DidChangeTextDocumentNotification.type.method} failed`,d),d})}notificationSent(a,p,r){this._onNotificationSent.fire({textDocument:a,type:p,params:r})}unregister(a){if(this._changeData.delete(a),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=e.TextDocumentSyncKind.None;else{this._syncKind=e.TextDocumentSyncKind.None;for(const p of this._changeData.values())if(this.updateSyncKind(p.syncKind),this._syncKind===e.TextDocumentSyncKind.Full)break}}clear(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=e.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(a){if(this._pendingTextDocumentChanges.size===0)return[];let p;if(a.size===0)p=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{p=[];for(const r of this._pendingTextDocumentChanges)a.has(r[0])||(p.push(r[1]),this._pendingTextDocumentChanges.delete(r[0]))}return p}getProvider(a){for(const p of this._changeData.values())if(l.languages.match(p.documentSelector,a)>0)return{send:r=>this.callback(r)}}updateSyncKind(a){if(this._syncKind!==e.TextDocumentSyncKind.Full)switch(a){case e.TextDocumentSyncKind.Full:this._syncKind=a;break;case e.TextDocumentSyncKind.Incremental:this._syncKind===e.TextDocumentSyncKind.None&&(this._syncKind=e.TextDocumentSyncKind.Incremental);break}}}we.DidChangeTextDocumentFeature=s;class c extends h.TextDocumentEventFeature{constructor(a){super(a,l.workspace.onWillSaveTextDocument,e.WillSaveTextDocumentNotification.type,()=>a.middleware.willSave,p=>a.code2ProtocolConverter.asWillSaveTextDocumentParams(p),p=>p.document,(p,r)=>h.TextDocumentEventFeature.textDocumentFilter(p,r.document))}get registrationType(){return e.WillSaveTextDocumentNotification.type}fillClientCapabilities(a){let p=(0,h.ensure)((0,h.ensure)(a,"textDocument"),"synchronization");p.willSave=!0}initialize(a,p){let r=a.resolvedTextDocumentSync;p&&r&&r.willSave&&this.register({id:R.generateUuid(),registerOptions:{documentSelector:p}})}getTextDocument(a){return a.document}}we.WillSaveFeature=c;class u extends h.DynamicDocumentFeature{constructor(a){super(a),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return e.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(a){let p=(0,h.ensure)((0,h.ensure)(a,"textDocument"),"synchronization");p.willSaveWaitUntil=!0}initialize(a,p){let r=a.resolvedTextDocumentSync;p&&r&&r.willSaveWaitUntil&&this.register({id:R.generateUuid(),registerOptions:{documentSelector:p}})}register(a){a.registerOptions.documentSelector&&(this._listener||(this._listener=l.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(a.id,this._client.protocol2CodeConverter.asDocumentSelector(a.registerOptions.documentSelector)))}callback(a){if(h.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),a.document)&&!this._client.hasDedicatedTextSynchronizationFeature(a.document)){let p=this._client.middleware,r=i=>this._client.sendRequest(e.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async d=>{let f=await this._client.protocol2CodeConverter.asTextEdits(d);return f===void 0?[]:f});a.waitUntil(p.willSaveWaitUntil?p.willSaveWaitUntil(a,r):r(a))}}unregister(a){this._selectors.delete(a),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}}we.WillSaveWaitUntilFeature=u;class m extends h.TextDocumentEventFeature{constructor(a){super(a,l.workspace.onDidSaveTextDocument,e.DidSaveTextDocumentNotification.type,()=>a.middleware.didSave,p=>a.code2ProtocolConverter.asSaveTextDocumentParams(p,this._includeText),p=>p,h.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return e.DidSaveTextDocumentNotification.type}fillClientCapabilities(a){(0,h.ensure)((0,h.ensure)(a,"textDocument"),"synchronization").didSave=!0}initialize(a,p){const r=a.resolvedTextDocumentSync;if(p&&r&&r.save){const i=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:R.generateUuid(),registerOptions:Object.assign({},{documentSelector:p},i)})}}register(a){this._includeText=!!a.registerOptions.includeText,super.register(a)}getTextDocument(a){return a}}return we.DidSaveTextDocumentFeature=m,we}var dt={},gi;function Pp(){if(gi)return dt;gi=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.CompletionItemFeature=void 0;const l=Q,e=Z(),h=ie(),R=fe(),k=[e.CompletionItemKind.Text,e.CompletionItemKind.Method,e.CompletionItemKind.Function,e.CompletionItemKind.Constructor,e.CompletionItemKind.Field,e.CompletionItemKind.Variable,e.CompletionItemKind.Class,e.CompletionItemKind.Interface,e.CompletionItemKind.Module,e.CompletionItemKind.Property,e.CompletionItemKind.Unit,e.CompletionItemKind.Value,e.CompletionItemKind.Enum,e.CompletionItemKind.Keyword,e.CompletionItemKind.Snippet,e.CompletionItemKind.Color,e.CompletionItemKind.File,e.CompletionItemKind.Reference,e.CompletionItemKind.Folder,e.CompletionItemKind.EnumMember,e.CompletionItemKind.Constant,e.CompletionItemKind.Struct,e.CompletionItemKind.Event,e.CompletionItemKind.Operator,e.CompletionItemKind.TypeParameter];class S extends h.TextDocumentLanguageFeature{constructor(c){super(c,e.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(c){let u=(0,h.ensure)((0,h.ensure)(c,"textDocument"),"completion");u.dynamicRegistration=!0,u.contextSupport=!0,u.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[e.MarkupKind.Markdown,e.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[e.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[e.InsertTextMode.asIs,e.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},u.insertTextMode=e.InsertTextMode.adjustIndentation,u.completionItemKind={valueSet:k},u.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode","data"]}}initialize(c,u){const m=this.getRegistrationOptions(u,c.completionProvider);m&&this.register({id:R.generateUuid(),registerOptions:m})}registerLanguageProvider(c,u){this.labelDetailsSupport.set(u,!!c.completionItem?.labelDetailsSupport);const m=c.triggerCharacters??[],y=c.allCommitCharacters,a=c.documentSelector,p={provideCompletionItems:(r,i,d,f)=>{const C=this._client,n=this._client.middleware,g=(v,x,L,E)=>C.sendRequest(e.CompletionRequest.type,C.code2ProtocolConverter.asCompletionParams(v,x,L),E).then(D=>E.isCancellationRequested?null:C.protocol2CodeConverter.asCompletionResult(D,y,E),D=>C.handleFailedRequest(e.CompletionRequest.type,E,D,null));return n.provideCompletionItem?n.provideCompletionItem(r,i,f,d,g):g(r,i,f,d)},resolveCompletionItem:c.resolveProvider?(r,i)=>{const d=this._client,f=this._client.middleware,C=(n,g)=>d.sendRequest(e.CompletionResolveRequest.type,d.code2ProtocolConverter.asCompletionItem(n,!!this.labelDetailsSupport.get(u)),g).then(v=>g.isCancellationRequested?null:d.protocol2CodeConverter.asCompletionItem(v),v=>d.handleFailedRequest(e.CompletionResolveRequest.type,g,v,n));return f.resolveCompletionItem?f.resolveCompletionItem(r,i,C):C(r,i)}:void 0};return[l.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(a),p,...m),p]}}return dt.CompletionItemFeature=S,dt}var gt={},fi;function xp(){if(fi)return gt;fi=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.HoverFeature=void 0;const l=Q,e=Z(),h=ie(),R=fe();class k extends h.TextDocumentLanguageFeature{constructor(s){super(s,e.HoverRequest.type)}fillClientCapabilities(s){const c=(0,h.ensure)((0,h.ensure)(s,"textDocument"),"hover");c.dynamicRegistration=!0,c.contentFormat=[e.MarkupKind.Markdown,e.MarkupKind.PlainText]}initialize(s,c){const u=this.getRegistrationOptions(c,s.hoverProvider);u&&this.register({id:R.generateUuid(),registerOptions:u})}registerLanguageProvider(s){const c=s.documentSelector,u={provideHover:(m,y,a)=>{const p=this._client,r=(d,f,C)=>p.sendRequest(e.HoverRequest.type,p.code2ProtocolConverter.asTextDocumentPositionParams(d,f),C).then(n=>C.isCancellationRequested?null:p.protocol2CodeConverter.asHover(n),n=>p.handleFailedRequest(e.HoverRequest.type,C,n,null)),i=p.middleware;return i.provideHover?i.provideHover(m,y,a,r):r(m,y,a)}};return[this.registerProvider(c,u),u]}registerProvider(s,c){return l.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(s),c)}}return gt.HoverFeature=k,gt}var ft={},hi;function Fp(){if(hi)return ft;hi=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.DefinitionFeature=void 0;const l=Q,e=Z(),h=ie(),R=fe();class k extends h.TextDocumentLanguageFeature{constructor(s){super(s,e.DefinitionRequest.type)}fillClientCapabilities(s){let c=(0,h.ensure)((0,h.ensure)(s,"textDocument"),"definition");c.dynamicRegistration=!0,c.linkSupport=!0}initialize(s,c){const u=this.getRegistrationOptions(c,s.definitionProvider);u&&this.register({id:R.generateUuid(),registerOptions:u})}registerLanguageProvider(s){const c=s.documentSelector,u={provideDefinition:(m,y,a)=>{const p=this._client,r=(d,f,C)=>p.sendRequest(e.DefinitionRequest.type,p.code2ProtocolConverter.asTextDocumentPositionParams(d,f),C).then(n=>C.isCancellationRequested?null:p.protocol2CodeConverter.asDefinitionResult(n,C),n=>p.handleFailedRequest(e.DefinitionRequest.type,C,n,null)),i=p.middleware;return i.provideDefinition?i.provideDefinition(m,y,a,r):r(m,y,a)}};return[this.registerProvider(c,u),u]}registerProvider(s,c){return l.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(s),c)}}return ft.DefinitionFeature=k,ft}var ht={},pi;function kp(){if(pi)return ht;pi=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.SignatureHelpFeature=void 0;const l=Q,e=Z(),h=ie(),R=fe();class k extends h.TextDocumentLanguageFeature{constructor(s){super(s,e.SignatureHelpRequest.type)}fillClientCapabilities(s){let c=(0,h.ensure)((0,h.ensure)(s,"textDocument"),"signatureHelp");c.dynamicRegistration=!0,c.signatureInformation={documentationFormat:[e.MarkupKind.Markdown,e.MarkupKind.PlainText]},c.signatureInformation.parameterInformation={labelOffsetSupport:!0},c.signatureInformation.activeParameterSupport=!0,c.contextSupport=!0}initialize(s,c){const u=this.getRegistrationOptions(c,s.signatureHelpProvider);u&&this.register({id:R.generateUuid(),registerOptions:u})}registerLanguageProvider(s){const c={provideSignatureHelp:(u,m,y,a)=>{const p=this._client,r=(d,f,C,n)=>p.sendRequest(e.SignatureHelpRequest.type,p.code2ProtocolConverter.asSignatureHelpParams(d,f,C),n).then(g=>n.isCancellationRequested?null:p.protocol2CodeConverter.asSignatureHelp(g,n),g=>p.handleFailedRequest(e.SignatureHelpRequest.type,n,g,null)),i=p.middleware;return i.provideSignatureHelp?i.provideSignatureHelp(u,m,a,y,r):r(u,m,a,y)}};return[this.registerProvider(s,c),c]}registerProvider(s,c){const u=this._client.protocol2CodeConverter.asDocumentSelector(s.documentSelector);if(s.retriggerCharacters===void 0){const m=s.triggerCharacters||[];return l.languages.registerSignatureHelpProvider(u,c,...m)}else{const m={triggerCharacters:s.triggerCharacters||[],retriggerCharacters:s.retriggerCharacters||[]};return l.languages.registerSignatureHelpProvider(u,c,m)}}}return ht.SignatureHelpFeature=k,ht}var pt={},mi;function Ip(){if(mi)return pt;mi=1,Object.defineProperty(pt,"__esModule",{value:!0}),pt.DocumentHighlightFeature=void 0;const l=Q,e=Z(),h=ie(),R=fe();class k extends h.TextDocumentLanguageFeature{constructor(s){super(s,e.DocumentHighlightRequest.type)}fillClientCapabilities(s){(0,h.ensure)((0,h.ensure)(s,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(s,c){const u=this.getRegistrationOptions(c,s.documentHighlightProvider);u&&this.register({id:R.generateUuid(),registerOptions:u})}registerLanguageProvider(s){const c=s.documentSelector,u={provideDocumentHighlights:(m,y,a)=>{const p=this._client,r=(d,f,C)=>p.sendRequest(e.DocumentHighlightRequest.type,p.code2ProtocolConverter.asTextDocumentPositionParams(d,f),C).then(n=>C.isCancellationRequested?null:p.protocol2CodeConverter.asDocumentHighlights(n,C),n=>p.handleFailedRequest(e.DocumentHighlightRequest.type,C,n,null)),i=p.middleware;return i.provideDocumentHighlights?i.provideDocumentHighlights(m,y,a,r):r(m,y,a)}};return[l.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(c),u),u]}}return pt.DocumentHighlightFeature=k,pt}var Dn={},Ci;function ar(){return Ci||(Ci=1,function(l){Object.defineProperty(l,"__esModule",{value:!0}),l.DocumentSymbolFeature=l.SupportedSymbolTags=l.SupportedSymbolKinds=void 0;const e=Q,h=Z(),R=ie(),k=fe();l.SupportedSymbolKinds=[h.SymbolKind.File,h.SymbolKind.Module,h.SymbolKind.Namespace,h.SymbolKind.Package,h.SymbolKind.Class,h.SymbolKind.Method,h.SymbolKind.Property,h.SymbolKind.Field,h.SymbolKind.Constructor,h.SymbolKind.Enum,h.SymbolKind.Interface,h.SymbolKind.Function,h.SymbolKind.Variable,h.SymbolKind.Constant,h.SymbolKind.String,h.SymbolKind.Number,h.SymbolKind.Boolean,h.SymbolKind.Array,h.SymbolKind.Object,h.SymbolKind.Key,h.SymbolKind.Null,h.SymbolKind.EnumMember,h.SymbolKind.Struct,h.SymbolKind.Event,h.SymbolKind.Operator,h.SymbolKind.TypeParameter],l.SupportedSymbolTags=[h.SymbolTag.Deprecated];class S extends R.TextDocumentLanguageFeature{constructor(c){super(c,h.DocumentSymbolRequest.type)}fillClientCapabilities(c){let u=(0,R.ensure)((0,R.ensure)(c,"textDocument"),"documentSymbol");u.dynamicRegistration=!0,u.symbolKind={valueSet:l.SupportedSymbolKinds},u.hierarchicalDocumentSymbolSupport=!0,u.tagSupport={valueSet:l.SupportedSymbolTags},u.labelSupport=!0}initialize(c,u){const m=this.getRegistrationOptions(u,c.documentSymbolProvider);m&&this.register({id:k.generateUuid(),registerOptions:m})}registerLanguageProvider(c){const u=c.documentSelector,m={provideDocumentSymbols:(a,p)=>{const r=this._client,i=async(f,C)=>{try{const n=await r.sendRequest(h.DocumentSymbolRequest.type,r.code2ProtocolConverter.asDocumentSymbolParams(f),C);if(C.isCancellationRequested||n===void 0||n===null)return null;if(n.length===0)return[];{const g=n[0];return h.DocumentSymbol.is(g)?await r.protocol2CodeConverter.asDocumentSymbols(n,C):await r.protocol2CodeConverter.asSymbolInformations(n,C)}}catch(n){return r.handleFailedRequest(h.DocumentSymbolRequest.type,C,n,null)}},d=r.middleware;return d.provideDocumentSymbols?d.provideDocumentSymbols(a,p,i):i(a,p)}},y=c.label!==void 0?{label:c.label}:void 0;return[e.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(u),m,y),m]}}l.DocumentSymbolFeature=S}(Dn)),Dn}var mt={},yi;function Ep(){if(yi)return mt;yi=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.WorkspaceSymbolFeature=void 0;const l=Q,e=Z(),h=ie(),R=ar(),k=fe();class S extends h.WorkspaceFeature{constructor(c){super(c,e.WorkspaceSymbolRequest.type)}fillClientCapabilities(c){let u=(0,h.ensure)((0,h.ensure)(c,"workspace"),"symbol");u.dynamicRegistration=!0,u.symbolKind={valueSet:R.SupportedSymbolKinds},u.tagSupport={valueSet:R.SupportedSymbolTags},u.resolveSupport={properties:["location.range"]}}initialize(c){c.workspaceSymbolProvider&&this.register({id:k.generateUuid(),registerOptions:c.workspaceSymbolProvider===!0?{workDoneProgress:!1}:c.workspaceSymbolProvider})}registerLanguageProvider(c){const u={provideWorkspaceSymbols:(m,y)=>{const a=this._client,p=(i,d)=>a.sendRequest(e.WorkspaceSymbolRequest.type,{query:i},d).then(f=>d.isCancellationRequested?null:a.protocol2CodeConverter.asSymbolInformations(f,d),f=>a.handleFailedRequest(e.WorkspaceSymbolRequest.type,d,f,null)),r=a.middleware;return r.provideWorkspaceSymbols?r.provideWorkspaceSymbols(m,y,p):p(m,y)},resolveWorkspaceSymbol:c.resolveProvider===!0?(m,y)=>{const a=this._client,p=(i,d)=>a.sendRequest(e.WorkspaceSymbolResolveRequest.type,a.code2ProtocolConverter.asWorkspaceSymbol(i),d).then(f=>d.isCancellationRequested?null:a.protocol2CodeConverter.asSymbolInformation(f),f=>a.handleFailedRequest(e.WorkspaceSymbolResolveRequest.type,d,f,null)),r=a.middleware;return r.resolveWorkspaceSymbol?r.resolveWorkspaceSymbol(m,y,p):p(m,y)}:void 0};return[l.languages.registerWorkspaceSymbolProvider(u),u]}}return mt.WorkspaceSymbolFeature=S,mt}var Ct={},vi;function qp(){if(vi)return Ct;vi=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.ReferencesFeature=void 0;const l=Q,e=Z(),h=ie(),R=fe();class k extends h.TextDocumentLanguageFeature{constructor(s){super(s,e.ReferencesRequest.type)}fillClientCapabilities(s){(0,h.ensure)((0,h.ensure)(s,"textDocument"),"references").dynamicRegistration=!0}initialize(s,c){const u=this.getRegistrationOptions(c,s.referencesProvider);u&&this.register({id:R.generateUuid(),registerOptions:u})}registerLanguageProvider(s){const c=s.documentSelector,u={provideReferences:(m,y,a,p)=>{const r=this._client,i=(f,C,n,g)=>r.sendRequest(e.ReferencesRequest.type,r.code2ProtocolConverter.asReferenceParams(f,C,n),g).then(v=>g.isCancellationRequested?null:r.protocol2CodeConverter.asReferences(v,g),v=>r.handleFailedRequest(e.ReferencesRequest.type,g,v,null)),d=r.middleware;return d.provideReferences?d.provideReferences(m,y,a,p,i):i(m,y,a,p)}};return[this.registerProvider(c,u),u]}registerProvider(s,c){return l.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(s),c)}}return Ct.ReferencesFeature=k,Ct}var yt={},Si;function Lp(){if(Si)return yt;Si=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.CodeActionFeature=void 0;const l=Q,e=Z(),h=fe(),R=ie();class k extends R.TextDocumentLanguageFeature{constructor(s){super(s,e.CodeActionRequest.type)}fillClientCapabilities(s){const c=(0,R.ensure)((0,R.ensure)(s,"textDocument"),"codeAction");c.dynamicRegistration=!0,c.isPreferredSupport=!0,c.disabledSupport=!0,c.dataSupport=!0,c.resolveSupport={properties:["edit"]},c.codeActionLiteralSupport={codeActionKind:{valueSet:[e.CodeActionKind.Empty,e.CodeActionKind.QuickFix,e.CodeActionKind.Refactor,e.CodeActionKind.RefactorExtract,e.CodeActionKind.RefactorInline,e.CodeActionKind.RefactorRewrite,e.CodeActionKind.Source,e.CodeActionKind.SourceOrganizeImports]}},c.honorsChangeAnnotations=!0}initialize(s,c){const u=this.getRegistrationOptions(c,s.codeActionProvider);u&&this.register({id:h.generateUuid(),registerOptions:u})}registerLanguageProvider(s){const c=s.documentSelector,u={provideCodeActions:(m,y,a,p)=>{const r=this._client,i=async(f,C,n,g)=>{const v={textDocument:r.code2ProtocolConverter.asTextDocumentIdentifier(f),range:r.code2ProtocolConverter.asRange(C),context:r.code2ProtocolConverter.asCodeActionContextSync(n)};return r.sendRequest(e.CodeActionRequest.type,v,g).then(x=>g.isCancellationRequested||x===null||x===void 0?null:r.protocol2CodeConverter.asCodeActionResult(x,g),x=>r.handleFailedRequest(e.CodeActionRequest.type,g,x,null))},d=r.middleware;return d.provideCodeActions?d.provideCodeActions(m,y,a,p,i):i(m,y,a,p)},resolveCodeAction:s.resolveProvider?(m,y)=>{const a=this._client,p=this._client.middleware,r=async(i,d)=>a.sendRequest(e.CodeActionResolveRequest.type,a.code2ProtocolConverter.asCodeActionSync(i),d).then(f=>d.isCancellationRequested?i:a.protocol2CodeConverter.asCodeAction(f,d),f=>a.handleFailedRequest(e.CodeActionResolveRequest.type,d,f,i));return p.resolveCodeAction?p.resolveCodeAction(m,y,r):r(m,y)}:void 0};return[l.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(c),u,s.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(s.codeActionKinds)}:void 0),u]}}return yt.CodeActionFeature=k,yt}var vt={},Di;function Op(){if(Di)return vt;Di=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.CodeLensFeature=void 0;const l=Q,e=Z(),h=fe(),R=ie();class k extends R.TextDocumentLanguageFeature{constructor(s){super(s,e.CodeLensRequest.type)}fillClientCapabilities(s){(0,R.ensure)((0,R.ensure)(s,"textDocument"),"codeLens").dynamicRegistration=!0,(0,R.ensure)((0,R.ensure)(s,"workspace"),"codeLens").refreshSupport=!0}initialize(s,c){this._client.onRequest(e.CodeLensRefreshRequest.type,async()=>{for(const y of this.getAllProviders())y.onDidChangeCodeLensEmitter.fire()});const m=this.getRegistrationOptions(c,s.codeLensProvider);m&&this.register({id:h.generateUuid(),registerOptions:m})}registerLanguageProvider(s){const c=s.documentSelector,u=new l.EventEmitter,m={onDidChangeCodeLenses:u.event,provideCodeLenses:(y,a)=>{const p=this._client,r=(d,f)=>p.sendRequest(e.CodeLensRequest.type,p.code2ProtocolConverter.asCodeLensParams(d),f).then(C=>f.isCancellationRequested?null:p.protocol2CodeConverter.asCodeLenses(C,f),C=>p.handleFailedRequest(e.CodeLensRequest.type,f,C,null)),i=p.middleware;return i.provideCodeLenses?i.provideCodeLenses(y,a,r):r(y,a)},resolveCodeLens:s.resolveProvider?(y,a)=>{const p=this._client,r=(d,f)=>p.sendRequest(e.CodeLensResolveRequest.type,p.code2ProtocolConverter.asCodeLens(d),f).then(C=>f.isCancellationRequested?d:p.protocol2CodeConverter.asCodeLens(C),C=>p.handleFailedRequest(e.CodeLensResolveRequest.type,f,C,d)),i=p.middleware;return i.resolveCodeLens?i.resolveCodeLens(y,a,r):r(y,a)}:void 0};return[l.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(c),m),{provider:m,onDidChangeCodeLensEmitter:u}]}}return vt.CodeLensFeature=k,vt}var Ve={},Ti;function Mp(){if(Ti)return Ve;Ti=1,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.DocumentOnTypeFormattingFeature=Ve.DocumentRangeFormattingFeature=Ve.DocumentFormattingFeature=void 0;const l=Q,e=Z(),h=fe(),R=ie();var k;(function(u){function m(y){const a=l.workspace.getConfiguration("files",y);return{trimTrailingWhitespace:a.get("trimTrailingWhitespace"),trimFinalNewlines:a.get("trimFinalNewlines"),insertFinalNewline:a.get("insertFinalNewline")}}u.fromConfiguration=m})(k||(k={}));class S extends R.TextDocumentLanguageFeature{constructor(m){super(m,e.DocumentFormattingRequest.type)}fillClientCapabilities(m){(0,R.ensure)((0,R.ensure)(m,"textDocument"),"formatting").dynamicRegistration=!0}initialize(m,y){const a=this.getRegistrationOptions(y,m.documentFormattingProvider);a&&this.register({id:h.generateUuid(),registerOptions:a})}registerLanguageProvider(m){const y=m.documentSelector,a={provideDocumentFormattingEdits:(p,r,i)=>{const d=this._client,f=(n,g,v)=>{const x={textDocument:d.code2ProtocolConverter.asTextDocumentIdentifier(n),options:d.code2ProtocolConverter.asFormattingOptions(g,k.fromConfiguration(n))};return d.sendRequest(e.DocumentFormattingRequest.type,x,v).then(L=>v.isCancellationRequested?null:d.protocol2CodeConverter.asTextEdits(L,v),L=>d.handleFailedRequest(e.DocumentFormattingRequest.type,v,L,null))},C=d.middleware;return C.provideDocumentFormattingEdits?C.provideDocumentFormattingEdits(p,r,i,f):f(p,r,i)}};return[l.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(y),a),a]}}Ve.DocumentFormattingFeature=S;class s extends R.TextDocumentLanguageFeature{constructor(m){super(m,e.DocumentRangeFormattingRequest.type)}fillClientCapabilities(m){const y=(0,R.ensure)((0,R.ensure)(m,"textDocument"),"rangeFormatting");y.dynamicRegistration=!0,y.rangesSupport=!0}initialize(m,y){const a=this.getRegistrationOptions(y,m.documentRangeFormattingProvider);a&&this.register({id:h.generateUuid(),registerOptions:a})}registerLanguageProvider(m){const y=m.documentSelector,a={provideDocumentRangeFormattingEdits:(p,r,i,d)=>{const f=this._client,C=(g,v,x,L)=>{const E={textDocument:f.code2ProtocolConverter.asTextDocumentIdentifier(g),range:f.code2ProtocolConverter.asRange(v),options:f.code2ProtocolConverter.asFormattingOptions(x,k.fromConfiguration(g))};return f.sendRequest(e.DocumentRangeFormattingRequest.type,E,L).then(D=>L.isCancellationRequested?null:f.protocol2CodeConverter.asTextEdits(D,L),D=>f.handleFailedRequest(e.DocumentRangeFormattingRequest.type,L,D,null))},n=f.middleware;return n.provideDocumentRangeFormattingEdits?n.provideDocumentRangeFormattingEdits(p,r,i,d,C):C(p,r,i,d)}};return m.rangesSupport&&(a.provideDocumentRangesFormattingEdits=(p,r,i,d)=>{const f=this._client,C=(g,v,x,L)=>{const E={textDocument:f.code2ProtocolConverter.asTextDocumentIdentifier(g),ranges:f.code2ProtocolConverter.asRanges(v),options:f.code2ProtocolConverter.asFormattingOptions(x,k.fromConfiguration(g))};return f.sendRequest(e.DocumentRangesFormattingRequest.type,E,L).then(D=>L.isCancellationRequested?null:f.protocol2CodeConverter.asTextEdits(D,L),D=>f.handleFailedRequest(e.DocumentRangesFormattingRequest.type,L,D,null))},n=f.middleware;return n.provideDocumentRangesFormattingEdits?n.provideDocumentRangesFormattingEdits(p,r,i,d,C):C(p,r,i,d)}),[l.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(y),a),a]}}Ve.DocumentRangeFormattingFeature=s;class c extends R.TextDocumentLanguageFeature{constructor(m){super(m,e.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(m){(0,R.ensure)((0,R.ensure)(m,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(m,y){const a=this.getRegistrationOptions(y,m.documentOnTypeFormattingProvider);a&&this.register({id:h.generateUuid(),registerOptions:a})}registerLanguageProvider(m){const y=m.documentSelector,a={provideOnTypeFormattingEdits:(r,i,d,f,C)=>{const n=this._client,g=(x,L,E,D,I)=>{let F={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(x),position:n.code2ProtocolConverter.asPosition(L),ch:E,options:n.code2ProtocolConverter.asFormattingOptions(D,k.fromConfiguration(x))};return n.sendRequest(e.DocumentOnTypeFormattingRequest.type,F,I).then(P=>I.isCancellationRequested?null:n.protocol2CodeConverter.asTextEdits(P,I),P=>n.handleFailedRequest(e.DocumentOnTypeFormattingRequest.type,I,P,null))},v=n.middleware;return v.provideOnTypeFormattingEdits?v.provideOnTypeFormattingEdits(r,i,d,f,C,g):g(r,i,d,f,C)}},p=m.moreTriggerCharacter||[];return[l.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(y),a,m.firstTriggerCharacter,...p),a]}}return Ve.DocumentOnTypeFormattingFeature=c,Ve}var St={},Ri;function Hp(){if(Ri)return St;Ri=1,Object.defineProperty(St,"__esModule",{value:!0}),St.RenameFeature=void 0;const l=Q,e=Z(),h=fe(),R=Ue(),k=ie();class S extends k.TextDocumentLanguageFeature{constructor(c){super(c,e.RenameRequest.type)}fillClientCapabilities(c){let u=(0,k.ensure)((0,k.ensure)(c,"textDocument"),"rename");u.dynamicRegistration=!0,u.prepareSupport=!0,u.prepareSupportDefaultBehavior=e.PrepareSupportDefaultBehavior.Identifier,u.honorsChangeAnnotations=!0}initialize(c,u){const m=this.getRegistrationOptions(u,c.renameProvider);m&&(R.boolean(c.renameProvider)&&(m.prepareProvider=!1),this.register({id:h.generateUuid(),registerOptions:m}))}registerLanguageProvider(c){const u=c.documentSelector,m={provideRenameEdits:(y,a,p,r)=>{const i=this._client,d=(C,n,g,v)=>{let x={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(C),position:i.code2ProtocolConverter.asPosition(n),newName:g};return i.sendRequest(e.RenameRequest.type,x,v).then(L=>v.isCancellationRequested?null:i.protocol2CodeConverter.asWorkspaceEdit(L,v),L=>i.handleFailedRequest(e.RenameRequest.type,v,L,null,!1))},f=i.middleware;return f.provideRenameEdits?f.provideRenameEdits(y,a,p,r,d):d(y,a,p,r)},prepareRename:c.prepareProvider?(y,a,p)=>{const r=this._client,i=(f,C,n)=>{let g={textDocument:r.code2ProtocolConverter.asTextDocumentIdentifier(f),position:r.code2ProtocolConverter.asPosition(C)};return r.sendRequest(e.PrepareRenameRequest.type,g,n).then(v=>n.isCancellationRequested?null:e.Range.is(v)?r.protocol2CodeConverter.asRange(v):this.isDefaultBehavior(v)?v.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):v&&e.Range.is(v.range)?{range:r.protocol2CodeConverter.asRange(v.range),placeholder:v.placeholder}:Promise.reject(new Error("The element can't be renamed.")),v=>{throw typeof v.message=="string"?new Error(v.message):new Error("The element can't be renamed.")})},d=r.middleware;return d.prepareRename?d.prepareRename(y,a,p,i):i(y,a,p)}:void 0};return[this.registerProvider(u,m),m]}registerProvider(c,u){return l.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(c),u)}isDefaultBehavior(c){const u=c;return u&&R.boolean(u.defaultBehavior)}}return St.RenameFeature=S,St}var Dt={},_i;function $p(){if(_i)return Dt;_i=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.DocumentLinkFeature=void 0;const l=Q,e=Z(),h=ie(),R=fe();class k extends h.TextDocumentLanguageFeature{constructor(s){super(s,e.DocumentLinkRequest.type)}fillClientCapabilities(s){const c=(0,h.ensure)((0,h.ensure)(s,"textDocument"),"documentLink");c.dynamicRegistration=!0,c.tooltipSupport=!0}initialize(s,c){const u=this.getRegistrationOptions(c,s.documentLinkProvider);u&&this.register({id:R.generateUuid(),registerOptions:u})}registerLanguageProvider(s){const c=s.documentSelector,u={provideDocumentLinks:(m,y)=>{const a=this._client,p=(i,d)=>a.sendRequest(e.DocumentLinkRequest.type,a.code2ProtocolConverter.asDocumentLinkParams(i),d).then(f=>d.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentLinks(f,d),f=>a.handleFailedRequest(e.DocumentLinkRequest.type,d,f,null)),r=a.middleware;return r.provideDocumentLinks?r.provideDocumentLinks(m,y,p):p(m,y)},resolveDocumentLink:s.resolveProvider?(m,y)=>{const a=this._client;let p=(i,d)=>a.sendRequest(e.DocumentLinkResolveRequest.type,a.code2ProtocolConverter.asDocumentLink(i),d).then(f=>d.isCancellationRequested?i:a.protocol2CodeConverter.asDocumentLink(f),f=>a.handleFailedRequest(e.DocumentLinkResolveRequest.type,d,f,i));const r=a.middleware;return r.resolveDocumentLink?r.resolveDocumentLink(m,y,p):p(m,y)}:void 0};return[l.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(c),u),u]}}return Dt.DocumentLinkFeature=k,Dt}var Tt={},bi;function Kp(){if(bi)return Tt;bi=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.ExecuteCommandFeature=void 0;const l=Q,e=Z(),h=fe(),R=ie();class k{constructor(s){this._client=s,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return e.ExecuteCommandRequest.type}fillClientCapabilities(s){(0,R.ensure)((0,R.ensure)(s,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(s){s.executeCommandProvider&&this.register({id:h.generateUuid(),registerOptions:Object.assign({},s.executeCommandProvider)})}register(s){const c=this._client,u=c.middleware,m=(y,a)=>{let p={command:y,arguments:a};return c.sendRequest(e.ExecuteCommandRequest.type,p).then(void 0,r=>c.handleFailedRequest(e.ExecuteCommandRequest.type,void 0,r,void 0))};if(s.registerOptions.commands){const y=[];for(const a of s.registerOptions.commands)y.push(l.commands.registerCommand(a,(...p)=>u.executeCommand?u.executeCommand(a,p,m):m(a,p)));this._commands.set(s.id,y)}}unregister(s){let c=this._commands.get(s);c&&c.forEach(u=>u.dispose())}clear(){this._commands.forEach(s=>{s.forEach(c=>c.dispose())}),this._commands.clear()}}return Tt.ExecuteCommandFeature=k,Tt}var Rt={},wi;function Ap(){if(wi)return Rt;wi=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.FileSystemWatcherFeature=void 0;const l=Q,e=Z(),h=ie();class R{constructor(S,s){this._client=S,this._notifyFileEvent=s,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return e.DidChangeWatchedFilesNotification.type}fillClientCapabilities(S){(0,h.ensure)((0,h.ensure)(S,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,h.ensure)((0,h.ensure)(S,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(S,s){}register(S){if(!Array.isArray(S.registerOptions.watchers))return;const s=[];for(const c of S.registerOptions.watchers){const u=this._client.protocol2CodeConverter.asGlobPattern(c.globPattern);if(u===void 0)continue;let m=!0,y=!0,a=!0;c.kind!==void 0&&c.kind!==null&&(m=(c.kind&e.WatchKind.Create)!==0,y=(c.kind&e.WatchKind.Change)!==0,a=(c.kind&e.WatchKind.Delete)!==0);const p=l.workspace.createFileSystemWatcher(u,!m,!y,!a);this.hookListeners(p,m,y,a,s),s.push(p)}this._watchers.set(S.id,s)}registerRaw(S,s){let c=[];for(let u of s)this.hookListeners(u,!0,!0,!0,c);this._watchers.set(S,c)}hookListeners(S,s,c,u,m){s&&S.onDidCreate(y=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(y),type:e.FileChangeType.Created}),null,m),c&&S.onDidChange(y=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(y),type:e.FileChangeType.Changed}),null,m),u&&S.onDidDelete(y=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(y),type:e.FileChangeType.Deleted}),null,m)}unregister(S){let s=this._watchers.get(S);if(s)for(let c of s)c.dispose()}clear(){this._watchers.forEach(S=>{for(let s of S)s.dispose()}),this._watchers.clear()}}return Rt.FileSystemWatcherFeature=R,Rt}var _t={},Pi;function Np(){if(Pi)return _t;Pi=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.ColorProviderFeature=void 0;const l=Q,e=Z(),h=ie();class R extends h.TextDocumentLanguageFeature{constructor(S){super(S,e.DocumentColorRequest.type)}fillClientCapabilities(S){(0,h.ensure)((0,h.ensure)(S,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(S,s){let[c,u]=this.getRegistration(s,S.colorProvider);!c||!u||this.register({id:c,registerOptions:u})}registerLanguageProvider(S){const s=S.documentSelector,c={provideColorPresentations:(u,m,y)=>{const a=this._client,p=(i,d,f)=>{const C={color:i,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(d.document),range:a.code2ProtocolConverter.asRange(d.range)};return a.sendRequest(e.ColorPresentationRequest.type,C,f).then(n=>f.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(n,f),n=>a.handleFailedRequest(e.ColorPresentationRequest.type,f,n,null))},r=a.middleware;return r.provideColorPresentations?r.provideColorPresentations(u,m,y,p):p(u,m,y)},provideDocumentColors:(u,m)=>{const y=this._client,a=(r,i)=>{const d={textDocument:y.code2ProtocolConverter.asTextDocumentIdentifier(r)};return y.sendRequest(e.DocumentColorRequest.type,d,i).then(f=>i.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(f,i),f=>y.handleFailedRequest(e.DocumentColorRequest.type,i,f,null))},p=y.middleware;return p.provideDocumentColors?p.provideDocumentColors(u,m,a):a(u,m)}};return[l.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(s),c),c]}}return _t.ColorProviderFeature=R,_t}var bt={},xi;function Wp(){if(xi)return bt;xi=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.ImplementationFeature=void 0;const l=Q,e=Z(),h=ie();class R extends h.TextDocumentLanguageFeature{constructor(S){super(S,e.ImplementationRequest.type)}fillClientCapabilities(S){let s=(0,h.ensure)((0,h.ensure)(S,"textDocument"),"implementation");s.dynamicRegistration=!0,s.linkSupport=!0}initialize(S,s){let[c,u]=this.getRegistration(s,S.implementationProvider);!c||!u||this.register({id:c,registerOptions:u})}registerLanguageProvider(S){const s=S.documentSelector,c={provideImplementation:(u,m,y)=>{const a=this._client,p=(i,d,f)=>a.sendRequest(e.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(i,d),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,f),C=>a.handleFailedRequest(e.ImplementationRequest.type,f,C,null)),r=a.middleware;return r.provideImplementation?r.provideImplementation(u,m,y,p):p(u,m,y)}};return[this.registerProvider(s,c),c]}registerProvider(S,s){return l.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(S),s)}}return bt.ImplementationFeature=R,bt}var wt={},Fi;function Up(){if(Fi)return wt;Fi=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.TypeDefinitionFeature=void 0;const l=Q,e=Z(),h=ie();class R extends h.TextDocumentLanguageFeature{constructor(S){super(S,e.TypeDefinitionRequest.type)}fillClientCapabilities(S){(0,h.ensure)((0,h.ensure)(S,"textDocument"),"typeDefinition").dynamicRegistration=!0;let s=(0,h.ensure)((0,h.ensure)(S,"textDocument"),"typeDefinition");s.dynamicRegistration=!0,s.linkSupport=!0}initialize(S,s){let[c,u]=this.getRegistration(s,S.typeDefinitionProvider);!c||!u||this.register({id:c,registerOptions:u})}registerLanguageProvider(S){const s=S.documentSelector,c={provideTypeDefinition:(u,m,y)=>{const a=this._client,p=(i,d,f)=>a.sendRequest(e.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(i,d),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,f),C=>a.handleFailedRequest(e.TypeDefinitionRequest.type,f,C,null)),r=a.middleware;return r.provideTypeDefinition?r.provideTypeDefinition(u,m,y,p):p(u,m,y)}};return[this.registerProvider(s,c),c]}registerProvider(S,s){return l.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(S),s)}}return wt.TypeDefinitionFeature=R,wt}var et={},ki;function zp(){if(ki)return et;ki=1,Object.defineProperty(et,"__esModule",{value:!0}),et.WorkspaceFoldersFeature=et.arrayDiff=void 0;const l=fe(),e=Q,h=Z();function R(s,c){if(s!=null)return s[c]}function k(s,c){return s.filter(u=>c.indexOf(u)<0)}et.arrayDiff=k;class S{constructor(c){this._client=c,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return h.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(c){const u=e.workspace.workspaceFolders;this.initializeWithFolders(u),u===void 0?c.workspaceFolders=null:c.workspaceFolders=u.map(m=>this.asProtocol(m))}initializeWithFolders(c){this._initialFolders=c}fillClientCapabilities(c){c.workspace=c.workspace||{},c.workspace.workspaceFolders=!0}initialize(c){const u=this._client;u.onRequest(h.WorkspaceFoldersRequest.type,a=>{const p=()=>{const i=e.workspace.workspaceFolders;return i===void 0?null:i.map(f=>this.asProtocol(f))},r=u.middleware.workspace;return r&&r.workspaceFolders?r.workspaceFolders(a,p):p()});const m=R(R(R(c,"workspace"),"workspaceFolders"),"changeNotifications");let y;typeof m=="string"?y=m:m===!0&&(y=l.generateUuid()),y&&this.register({id:y,registerOptions:void 0})}sendInitialEvent(c){let u;if(this._initialFolders&&c){const m=k(this._initialFolders,c),y=k(c,this._initialFolders);(y.length>0||m.length>0)&&(u=this.doSendEvent(y,m))}else this._initialFolders?u=this.doSendEvent([],this._initialFolders):c&&(u=this.doSendEvent(c,[]));u!==void 0&&u.catch(m=>{this._client.error(`Sending notification ${h.DidChangeWorkspaceFoldersNotification.type.method} failed`,m)})}doSendEvent(c,u){let m={event:{added:c.map(y=>this.asProtocol(y)),removed:u.map(y=>this.asProtocol(y))}};return this._client.sendNotification(h.DidChangeWorkspaceFoldersNotification.type,m)}register(c){let u=c.id,m=this._client,y=e.workspace.onDidChangeWorkspaceFolders(a=>{let p=d=>this.doSendEvent(d.added,d.removed),r=m.middleware.workspace;(r&&r.didChangeWorkspaceFolders?r.didChangeWorkspaceFolders(a,p):p(a)).catch(d=>{this._client.error(`Sending notification ${h.DidChangeWorkspaceFoldersNotification.type.method} failed`,d)})});this._listeners.set(u,y),this.sendInitialEvent(e.workspace.workspaceFolders)}unregister(c){let u=this._listeners.get(c);u!==void 0&&(this._listeners.delete(c),u.dispose())}clear(){for(let c of this._listeners.values())c.dispose();this._listeners.clear()}asProtocol(c){return c===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(c.uri),name:c.name}}}return et.WorkspaceFoldersFeature=S,et}var Pt={},Ii;function jp(){if(Ii)return Pt;Ii=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.FoldingRangeFeature=void 0;const l=Q,e=Z(),h=ie();class R extends h.TextDocumentLanguageFeature{constructor(S){super(S,e.FoldingRangeRequest.type)}fillClientCapabilities(S){let s=(0,h.ensure)((0,h.ensure)(S,"textDocument"),"foldingRange");s.dynamicRegistration=!0,s.rangeLimit=5e3,s.lineFoldingOnly=!0,s.foldingRangeKind={valueSet:[e.FoldingRangeKind.Comment,e.FoldingRangeKind.Imports,e.FoldingRangeKind.Region]},s.foldingRange={collapsedText:!1},(0,h.ensure)((0,h.ensure)(S,"workspace"),"foldingRange").refreshSupport=!0}initialize(S,s){this._client.onRequest(e.FoldingRangeRefreshRequest.type,async()=>{for(const m of this.getAllProviders())m.onDidChangeFoldingRange.fire()});let[c,u]=this.getRegistration(s,S.foldingRangeProvider);!c||!u||this.register({id:c,registerOptions:u})}registerLanguageProvider(S){const s=S.documentSelector,c=new l.EventEmitter,u={onDidChangeFoldingRanges:c.event,provideFoldingRanges:(m,y,a)=>{const p=this._client,r=(d,f,C)=>{const n={textDocument:p.code2ProtocolConverter.asTextDocumentIdentifier(d)};return p.sendRequest(e.FoldingRangeRequest.type,n,C).then(g=>C.isCancellationRequested?null:p.protocol2CodeConverter.asFoldingRanges(g,C),g=>p.handleFailedRequest(e.FoldingRangeRequest.type,C,g,null))},i=p.middleware;return i.provideFoldingRanges?i.provideFoldingRanges(m,y,a,r):r(m,y,a)}};return[l.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(s),u),{provider:u,onDidChangeFoldingRange:c}]}}return Pt.FoldingRangeFeature=R,Pt}var xt={},Ei;function Bp(){if(Ei)return xt;Ei=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.DeclarationFeature=void 0;const l=Q,e=Z(),h=ie();class R extends h.TextDocumentLanguageFeature{constructor(S){super(S,e.DeclarationRequest.type)}fillClientCapabilities(S){const s=(0,h.ensure)((0,h.ensure)(S,"textDocument"),"declaration");s.dynamicRegistration=!0,s.linkSupport=!0}initialize(S,s){const[c,u]=this.getRegistration(s,S.declarationProvider);!c||!u||this.register({id:c,registerOptions:u})}registerLanguageProvider(S){const s=S.documentSelector,c={provideDeclaration:(u,m,y)=>{const a=this._client,p=(i,d,f)=>a.sendRequest(e.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(i,d),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(C,f),C=>a.handleFailedRequest(e.DeclarationRequest.type,f,C,null)),r=a.middleware;return r.provideDeclaration?r.provideDeclaration(u,m,y,p):p(u,m,y)}};return[this.registerProvider(s,c),c]}registerProvider(S,s){return l.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(S),s)}}return xt.DeclarationFeature=R,xt}var Ft={},qi;function Vp(){if(qi)return Ft;qi=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.SelectionRangeFeature=void 0;const l=Q,e=Z(),h=ie();class R extends h.TextDocumentLanguageFeature{constructor(S){super(S,e.SelectionRangeRequest.type)}fillClientCapabilities(S){const s=(0,h.ensure)((0,h.ensure)(S,"textDocument"),"selectionRange");s.dynamicRegistration=!0}initialize(S,s){const[c,u]=this.getRegistration(s,S.selectionRangeProvider);!c||!u||this.register({id:c,registerOptions:u})}registerLanguageProvider(S){const s=S.documentSelector,c={provideSelectionRanges:(u,m,y)=>{const a=this._client,p=async(i,d,f)=>{const C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(i),positions:a.code2ProtocolConverter.asPositionsSync(d,f)};return a.sendRequest(e.SelectionRangeRequest.type,C,f).then(n=>f.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(n,f),n=>a.handleFailedRequest(e.SelectionRangeRequest.type,f,n,null))},r=a.middleware;return r.provideSelectionRanges?r.provideSelectionRanges(u,m,y,p):p(u,m,y)}};return[this.registerProvider(s,c),c]}registerProvider(S,s){return l.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(S),s)}}return Ft.SelectionRangeFeature=R,Ft}var kt={},Li;function Qp(){if(Li)return kt;Li=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.ProgressFeature=void 0;const l=Z(),e=sr();function h(k,S){return k[S]===void 0&&(k[S]=Object.create(null)),k[S]}class R{constructor(S){this._client=S,this.activeParts=new Set}getState(){return{kind:"window",id:l.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(S){h(S,"window").workDoneProgress=!0}initialize(){const S=this._client,s=u=>{this.activeParts.delete(u)},c=u=>{this.activeParts.add(new e.ProgressPart(this._client,u.token,s))};S.onRequest(l.WorkDoneProgressCreateRequest.type,c)}clear(){for(const S of this.activeParts)S.done();this.activeParts.clear()}}return kt.ProgressFeature=R,kt}var It={},Oi;function Gp(){if(Oi)return It;Oi=1,Object.defineProperty(It,"__esModule",{value:!0}),It.CallHierarchyFeature=void 0;const l=Q,e=Z(),h=ie();class R{constructor(s){this.client=s,this.middleware=s.middleware}prepareCallHierarchy(s,c,u){const m=this.client,y=this.middleware,a=(p,r,i)=>{const d=m.code2ProtocolConverter.asTextDocumentPositionParams(p,r);return m.sendRequest(e.CallHierarchyPrepareRequest.type,d,i).then(f=>i.isCancellationRequested?null:m.protocol2CodeConverter.asCallHierarchyItems(f,i),f=>m.handleFailedRequest(e.CallHierarchyPrepareRequest.type,i,f,null))};return y.prepareCallHierarchy?y.prepareCallHierarchy(s,c,u,a):a(s,c,u)}provideCallHierarchyIncomingCalls(s,c){const u=this.client,m=this.middleware,y=(a,p)=>{const r={item:u.code2ProtocolConverter.asCallHierarchyItem(a)};return u.sendRequest(e.CallHierarchyIncomingCallsRequest.type,r,p).then(i=>p.isCancellationRequested?null:u.protocol2CodeConverter.asCallHierarchyIncomingCalls(i,p),i=>u.handleFailedRequest(e.CallHierarchyIncomingCallsRequest.type,p,i,null))};return m.provideCallHierarchyIncomingCalls?m.provideCallHierarchyIncomingCalls(s,c,y):y(s,c)}provideCallHierarchyOutgoingCalls(s,c){const u=this.client,m=this.middleware,y=(a,p)=>{const r={item:u.code2ProtocolConverter.asCallHierarchyItem(a)};return u.sendRequest(e.CallHierarchyOutgoingCallsRequest.type,r,p).then(i=>p.isCancellationRequested?null:u.protocol2CodeConverter.asCallHierarchyOutgoingCalls(i,p),i=>u.handleFailedRequest(e.CallHierarchyOutgoingCallsRequest.type,p,i,null))};return m.provideCallHierarchyOutgoingCalls?m.provideCallHierarchyOutgoingCalls(s,c,y):y(s,c)}}class k extends h.TextDocumentLanguageFeature{constructor(s){super(s,e.CallHierarchyPrepareRequest.type)}fillClientCapabilities(s){const c=s,u=(0,h.ensure)((0,h.ensure)(c,"textDocument"),"callHierarchy");u.dynamicRegistration=!0}initialize(s,c){const[u,m]=this.getRegistration(c,s.callHierarchyProvider);!u||!m||this.register({id:u,registerOptions:m})}registerLanguageProvider(s){const c=this._client,u=new R(c);return[l.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(s.documentSelector),u),u]}}return It.CallHierarchyFeature=k,It}var Et={},Mi;function Yp(){if(Mi)return Et;Mi=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.SemanticTokensFeature=void 0;const l=Q,e=Z(),h=ie(),R=Ue();class k extends h.TextDocumentLanguageFeature{constructor(s){super(s,e.SemanticTokensRegistrationType.type)}fillClientCapabilities(s){const c=(0,h.ensure)((0,h.ensure)(s,"textDocument"),"semanticTokens");c.dynamicRegistration=!0,c.tokenTypes=[e.SemanticTokenTypes.namespace,e.SemanticTokenTypes.type,e.SemanticTokenTypes.class,e.SemanticTokenTypes.enum,e.SemanticTokenTypes.interface,e.SemanticTokenTypes.struct,e.SemanticTokenTypes.typeParameter,e.SemanticTokenTypes.parameter,e.SemanticTokenTypes.variable,e.SemanticTokenTypes.property,e.SemanticTokenTypes.enumMember,e.SemanticTokenTypes.event,e.SemanticTokenTypes.function,e.SemanticTokenTypes.method,e.SemanticTokenTypes.macro,e.SemanticTokenTypes.keyword,e.SemanticTokenTypes.modifier,e.SemanticTokenTypes.comment,e.SemanticTokenTypes.string,e.SemanticTokenTypes.number,e.SemanticTokenTypes.regexp,e.SemanticTokenTypes.operator,e.SemanticTokenTypes.decorator],c.tokenModifiers=[e.SemanticTokenModifiers.declaration,e.SemanticTokenModifiers.definition,e.SemanticTokenModifiers.readonly,e.SemanticTokenModifiers.static,e.SemanticTokenModifiers.deprecated,e.SemanticTokenModifiers.abstract,e.SemanticTokenModifiers.async,e.SemanticTokenModifiers.modification,e.SemanticTokenModifiers.documentation,e.SemanticTokenModifiers.defaultLibrary],c.formats=[e.TokenFormat.Relative],c.requests={range:!0,full:{delta:!0}},c.multilineTokenSupport=!1,c.overlappingTokenSupport=!1,c.serverCancelSupport=!0,c.augmentsSyntaxTokens=!0,(0,h.ensure)((0,h.ensure)(s,"workspace"),"semanticTokens").refreshSupport=!0}initialize(s,c){this._client.onRequest(e.SemanticTokensRefreshRequest.type,async()=>{for(const a of this.getAllProviders())a.onDidChangeSemanticTokensEmitter.fire()});const[m,y]=this.getRegistration(c,s.semanticTokensProvider);!m||!y||this.register({id:m,registerOptions:y})}registerLanguageProvider(s){const c=s.documentSelector,u=R.boolean(s.full)?s.full:s.full!==void 0,m=s.full!==void 0&&typeof s.full!="boolean"&&s.full.delta===!0,y=new l.EventEmitter,a=u?{onDidChangeSemanticTokens:y.event,provideDocumentSemanticTokens:(n,g)=>{const v=this._client,x=v.middleware,L=(E,D)=>{const I={textDocument:v.code2ProtocolConverter.asTextDocumentIdentifier(E)};return v.sendRequest(e.SemanticTokensRequest.type,I,D).then(F=>D.isCancellationRequested?null:v.protocol2CodeConverter.asSemanticTokens(F,D),F=>v.handleFailedRequest(e.SemanticTokensRequest.type,D,F,null))};return x.provideDocumentSemanticTokens?x.provideDocumentSemanticTokens(n,g,L):L(n,g)},provideDocumentSemanticTokensEdits:m?(n,g,v)=>{const x=this._client,L=x.middleware,E=(D,I,F)=>{const P={textDocument:x.code2ProtocolConverter.asTextDocumentIdentifier(D),previousResultId:I};return x.sendRequest(e.SemanticTokensDeltaRequest.type,P,F).then(async O=>F.isCancellationRequested?null:e.SemanticTokens.is(O)?await x.protocol2CodeConverter.asSemanticTokens(O,F):await x.protocol2CodeConverter.asSemanticTokensEdits(O,F),O=>x.handleFailedRequest(e.SemanticTokensDeltaRequest.type,F,O,null))};return L.provideDocumentSemanticTokensEdits?L.provideDocumentSemanticTokensEdits(n,g,v,E):E(n,g,v)}:void 0}:void 0,r=s.range===!0?{provideDocumentRangeSemanticTokens:(n,g,v)=>{const x=this._client,L=x.middleware,E=(D,I,F)=>{const P={textDocument:x.code2ProtocolConverter.asTextDocumentIdentifier(D),range:x.code2ProtocolConverter.asRange(I)};return x.sendRequest(e.SemanticTokensRangeRequest.type,P,F).then(O=>F.isCancellationRequested?null:x.protocol2CodeConverter.asSemanticTokens(O,F),O=>x.handleFailedRequest(e.SemanticTokensRangeRequest.type,F,O,null))};return L.provideDocumentRangeSemanticTokens?L.provideDocumentRangeSemanticTokens(n,g,v,E):E(n,g,v)}}:void 0,i=[],d=this._client,f=d.protocol2CodeConverter.asSemanticTokensLegend(s.legend),C=d.protocol2CodeConverter.asDocumentSelector(c);return a!==void 0&&i.push(l.languages.registerDocumentSemanticTokensProvider(C,a,f)),r!==void 0&&i.push(l.languages.registerDocumentRangeSemanticTokensProvider(C,r,f)),[new l.Disposable(()=>i.forEach(n=>n.dispose())),{range:r,full:a,onDidChangeSemanticTokensEmitter:y}]}}return Et.SemanticTokensFeature=k,Et}var Pe={},Hi;function Xp(){if(Hi)return Pe;Hi=1,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.WillDeleteFilesFeature=Pe.WillRenameFilesFeature=Pe.WillCreateFilesFeature=Pe.DidDeleteFilesFeature=Pe.DidRenameFilesFeature=Pe.DidCreateFilesFeature=void 0;const l=Q,e=wn(),h=Z(),R=fe();function k(C,n){return C[n]===void 0&&(C[n]={}),C[n]}function S(C,n){return C[n]}function s(C,n,g){C[n]=g}class c{constructor(n,g,v,x,L){this._client=n,this._event=g,this._registrationType=v,this._clientCapability=x,this._serverCapability=L,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(n){const g=k(k(n,"workspace"),"fileOperations");s(g,"dynamicRegistration",!0),s(g,this._clientCapability,!0)}initialize(n){const g=n.workspace?.fileOperations,v=g!==void 0?S(g,this._serverCapability):void 0;if(v?.filters!==void 0)try{this.register({id:R.generateUuid(),registerOptions:{filters:v.filters}})}catch(x){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${x}`)}}register(n){this._listener||(this._listener=this._event(this.send,this));const g=n.registerOptions.filters.map(v=>{const x=new e.Minimatch(v.pattern.glob,c.asMinimatchOptions(v.pattern.options));if(!x.makeRe())throw new Error(`Invalid pattern ${v.pattern.glob}!`);return{scheme:v.scheme,matcher:x,kind:v.pattern.matches}});this._filters.set(n.id,g)}unregister(n){this._filters.delete(n),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(n){return c.getFileType(n)}async filter(n,g){const v=await Promise.all(n.files.map(async L=>{const E=g(L),D=E.fsPath.replace(/\\/g,"/");for(const I of this._filters.values())for(const F of I)if(!(F.scheme!==void 0&&F.scheme!==E.scheme)){if(F.matcher.match(D)){if(F.kind===void 0)return!0;const P=await this.getFileType(E);if(P===void 0)return this._client.error(`Failed to determine file type for ${E.toString()}.`),!0;if(P===l.FileType.File&&F.kind===h.FileOperationPatternKind.file||P===l.FileType.Directory&&F.kind===h.FileOperationPatternKind.folder)return!0}else if(F.kind===h.FileOperationPatternKind.folder&&await c.getFileType(E)===l.FileType.Directory&&F.matcher.match(`${D}/`))return!0}return!1})),x=n.files.filter((L,E)=>v[E]);return{...n,files:x}}static async getFileType(n){try{return(await l.workspace.fs.stat(n)).type}catch{return}}static asMinimatchOptions(n){const g={dot:!0};return n?.ignoreCase===!0&&(g.nocase=!0),g}}class u extends c{constructor(n,g,v,x,L,E,D){super(n,g,v,x,L),this._notificationType=v,this._accessUri=E,this._createParams=D}async send(n){const g=await this.filter(n,this._accessUri);if(g.files.length){const v=async x=>this._client.sendNotification(this._notificationType,this._createParams(x));return this.doSend(g,v)}}}class m extends u{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(n){const g=n.fsPath;if(this._fsPathFileTypes.has(g))return this._fsPathFileTypes.get(g);const v=await c.getFileType(n);return v&&this._fsPathFileTypes.set(g,v),v}async cacheFileTypes(n,g){await this.filter(n,g)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(n){super.unregister(n),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}clear(){super.clear(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}}class y extends u{constructor(n){super(n,l.workspace.onDidCreateFiles,h.DidCreateFilesNotification.type,"didCreate","didCreate",g=>g,n.code2ProtocolConverter.asDidCreateFilesParams)}doSend(n,g){const v=this._client.middleware.workspace;return v?.didCreateFiles?v.didCreateFiles(n,g):g(n)}}Pe.DidCreateFilesFeature=y;class a extends m{constructor(n){super(n,l.workspace.onDidRenameFiles,h.DidRenameFilesNotification.type,"didRename","didRename",g=>g.oldUri,n.code2ProtocolConverter.asDidRenameFilesParams)}register(n){this._willListener||(this._willListener=l.workspace.onWillRenameFiles(this.willRename,this)),super.register(n)}willRename(n){n.waitUntil(this.cacheFileTypes(n,g=>g.oldUri))}doSend(n,g){this.clearFileTypeCache();const v=this._client.middleware.workspace;return v?.didRenameFiles?v.didRenameFiles(n,g):g(n)}}Pe.DidRenameFilesFeature=a;class p extends m{constructor(n){super(n,l.workspace.onDidDeleteFiles,h.DidDeleteFilesNotification.type,"didDelete","didDelete",g=>g,n.code2ProtocolConverter.asDidDeleteFilesParams)}register(n){this._willListener||(this._willListener=l.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(n)}willDelete(n){n.waitUntil(this.cacheFileTypes(n,g=>g))}doSend(n,g){this.clearFileTypeCache();const v=this._client.middleware.workspace;return v?.didDeleteFiles?v.didDeleteFiles(n,g):g(n)}}Pe.DidDeleteFilesFeature=p;class r extends c{constructor(n,g,v,x,L,E,D){super(n,g,v,x,L),this._requestType=v,this._accessUri=E,this._createParams=D}async send(n){const g=this.waitUntil(n);n.waitUntil(g)}async waitUntil(n){const g=await this.filter(n,this._accessUri);if(g.files.length){const v=x=>this._client.sendRequest(this._requestType,this._createParams(x),x.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(g,v)}else return}}class i extends r{constructor(n){super(n,l.workspace.onWillCreateFiles,h.WillCreateFilesRequest.type,"willCreate","willCreate",g=>g,n.code2ProtocolConverter.asWillCreateFilesParams)}doSend(n,g){const v=this._client.middleware.workspace;return v?.willCreateFiles?v.willCreateFiles(n,g):g(n)}}Pe.WillCreateFilesFeature=i;class d extends r{constructor(n){super(n,l.workspace.onWillRenameFiles,h.WillRenameFilesRequest.type,"willRename","willRename",g=>g.oldUri,n.code2ProtocolConverter.asWillRenameFilesParams)}doSend(n,g){const v=this._client.middleware.workspace;return v?.willRenameFiles?v.willRenameFiles(n,g):g(n)}}Pe.WillRenameFilesFeature=d;class f extends r{constructor(n){super(n,l.workspace.onWillDeleteFiles,h.WillDeleteFilesRequest.type,"willDelete","willDelete",g=>g,n.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(n,g){const v=this._client.middleware.workspace;return v?.willDeleteFiles?v.willDeleteFiles(n,g):g(n)}}return Pe.WillDeleteFilesFeature=f,Pe}var qt={},$i;function Jp(){if($i)return qt;$i=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.LinkedEditingFeature=void 0;const l=Q,e=Z(),h=ie();class R extends h.TextDocumentLanguageFeature{constructor(S){super(S,e.LinkedEditingRangeRequest.type)}fillClientCapabilities(S){const s=(0,h.ensure)((0,h.ensure)(S,"textDocument"),"linkedEditingRange");s.dynamicRegistration=!0}initialize(S,s){let[c,u]=this.getRegistration(s,S.linkedEditingRangeProvider);!c||!u||this.register({id:c,registerOptions:u})}registerLanguageProvider(S){const s=S.documentSelector,c={provideLinkedEditingRanges:(u,m,y)=>{const a=this._client,p=(i,d,f)=>a.sendRequest(e.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(i,d),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(C,f),C=>a.handleFailedRequest(e.LinkedEditingRangeRequest.type,f,C,null)),r=a.middleware;return r.provideLinkedEditingRange?r.provideLinkedEditingRange(u,m,y,p):p(u,m,y)}};return[this.registerProvider(s,c),c]}registerProvider(S,s){return l.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(S),s)}}return qt.LinkedEditingFeature=R,qt}var Lt={},Ki;function Zp(){if(Ki)return Lt;Ki=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.TypeHierarchyFeature=void 0;const l=Q,e=Z(),h=ie();class R{constructor(s){this.client=s,this.middleware=s.middleware}prepareTypeHierarchy(s,c,u){const m=this.client,y=this.middleware,a=(p,r,i)=>{const d=m.code2ProtocolConverter.asTextDocumentPositionParams(p,r);return m.sendRequest(e.TypeHierarchyPrepareRequest.type,d,i).then(f=>i.isCancellationRequested?null:m.protocol2CodeConverter.asTypeHierarchyItems(f,i),f=>m.handleFailedRequest(e.TypeHierarchyPrepareRequest.type,i,f,null))};return y.prepareTypeHierarchy?y.prepareTypeHierarchy(s,c,u,a):a(s,c,u)}provideTypeHierarchySupertypes(s,c){const u=this.client,m=this.middleware,y=(a,p)=>{const r={item:u.code2ProtocolConverter.asTypeHierarchyItem(a)};return u.sendRequest(e.TypeHierarchySupertypesRequest.type,r,p).then(i=>p.isCancellationRequested?null:u.protocol2CodeConverter.asTypeHierarchyItems(i,p),i=>u.handleFailedRequest(e.TypeHierarchySupertypesRequest.type,p,i,null))};return m.provideTypeHierarchySupertypes?m.provideTypeHierarchySupertypes(s,c,y):y(s,c)}provideTypeHierarchySubtypes(s,c){const u=this.client,m=this.middleware,y=(a,p)=>{const r={item:u.code2ProtocolConverter.asTypeHierarchyItem(a)};return u.sendRequest(e.TypeHierarchySubtypesRequest.type,r,p).then(i=>p.isCancellationRequested?null:u.protocol2CodeConverter.asTypeHierarchyItems(i,p),i=>u.handleFailedRequest(e.TypeHierarchySubtypesRequest.type,p,i,null))};return m.provideTypeHierarchySubtypes?m.provideTypeHierarchySubtypes(s,c,y):y(s,c)}}class k extends h.TextDocumentLanguageFeature{constructor(s){super(s,e.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(s){const c=(0,h.ensure)((0,h.ensure)(s,"textDocument"),"typeHierarchy");c.dynamicRegistration=!0}initialize(s,c){const[u,m]=this.getRegistration(c,s.typeHierarchyProvider);!u||!m||this.register({id:u,registerOptions:m})}registerLanguageProvider(s){const c=this._client,u=new R(c);return[l.languages.registerTypeHierarchyProvider(c.protocol2CodeConverter.asDocumentSelector(s.documentSelector),u),u]}}return Lt.TypeHierarchyFeature=k,Lt}var Ot={},Ai;function em(){if(Ai)return Ot;Ai=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.InlineValueFeature=void 0;const l=Q,e=Z(),h=ie();class R extends h.TextDocumentLanguageFeature{constructor(S){super(S,e.InlineValueRequest.type)}fillClientCapabilities(S){(0,h.ensure)((0,h.ensure)(S,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,h.ensure)((0,h.ensure)(S,"workspace"),"inlineValue").refreshSupport=!0}initialize(S,s){this._client.onRequest(e.InlineValueRefreshRequest.type,async()=>{for(const m of this.getAllProviders())m.onDidChangeInlineValues.fire()});const[c,u]=this.getRegistration(s,S.inlineValueProvider);!c||!u||this.register({id:c,registerOptions:u})}registerLanguageProvider(S){const s=S.documentSelector,c=new l.EventEmitter,u={onDidChangeInlineValues:c.event,provideInlineValues:(m,y,a,p)=>{const r=this._client,i=(f,C,n,g)=>{const v={textDocument:r.code2ProtocolConverter.asTextDocumentIdentifier(f),range:r.code2ProtocolConverter.asRange(C),context:r.code2ProtocolConverter.asInlineValueContext(n)};return r.sendRequest(e.InlineValueRequest.type,v,g).then(x=>g.isCancellationRequested?null:r.protocol2CodeConverter.asInlineValues(x,g),x=>r.handleFailedRequest(e.InlineValueRequest.type,g,x,null))},d=r.middleware;return d.provideInlineValues?d.provideInlineValues(m,y,a,p,i):i(m,y,a,p)}};return[this.registerProvider(s,u),{provider:u,onDidChangeInlineValues:c}]}registerProvider(S,s){return l.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(S),s)}}return Ot.InlineValueFeature=R,Ot}var Mt={},Ni;function tm(){if(Ni)return Mt;Ni=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.InlayHintsFeature=void 0;const l=Q,e=Z(),h=ie();class R extends h.TextDocumentLanguageFeature{constructor(S){super(S,e.InlayHintRequest.type)}fillClientCapabilities(S){const s=(0,h.ensure)((0,h.ensure)(S,"textDocument"),"inlayHint");s.dynamicRegistration=!0,s.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,h.ensure)((0,h.ensure)(S,"workspace"),"inlayHint").refreshSupport=!0}initialize(S,s){this._client.onRequest(e.InlayHintRefreshRequest.type,async()=>{for(const m of this.getAllProviders())m.onDidChangeInlayHints.fire()});const[c,u]=this.getRegistration(s,S.inlayHintProvider);!c||!u||this.register({id:c,registerOptions:u})}registerLanguageProvider(S){const s=S.documentSelector,c=new l.EventEmitter,u={onDidChangeInlayHints:c.event,provideInlayHints:(m,y,a)=>{const p=this._client,r=async(d,f,C)=>{const n={textDocument:p.code2ProtocolConverter.asTextDocumentIdentifier(d),range:p.code2ProtocolConverter.asRange(f)};try{const g=await p.sendRequest(e.InlayHintRequest.type,n,C);return C.isCancellationRequested?null:p.protocol2CodeConverter.asInlayHints(g,C)}catch(g){return p.handleFailedRequest(e.InlayHintRequest.type,C,g,null)}},i=p.middleware;return i.provideInlayHints?i.provideInlayHints(m,y,a,r):r(m,y,a)}};return u.resolveInlayHint=S.resolveProvider===!0?(m,y)=>{const a=this._client,p=async(i,d)=>{try{const f=await a.sendRequest(e.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(i),d);if(d.isCancellationRequested)return null;const C=a.protocol2CodeConverter.asInlayHint(f,d);return d.isCancellationRequested?null:C}catch(f){return a.handleFailedRequest(e.InlayHintResolveRequest.type,d,f,null)}},r=a.middleware;return r.resolveInlayHint?r.resolveInlayHint(m,y,p):p(m,y)}:void 0,[this.registerProvider(s,u),{provider:u,onDidChangeInlayHints:c}]}registerProvider(S,s){return l.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(S),s)}}return Mt.InlayHintsFeature=R,Mt}var Ht={},Wi;function nm(){if(Wi)return Ht;Wi=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.InlineCompletionItemFeature=void 0;const l=Q,e=Z(),h=ie(),R=fe();class k extends h.TextDocumentLanguageFeature{constructor(s){super(s,e.InlineCompletionRequest.type)}fillClientCapabilities(s){let c=(0,h.ensure)((0,h.ensure)(s,"textDocument"),"inlineCompletion");c.dynamicRegistration=!0}initialize(s,c){const u=this.getRegistrationOptions(c,s.inlineCompletionProvider);u&&this.register({id:R.generateUuid(),registerOptions:u})}registerLanguageProvider(s){const c=s.documentSelector,u={provideInlineCompletionItems:(m,y,a,p)=>{const r=this._client,i=this._client.middleware,d=(f,C,n,g)=>r.sendRequest(e.InlineCompletionRequest.type,r.code2ProtocolConverter.asInlineCompletionParams(f,C,n),g).then(v=>g.isCancellationRequested?null:r.protocol2CodeConverter.asInlineCompletionResult(v,g),v=>r.handleFailedRequest(e.InlineCompletionRequest.type,g,v,null));return i.provideInlineCompletionItems?i.provideInlineCompletionItems(m,y,a,p,d):d(m,y,a,p)}};return[l.languages.registerInlineCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(c),u),u]}}return Ht.InlineCompletionItemFeature=k,Ht}var Ui;function im(){if(Ui)return Ce;Ui=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.ProposedFeatures=Ce.BaseLanguageClient=Ce.MessageTransports=Ce.SuspendMode=Ce.State=Ce.CloseAction=Ce.ErrorAction=Ce.RevealOutputChannelOn=void 0;const l=Q,e=Z(),h=Tp(),R=Rp(),k=Ue(),S=Pn(),s=fe(),c=sr(),u=ie(),m=Yi(),y=_p(),a=bp(),p=wp(),r=Pp(),i=xp(),d=Fp(),f=kp(),C=Ip(),n=ar(),g=Ep(),v=qp(),x=Lp(),L=Op(),E=Mp(),D=Hp(),I=$p(),F=Kp(),P=Ap(),O=Np(),W=Wp(),N=Up(),A=zp(),j=jp(),V=Bp(),ee=Vp(),ae=Qp(),ye=Gp(),ne=Yp(),de=Xp(),qe=Jp(),Ae=Zp(),_e=em(),He=tm(),xe=nm();var Le;(function(B){B[B.Debug=0]="Debug",B[B.Info=1]="Info",B[B.Warn=2]="Warn",B[B.Error=3]="Error",B[B.Never=4]="Never"})(Le||(Ce.RevealOutputChannelOn=Le={}));var Ke;(function(B){B[B.Continue=1]="Continue",B[B.Shutdown=2]="Shutdown"})(Ke||(Ce.ErrorAction=Ke={}));var G;(function(B){B[B.DoNotRestart=1]="DoNotRestart",B[B.Restart=2]="Restart"})(G||(Ce.CloseAction=G={}));var Y;(function(B){B[B.Stopped=1]="Stopped",B[B.Starting=3]="Starting",B[B.Running=2]="Running"})(Y||(Ce.State=Y={}));var ce;(function(B){B.off="off",B.on="on"})(ce||(Ce.SuspendMode=ce={}));var $e;(function(B){function T(b){return b==null?!1:typeof b=="boolean"||typeof b=="object"&&b!==null&&k.stringArray(b.enabledCommands)?b:!1}B.sanitizeIsTrusted=T})($e||($e={}));class oe{constructor(T,b){this.client=T,this.maxRestartCount=b,this.restarts=[]}error(T,b,w){return w&&w<=3?{action:Ke.Continue}:{action:Ke.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:G.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:G.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:G.Restart})}}var X;(function(B){B.Initial="initial",B.Starting="starting",B.StartFailed="startFailed",B.Running="running",B.Stopping="stopping",B.Stopped="stopped"})(X||(X={}));var Oe;(function(B){function T(b){return b&&e.MessageReader.is(b.reader)&&e.MessageWriter.is(b.writer)}B.is=T})(Oe||(Ce.MessageTransports=Oe={}));class be{constructor(T,b,w){this._traceFormat=e.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new S.Semaphore(1),this._id=T,this._name=b,w=w||{};const H={isTrusted:!1,supportHtml:!1};w.markdown!==void 0&&(H.isTrusted=$e.sanitizeIsTrusted(w.markdown.isTrusted),H.supportHtml=w.markdown.supportHtml===!0),this._clientOptions={documentSelector:w.documentSelector??[],synchronize:w.synchronize??{},diagnosticCollectionName:w.diagnosticCollectionName,outputChannelName:w.outputChannelName??this._name,revealOutputChannelOn:w.revealOutputChannelOn??Le.Error,stdioEncoding:w.stdioEncoding??"utf8",initializationOptions:w.initializationOptions,initializationFailedHandler:w.initializationFailedHandler,progressOnInitialization:!!w.progressOnInitialization,errorHandler:w.errorHandler??this.createDefaultErrorHandler(w.connectionOptions?.maxRestartCount),middleware:w.middleware??{},uriConverters:w.uriConverters,workspaceFolder:w.workspaceFolder,connectionOptions:w.connectionOptions,markdown:H,diagnosticPullOptions:w.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:w.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=X.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,w.outputChannel?(this._outputChannel=w.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=w.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new S.Semaphore(1),this._pendingChangeDelayer=new S.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new S.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new e.Emitter,this._stateChangeEmitter=new e.Emitter,this._trace=e.Trace.Off,this._tracer={log:(M,K)=>{k.string(M)?this.logTrace(M,K):this.logObjectTrace(M)}},this._c2p=h.createConverter(w.uriConverters?w.uriConverters.code2Protocol:void 0),this._p2c=R.createConverter(w.uriConverters?w.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=l.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(T){let b=this.getPublicState();this._state=T;let w=this.getPublicState();w!==b&&this._stateChangeEmitter.fire({oldState:b,newState:w})}getPublicState(){switch(this.$state){case X.Starting:return Y.Starting;case X.Running:return Y.Running;default:return Y.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(T,...b){if(this.$state===X.StartFailed||this.$state===X.Stopping||this.$state===X.Stopped)return Promise.reject(new e.ResponseError(e.ErrorCodes.ConnectionInactive,"Client is not running"));const w=await this.$start();this._didChangeTextDocumentFeature.syncKind===e.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(w);const H=this._clientOptions.middleware?.sendRequest;if(H!==void 0){let M,K;return b.length===1?e.CancellationToken.is(b[0])?K=b[0]:M=b[0]:b.length===2&&(M=b[0],K=b[1]),H(T,M,K,(te,J,ve)=>{const he=[];return J!==void 0&&he.push(J),ve!==void 0&&he.push(ve),w.sendRequest(te,...he)})}else return w.sendRequest(T,...b)}onRequest(T,b){const w=typeof T=="string"?T:T.method;this._requestHandlers.set(w,b);const H=this.activeConnection();let M;return H!==void 0?(this._requestDisposables.set(w,H.onRequest(T,b)),M={dispose:()=>{const K=this._requestDisposables.get(w);K!==void 0&&(K.dispose(),this._requestDisposables.delete(w))}}):(this._pendingRequestHandlers.set(w,b),M={dispose:()=>{this._pendingRequestHandlers.delete(w);const K=this._requestDisposables.get(w);K!==void 0&&(K.dispose(),this._requestDisposables.delete(w))}}),{dispose:()=>{this._requestHandlers.delete(w),M.dispose()}}}async sendNotification(T,b){if(this.$state===X.StartFailed||this.$state===X.Stopping||this.$state===X.Stopped)return Promise.reject(new e.ResponseError(e.ErrorCodes.ConnectionInactive,"Client is not running"));const w=this._didChangeTextDocumentFeature.syncKind===e.TextDocumentSyncKind.Full;let H;w&&typeof T!="string"&&T.method===e.DidOpenTextDocumentNotification.method&&(H=b?.textDocument.uri,this._pendingOpenNotifications.add(H));const M=await this.$start();w&&await this.sendPendingFullTextDocumentChanges(M),H!==void 0&&this._pendingOpenNotifications.delete(H);const K=this._clientOptions.middleware?.sendNotification;return K?K(T,M.sendNotification.bind(M),b):M.sendNotification(T,b)}onNotification(T,b){const w=typeof T=="string"?T:T.method;this._notificationHandlers.set(w,b);const H=this.activeConnection();let M;return H!==void 0?(this._notificationDisposables.set(w,H.onNotification(T,b)),M={dispose:()=>{const K=this._notificationDisposables.get(w);K!==void 0&&(K.dispose(),this._notificationDisposables.delete(w))}}):(this._pendingNotificationHandlers.set(w,b),M={dispose:()=>{this._pendingNotificationHandlers.delete(w);const K=this._notificationDisposables.get(w);K!==void 0&&(K.dispose(),this._notificationDisposables.delete(w))}}),{dispose:()=>{this._notificationHandlers.delete(w),M.dispose()}}}async sendProgress(T,b,w){if(this.$state===X.StartFailed||this.$state===X.Stopping||this.$state===X.Stopped)return Promise.reject(new e.ResponseError(e.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(T,b,w)}catch(H){throw this.error(`Sending progress for token ${b} failed.`,H),H}}onProgress(T,b,w){this._progressHandlers.set(b,{type:T,handler:w});const H=this.activeConnection();let M;const K=this._clientOptions.middleware?.handleWorkDoneProgress,te=e.WorkDoneProgress.is(T)&&K!==void 0?J=>{K(b,J,()=>w(J))}:w;return H!==void 0?(this._progressDisposables.set(b,H.onProgress(T,b,te)),M={dispose:()=>{const J=this._progressDisposables.get(b);J!==void 0&&(J.dispose(),this._progressDisposables.delete(b))}}):(this._pendingProgressHandlers.set(b,{type:T,handler:w}),M={dispose:()=>{this._pendingProgressHandlers.delete(b);const J=this._progressDisposables.get(b);J!==void 0&&(J.dispose(),this._progressDisposables.delete(b))}}),{dispose:()=>{this._progressHandlers.delete(b),M.dispose()}}}createDefaultErrorHandler(T){if(T!==void 0&&T<0)throw new Error(`Invalid maxRestartCount: ${T}`);return new oe(this,T??4)}async setTrace(T){this._trace=T;const b=this.activeConnection();b!==void 0&&await b.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(T){if(T instanceof e.ResponseError){const b=T;return`  Message: ${b.message}
  Code: ${b.code} ${b.data?`
`+b.data.toString():""}`}return T instanceof Error?k.string(T.stack)?T.stack:T.message:k.string(T)?T:T.toString()}debug(T,b,w=!0){this.logOutputMessage(e.MessageType.Debug,Le.Debug,"Debug",T,b,w)}info(T,b,w=!0){this.logOutputMessage(e.MessageType.Info,Le.Info,"Info",T,b,w)}warn(T,b,w=!0){this.logOutputMessage(e.MessageType.Warning,Le.Warn,"Warn",T,b,w)}error(T,b,w=!0){this.logOutputMessage(e.MessageType.Error,Le.Error,"Error",T,b,w)}logOutputMessage(T,b,w,H,M,K){this.outputChannel.appendLine(`[${w.padEnd(5)} - ${new Date().toLocaleTimeString()}] ${H}`),M!=null&&this.outputChannel.appendLine(this.data2String(M)),(K==="force"||K&&this._clientOptions.revealOutputChannelOn<=b)&&this.showNotificationMessage(T,H)}showNotificationMessage(T,b){b=b??"A request has failed. See the output for more information.",(T===e.MessageType.Error?l.window.showErrorMessage:T===e.MessageType.Warning?l.window.showWarningMessage:l.window.showInformationMessage)(b,"Go to output").then(H=>{H!==void 0&&this.outputChannel.show(!0)})}logTrace(T,b){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${T}`),b&&this.traceOutputChannel.appendLine(this.data2String(b))}logObjectTrace(T){T.isLSPMessage&&T.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),T&&this.traceOutputChannel.appendLine(`${JSON.stringify(T)}`)}needsStart(){return this.$state===X.Initial||this.$state===X.Stopping||this.$state===X.Stopped}needsStop(){return this.$state===X.Starting||this.$state===X.Running}activeConnection(){return this.$state===X.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===X.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===X.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;const[T,b,w]=this.createOnStartPromise();this._onStart=T,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?l.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):l.languages.createDiagnosticCollection());for(const[H,M]of this._notificationHandlers)this._pendingNotificationHandlers.has(H)||this._pendingNotificationHandlers.set(H,M);for(const[H,M]of this._requestHandlers)this._pendingRequestHandlers.has(H)||this._pendingRequestHandlers.set(H,M);for(const[H,M]of this._progressHandlers)this._pendingProgressHandlers.has(H)||this._pendingProgressHandlers.set(H,M);this.$state=X.Starting;try{const H=await this.createConnection();H.onNotification(e.LogMessageNotification.type,M=>{switch(M.type){case e.MessageType.Error:this.error(M.message,void 0,!1);break;case e.MessageType.Warning:this.warn(M.message,void 0,!1);break;case e.MessageType.Info:this.info(M.message,void 0,!1);break;case e.MessageType.Debug:this.debug(M.message,void 0,!1);break;default:this.outputChannel.appendLine(M.message)}}),H.onNotification(e.ShowMessageNotification.type,M=>{switch(M.type){case e.MessageType.Error:l.window.showErrorMessage(M.message);break;case e.MessageType.Warning:l.window.showWarningMessage(M.message);break;case e.MessageType.Info:l.window.showInformationMessage(M.message);break;default:l.window.showInformationMessage(M.message)}}),H.onRequest(e.ShowMessageRequest.type,M=>{let K;switch(M.type){case e.MessageType.Error:K=l.window.showErrorMessage;break;case e.MessageType.Warning:K=l.window.showWarningMessage;break;case e.MessageType.Info:K=l.window.showInformationMessage;break;default:K=l.window.showInformationMessage}let te=M.actions||[];return K(M.message,...te)}),H.onNotification(e.TelemetryEventNotification.type,M=>{this._telemetryEmitter.fire(M)}),H.onRequest(e.ShowDocumentRequest.type,async M=>{const K=async J=>{const ve=this.protocol2CodeConverter.asUri(J.uri);try{if(J.external===!0)return{success:await l.env.openExternal(ve)};{const he={};return J.selection!==void 0&&(he.selection=this.protocol2CodeConverter.asRange(J.selection)),J.takeFocus===void 0||J.takeFocus===!1?he.preserveFocus=!0:J.takeFocus===!0&&(he.preserveFocus=!1),await l.window.showTextDocument(ve,he),{success:!0}}}catch{return{success:!1}}},te=this._clientOptions.middleware.window?.showDocument;return te!==void 0?te(M,K):K(M)}),H.listen(),await this.initialize(H),b()}catch(H){this.$state=X.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,H,"force"),w(H)}return this._onStart}createOnStartPromise(){let T,b;return[new Promise((H,M)=>{T=H,b=M}),T,b]}async initialize(T){this.refreshTrace(T,!1);const b=this._clientOptions.initializationOptions,[w,H]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],M={processId:null,clientInfo:{name:l.env.appName,version:l.version},locale:this.getLocale(),rootPath:w||null,rootUri:w?this._c2p.asUri(l.Uri.file(w)):null,capabilities:this.computeClientCapabilities(),initializationOptions:k.func(b)?b():b,trace:e.Trace.toString(this._trace),workspaceFolders:H};if(this.fillInitializeParams(M),this._clientOptions.progressOnInitialization){const K=s.generateUuid(),te=new c.ProgressPart(T,K);M.workDoneToken=K;try{const J=await this.doInitialize(T,M);return te.done(),J}catch(J){throw te.cancel(),J}}else return this.doInitialize(T,M)}async doInitialize(T,b){try{const w=await T.initialize(b);if(w.capabilities.positionEncoding!==void 0&&w.capabilities.positionEncoding!==e.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${w.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=w,this.$state=X.Running;let H;k.number(w.capabilities.textDocumentSync)?w.capabilities.textDocumentSync===e.TextDocumentSyncKind.None?H={openClose:!1,change:e.TextDocumentSyncKind.None,save:void 0}:H={openClose:!0,change:w.capabilities.textDocumentSync,save:{includeText:!1}}:w.capabilities.textDocumentSync!==void 0&&w.capabilities.textDocumentSync!==null&&(H=w.capabilities.textDocumentSync),this._capabilities=Object.assign({},w.capabilities,{resolvedTextDocumentSync:H}),T.onNotification(e.PublishDiagnosticsNotification.type,M=>this.handleDiagnostics(M)),T.onRequest(e.RegistrationRequest.type,M=>this.handleRegistrationRequest(M)),T.onRequest("client/registerFeature",M=>this.handleRegistrationRequest(M)),T.onRequest(e.UnregistrationRequest.type,M=>this.handleUnregistrationRequest(M)),T.onRequest("client/unregisterFeature",M=>this.handleUnregistrationRequest(M)),T.onRequest(e.ApplyWorkspaceEditRequest.type,M=>this.handleApplyWorkspaceEdit(M));for(const[M,K]of this._pendingNotificationHandlers)this._notificationDisposables.set(M,T.onNotification(M,K));this._pendingNotificationHandlers.clear();for(const[M,K]of this._pendingRequestHandlers)this._requestDisposables.set(M,T.onRequest(M,K));this._pendingRequestHandlers.clear();for(const[M,K]of this._pendingProgressHandlers)this._progressDisposables.set(M,T.onProgress(K.type,M,K.handler));return this._pendingProgressHandlers.clear(),await T.sendNotification(e.InitializedNotification.type,{}),this.hookFileEvents(T),this.hookConfigurationChanged(T),this.initializeFeatures(T),w}catch(w){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(w)?this.initialize(T):this.stop():w instanceof e.ResponseError&&w.data&&w.data.retry?l.window.showErrorMessage(w.message,{title:"Retry",id:"retry"}).then(H=>{H&&H.id==="retry"?this.initialize(T):this.stop()}):(w&&w.message&&l.window.showErrorMessage(w.message),this.error("Server initialization failed.",w),this.stop()),w}}_clientGetRootPath(){let T=l.workspace.workspaceFolders;if(!T||T.length===0)return;let b=T[0];if(b.uri.scheme==="file")return b.uri.fsPath}stop(T=2e3){return this.shutdown("stop",T)}dispose(T=2e3){try{return this._disposed="disposing",this.stop(T)}finally{this._disposed="disposed"}}async shutdown(T,b){if(this.$state===X.Stopped||this.$state===X.Initial)return;if(this.$state===X.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}const w=this.activeConnection();if(w===void 0||this.$state!==X.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=X.Stopping,this.cleanUp(T);const H=new Promise(K=>{(0,e.RAL)().timer.setTimeout(K,b)}),M=(async K=>(await K.shutdown(),await K.exit(),K))(w);return this._onStop=Promise.race([H,M]).then(K=>{if(K!==void 0)K.end(),K.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},K=>{throw this.error("Stopping server failed",K,!1),K}).finally(()=>{this.$state=X.Stopped,T==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(T){this._fileEvents=[],this._fileEventDelayer.cancel();const b=this._listeners.splice(0,this._listeners.length);for(const w of b)w.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(const w of Array.from(this._features.entries()).map(H=>H[1]).reverse())w.clear();T==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(T){const b=this;async function w(M){return b._fileEvents.push(M),b._fileEventDelayer.trigger(async()=>{await b.sendNotification(e.DidChangeWatchedFilesNotification.type,{changes:b._fileEvents}),b._fileEvents=[]})}const H=this.clientOptions.middleware?.workspace;(H?.didChangeWatchedFile?H.didChangeWatchedFile(T,w):w(T)).catch(M=>{b.error("Notify file events failed.",M)})}async sendPendingFullTextDocumentChanges(T){return this._pendingChangeSemaphore.lock(async()=>{try{const b=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(b.length===0)return;for(const w of b){const H=this.code2ProtocolConverter.asChangeTextDocumentParams(w);await T.sendNotification(e.DidChangeTextDocumentNotification.type,H),this._didChangeTextDocumentFeature.notificationSent(w,e.DidChangeTextDocumentNotification.type,H)}}catch(b){throw this.error("Sending pending changes failed",b,!1),b}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{const T=this.activeConnection();if(T===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(T)}).catch(T=>this.error("Delivering pending changes failed",T,!1))}handleDiagnostics(T){if(!this._diagnostics)return;const b=T.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===b&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(T.uri,T.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,e.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;const T=this._diagnosticQueue.entries().next();if(T.done===!0)return;const[b,w]=T.value;this._diagnosticQueue.delete(b);const H=new l.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:b,tokenSource:H},this._p2c.asDiagnostics(w,H.token).then(M=>{if(!H.token.isCancellationRequested){const K=this._p2c.asUri(b),te=this.clientOptions.middleware;te.handleDiagnostics?te.handleDiagnostics(K,M,(J,ve)=>this.setDiagnostics(J,ve)):this.setDiagnostics(K,M)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(T,b){this._diagnostics&&this._diagnostics.set(T,b)}getLocale(){return l.env.language}async $start(){if(this.$state===X.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();const T=this.activeConnection();if(T===void 0)throw new Error("Starting server failed");return T}async createConnection(){let T=(H,M,K)=>{this.handleConnectionError(H,M,K).catch(te=>this.error("Handling connection error failed",te))},b=()=>{this.handleConnectionClosed().catch(H=>this.error("Handling connection close failed",H))};const w=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=Qe(w.reader,w.writer,T,b,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===X.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let T={action:G.DoNotRestart};if(this.$state!==X.Stopping)try{T=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,T.action===G.DoNotRestart?(this.error(T.message??"Connection to server got closed. Server will not be restarted.",void 0,T.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===X.Starting?this.$state=X.StartFailed:this.$state=X.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):T.action===G.Restart&&(this.info(T.message??"Connection to server got closed. Server will restart.",!T.handled),this.cleanUp("restart"),this.$state=X.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(b=>this.error("Restarting server failed",b,"force")))}async handleConnectionError(T,b,w){const H=await this._clientOptions.errorHandler.error(T,b,w);H.action===Ke.Shutdown?(this.error(H.message??`Client ${this._name}: connection to server is erroring.
${T.message}
Shutting down server.`,void 0,H.handled===!0?!1:"force"),this.stop().catch(M=>{this.error("Stopping server failed",M,!1)})):this.error(H.message??`Client ${this._name}: connection to server is erroring.
${T.message}`,void 0,H.handled===!0?!1:"force")}hookConfigurationChanged(T){this._listeners.push(l.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(T,!0)}))}refreshTrace(T,b=!1){const w=l.workspace.getConfiguration(this._id);let H=e.Trace.Off,M=e.TraceFormat.Text;if(w){const K=w.get("trace.server","off");typeof K=="string"?H=e.Trace.fromString(K):(H=e.Trace.fromString(w.get("trace.server.verbosity","off")),M=e.TraceFormat.fromString(w.get("trace.server.format","text")))}this._trace=H,this._traceFormat=M,T.trace(this._trace,this._tracer,{sendNotification:b,traceFormat:this._traceFormat}).catch(K=>{this.error("Updating trace failed with error",K,!1)})}hookFileEvents(T){let b=this._clientOptions.synchronize.fileEvents;if(!b)return;let w;k.array(b)?w=b:w=[b],w&&this._dynamicFeatures.get(e.DidChangeWatchedFilesNotification.type.method).registerRaw(s.generateUuid(),w)}registerFeatures(T){for(let b of T)this.registerFeature(b)}registerFeature(T){if(this._features.push(T),u.DynamicFeature.is(T)){const b=T.registrationType;this._dynamicFeatures.set(b.method,T)}}getFeature(T){return this._dynamicFeatures.get(T)}hasDedicatedTextSynchronizationFeature(T){const b=this.getFeature(e.NotebookDocumentSyncRegistrationType.method);return b===void 0||!(b instanceof y.NotebookDocumentSyncFeature)?!1:b.handles(T)}registerBuiltinFeatures(){const T=new Map;this.registerFeature(new a.ConfigurationFeature(this)),this.registerFeature(new p.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new p.DidChangeTextDocumentFeature(this,T),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new p.WillSaveFeature(this)),this.registerFeature(new p.WillSaveWaitUntilFeature(this)),this.registerFeature(new p.DidSaveTextDocumentFeature(this)),this.registerFeature(new p.DidCloseTextDocumentFeature(this,this._syncedDocuments,T)),this.registerFeature(new P.FileSystemWatcherFeature(this,b=>this.notifyFileEvent(b))),this.registerFeature(new r.CompletionItemFeature(this)),this.registerFeature(new i.HoverFeature(this)),this.registerFeature(new f.SignatureHelpFeature(this)),this.registerFeature(new d.DefinitionFeature(this)),this.registerFeature(new v.ReferencesFeature(this)),this.registerFeature(new C.DocumentHighlightFeature(this)),this.registerFeature(new n.DocumentSymbolFeature(this)),this.registerFeature(new g.WorkspaceSymbolFeature(this)),this.registerFeature(new x.CodeActionFeature(this)),this.registerFeature(new L.CodeLensFeature(this)),this.registerFeature(new E.DocumentFormattingFeature(this)),this.registerFeature(new E.DocumentRangeFormattingFeature(this)),this.registerFeature(new E.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new D.RenameFeature(this)),this.registerFeature(new I.DocumentLinkFeature(this)),this.registerFeature(new F.ExecuteCommandFeature(this)),this.registerFeature(new a.SyncConfigurationFeature(this)),this.registerFeature(new N.TypeDefinitionFeature(this)),this.registerFeature(new W.ImplementationFeature(this)),this.registerFeature(new O.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new A.WorkspaceFoldersFeature(this)),this.registerFeature(new j.FoldingRangeFeature(this)),this.registerFeature(new V.DeclarationFeature(this)),this.registerFeature(new ee.SelectionRangeFeature(this)),this.registerFeature(new ae.ProgressFeature(this)),this.registerFeature(new ye.CallHierarchyFeature(this)),this.registerFeature(new ne.SemanticTokensFeature(this)),this.registerFeature(new qe.LinkedEditingFeature(this)),this.registerFeature(new de.DidCreateFilesFeature(this)),this.registerFeature(new de.DidRenameFilesFeature(this)),this.registerFeature(new de.DidDeleteFilesFeature(this)),this.registerFeature(new de.WillCreateFilesFeature(this)),this.registerFeature(new de.WillRenameFilesFeature(this)),this.registerFeature(new de.WillDeleteFilesFeature(this)),this.registerFeature(new Ae.TypeHierarchyFeature(this)),this.registerFeature(new _e.InlineValueFeature(this)),this.registerFeature(new He.InlayHintsFeature(this)),this.registerFeature(new m.DiagnosticFeature(this)),this.registerFeature(new y.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(Ne.createAll(this))}fillInitializeParams(T){for(let b of this._features)k.func(b.fillInitializeParams)&&b.fillInitializeParams(T)}computeClientCapabilities(){const T={};(0,u.ensure)(T,"workspace").applyEdit=!0;const b=(0,u.ensure)((0,u.ensure)(T,"workspace"),"workspaceEdit");b.documentChanges=!0,b.resourceOperations=[e.ResourceOperationKind.Create,e.ResourceOperationKind.Rename,e.ResourceOperationKind.Delete],b.failureHandling=e.FailureHandlingKind.TextOnlyTransactional,b.normalizesLineEndings=!0,b.changeAnnotationSupport={groupsOnLabel:!0};const w=(0,u.ensure)((0,u.ensure)(T,"textDocument"),"publishDiagnostics");w.relatedInformation=!0,w.versionSupport=!1,w.tagSupport={valueSet:[e.DiagnosticTag.Unnecessary,e.DiagnosticTag.Deprecated]},w.codeDescriptionSupport=!0,w.dataSupport=!0;const H=(0,u.ensure)(T,"window"),M=(0,u.ensure)(H,"showMessage");M.messageActionItem={additionalPropertiesSupport:!0};const K=(0,u.ensure)(H,"showDocument");K.support=!0;const te=(0,u.ensure)(T,"general");te.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(be.RequestsToCancelOnContentModified)},te.regularExpressions={engine:"ECMAScript",version:"ES2020"},te.markdown={parser:"marked",version:"1.1.0"},te.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(te.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let J of this._features)J.fillClientCapabilities(T);return T}initializeFeatures(T){const b=this._clientOptions.documentSelector;for(const w of this._features)k.func(w.preInitialize)&&w.preInitialize(this._capabilities,b);for(const w of this._features)w.initialize(this._capabilities,b)}async handleRegistrationRequest(T){const b=this.clientOptions.middleware?.handleRegisterCapability;return b?b(T,w=>this.doRegisterCapability(w)):this.doRegisterCapability(T)}async doRegisterCapability(T){if(!this.isRunning()){for(const b of T.registrations)this._ignoredRegistrations.add(b.id);return}for(const b of T.registrations){const w=this._dynamicFeatures.get(b.method);if(w===void 0)return Promise.reject(new Error(`No feature implementation for ${b.method} found. Registration failed.`));const H=b.registerOptions??{};H.documentSelector=H.documentSelector??this._clientOptions.documentSelector;const M={id:b.id,registerOptions:H};try{w.register(M)}catch(K){return Promise.reject(K)}}}async handleUnregistrationRequest(T){const b=this.clientOptions.middleware?.handleUnregisterCapability;return b?b(T,w=>this.doUnregisterCapability(w)):this.doUnregisterCapability(T)}async doUnregisterCapability(T){for(const b of T.unregisterations){if(this._ignoredRegistrations.has(b.id))continue;const w=this._dynamicFeatures.get(b.method);if(!w)return Promise.reject(new Error(`No feature implementation for ${b.method} found. Unregistration failed.`));w.unregister(b.id)}}async handleApplyWorkspaceEdit(T){const b=T.edit,w=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(b)),H=new Map;l.workspace.textDocuments.forEach(K=>H.set(K.uri.toString(),K));let M=!1;if(b.documentChanges){for(const K of b.documentChanges)if(e.TextDocumentEdit.is(K)&&K.textDocument.version&&K.textDocument.version>=0){const te=this._p2c.asUri(K.textDocument.uri).toString(),J=H.get(te);if(J&&J.version!==K.textDocument.version){M=!0;break}}}return M?Promise.resolve({applied:!1}):k.asPromise(l.workspace.applyEdit(w).then(K=>({applied:K})))}handleFailedRequest(T,b,w,H,M=!0){if(w instanceof e.ResponseError){if(w.code===e.ErrorCodes.PendingResponseRejected||w.code===e.ErrorCodes.ConnectionInactive)return H;if(w.code===e.LSPErrorCodes.RequestCancelled||w.code===e.LSPErrorCodes.ServerCancelled){if(b!==void 0&&b.isCancellationRequested)return H;throw w.data!==void 0?new u.LSPCancellationError(w.data):new l.CancellationError}else if(w.code===e.LSPErrorCodes.ContentModified){if(be.RequestsToCancelOnContentModified.has(T.method)||be.CancellableResolveCalls.has(T.method))throw new l.CancellationError;return H}}throw this.error(`Request ${T.method} failed.`,w,M),w}}Ce.BaseLanguageClient=be,be.RequestsToCancelOnContentModified=new Set([e.SemanticTokensRequest.method,e.SemanticTokensRangeRequest.method,e.SemanticTokensDeltaRequest.method]),be.CancellableResolveCalls=new Set([e.CompletionResolveRequest.method,e.CodeLensResolveRequest.method,e.CodeActionResolveRequest.method,e.InlayHintResolveRequest.method,e.DocumentLinkResolveRequest.method,e.WorkspaceSymbolResolveRequest.method]);class Fe{error(T){(0,e.RAL)().console.error(T)}warn(T){(0,e.RAL)().console.warn(T)}info(T){(0,e.RAL)().console.info(T)}log(T){(0,e.RAL)().console.log(T)}}function Qe(B,T,b,w,H){const M=new Fe,K=(0,e.createProtocolConnection)(B,T,M,H);return K.onError(J=>{b(J[0],J[1],J[2])}),K.onClose(w),{listen:()=>K.listen(),sendRequest:K.sendRequest,onRequest:K.onRequest,hasPendingResponse:K.hasPendingResponse,sendNotification:K.sendNotification,onNotification:K.onNotification,onProgress:K.onProgress,sendProgress:K.sendProgress,trace:(J,ve,he)=>{const nt={sendNotification:!1,traceFormat:e.TraceFormat.Text};return he===void 0?K.trace(J,ve,nt):(k.boolean(he),K.trace(J,ve,he))},initialize:J=>K.sendRequest(e.InitializeRequest.type,J),shutdown:()=>K.sendRequest(e.ShutdownRequest.type,void 0),exit:()=>K.sendNotification(e.ExitNotification.type),end:()=>K.end(),dispose:()=>K.dispose()}}var Ne;return function(B){function T(b){return[new xe.InlineCompletionItemFeature(b)]}B.createAll=T}(Ne||(Ce.ProposedFeatures=Ne={})),Ce}var zi;function ji(){return zi||(zi=1,function(l){var e=Je&&Je.__createBinding||(Object.create?function(k,S,s,c){c===void 0&&(c=s);var u=Object.getOwnPropertyDescriptor(S,s);(!u||("get"in u?!S.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return S[s]}}),Object.defineProperty(k,c,u)}:function(k,S,s,c){c===void 0&&(c=s),k[c]=S[s]}),h=Je&&Je.__exportStar||function(k,S){for(var s in k)s!=="default"&&!Object.prototype.hasOwnProperty.call(S,s)&&e(S,k,s)};Object.defineProperty(l,"__esModule",{value:!0}),l.DiagnosticPullMode=l.vsdiag=void 0,h(Z(),l),h(ie(),l);var R=Yi();Object.defineProperty(l,"vsdiag",{enumerable:!0,get:function(){return R.vsdiag}}),Object.defineProperty(l,"DiagnosticPullMode",{enumerable:!0,get:function(){return R.DiagnosticPullMode}}),h(im(),l)}(Je)),Je}var Bi;function hm(){return Bi||(Bi=1,function(l){var e=Xe&&Xe.__createBinding||(Object.create?function(s,c,u,m){m===void 0&&(m=u);var y=Object.getOwnPropertyDescriptor(c,u);(!y||("get"in y?!c.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return c[u]}}),Object.defineProperty(s,m,y)}:function(s,c,u,m){m===void 0&&(m=u),s[m]=c[u]}),h=Xe&&Xe.__exportStar||function(s,c){for(var u in s)u!=="default"&&!Object.prototype.hasOwnProperty.call(c,u)&&e(c,s,u)};Object.defineProperty(l,"__esModule",{value:!0}),l.LanguageClient=void 0;const R=ji(),k=Nn();h(Nn(),l),h(ji(),l);class S extends R.BaseLanguageClient{constructor(c,u,m,y){super(c,u,m),this.worker=y}createMessageTransports(c){const u=new k.BrowserMessageReader(this.worker),m=new k.BrowserMessageWriter(this.worker);return Promise.resolve({reader:u,writer:m})}}l.LanguageClient=S}(Xe)),Xe}export{Ug as U,hm as a,Nn as r};

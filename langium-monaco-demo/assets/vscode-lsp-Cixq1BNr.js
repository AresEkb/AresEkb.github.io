import{r as nn,a as mn,b as Xt,c as rn,m as Cr}from"./langium-5XF2oqgV.js";import{g as qr}from"./react-B5nPjNA6.js";var et={},tt={},xt={},sn={},q={},vn;function Tr(){if(vn)return q;vn=1,Object.defineProperty(q,"__esModule",{value:!0}),q.Message=q.NotificationType9=q.NotificationType8=q.NotificationType7=q.NotificationType6=q.NotificationType5=q.NotificationType4=q.NotificationType3=q.NotificationType2=q.NotificationType1=q.NotificationType0=q.NotificationType=q.RequestType9=q.RequestType8=q.RequestType7=q.RequestType6=q.RequestType5=q.RequestType4=q.RequestType3=q.RequestType2=q.RequestType1=q.RequestType=q.RequestType0=q.AbstractMessageSignature=q.ParameterStructures=q.ResponseError=q.ErrorCodes=void 0;const e=nn();var i;(function(_){_.ParseError=-32700,_.InvalidRequest=-32600,_.MethodNotFound=-32601,_.InvalidParams=-32602,_.InternalError=-32603,_.jsonrpcReservedErrorRangeStart=-32099,_.serverErrorStart=-32099,_.MessageWriteError=-32099,_.MessageReadError=-32098,_.PendingResponseRejected=-32097,_.ConnectionInactive=-32096,_.ServerNotInitialized=-32002,_.UnknownErrorCode=-32001,_.jsonrpcReservedErrorRangeEnd=-32e3,_.serverErrorEnd=-32e3})(i||(q.ErrorCodes=i={}));class d extends Error{constructor(a,T,w){super(T),this.code=e.number(a)?a:i.UnknownErrorCode,this.data=w,Object.setPrototypeOf(this,d.prototype)}toJson(){const a={code:this.code,message:this.message};return this.data!==void 0&&(a.data=this.data),a}}q.ResponseError=d;class s{constructor(a){this.kind=a}static is(a){return a===s.auto||a===s.byName||a===s.byPosition}toString(){return this.kind}}q.ParameterStructures=s,s.auto=new s("auto"),s.byPosition=new s("byPosition"),s.byName=new s("byName");class f{constructor(a,T){this.method=a,this.numberOfParams=T}get parameterStructures(){return s.auto}}q.AbstractMessageSignature=f;class n extends f{constructor(a){super(a,0)}}q.RequestType0=n;class u extends f{constructor(a,T=s.auto){super(a,1),this._parameterStructures=T}get parameterStructures(){return this._parameterStructures}}q.RequestType=u;class o extends f{constructor(a,T=s.auto){super(a,1),this._parameterStructures=T}get parameterStructures(){return this._parameterStructures}}q.RequestType1=o;class r extends f{constructor(a){super(a,2)}}q.RequestType2=r;class l extends f{constructor(a){super(a,3)}}q.RequestType3=l;class m extends f{constructor(a){super(a,4)}}q.RequestType4=m;class p extends f{constructor(a){super(a,5)}}q.RequestType5=p;class y extends f{constructor(a){super(a,6)}}q.RequestType6=y;class v extends f{constructor(a){super(a,7)}}q.RequestType7=v;class P extends f{constructor(a){super(a,8)}}q.RequestType8=P;class B extends f{constructor(a){super(a,9)}}q.RequestType9=B;class I extends f{constructor(a,T=s.auto){super(a,1),this._parameterStructures=T}get parameterStructures(){return this._parameterStructures}}q.NotificationType=I;class C extends f{constructor(a){super(a,0)}}q.NotificationType0=C;class k extends f{constructor(a,T=s.auto){super(a,1),this._parameterStructures=T}get parameterStructures(){return this._parameterStructures}}q.NotificationType1=k;class $ extends f{constructor(a){super(a,2)}}q.NotificationType2=$;class Q extends f{constructor(a){super(a,3)}}q.NotificationType3=Q;class ce extends f{constructor(a){super(a,4)}}q.NotificationType4=ce;class J extends f{constructor(a){super(a,5)}}q.NotificationType5=J;class K extends f{constructor(a){super(a,6)}}q.NotificationType6=K;class se extends f{constructor(a){super(a,7)}}q.NotificationType7=se;class ne extends f{constructor(a){super(a,8)}}q.NotificationType8=ne;class _e extends f{constructor(a){super(a,9)}}q.NotificationType9=_e;var U;return function(_){function a(R){const S=R;return S&&e.string(S.method)&&(e.string(S.id)||e.number(S.id))}_.isRequest=a;function T(R){const S=R;return S&&e.string(S.method)&&R.id===void 0}_.isNotification=T;function w(R){const S=R;return S&&(S.result!==void 0||!!S.error)&&(e.string(S.id)||e.number(S.id)||S.id===null)}_.isResponse=w}(U||(q.Message=U={})),q}var Ee={},bn;function _r(){if(bn)return Ee;bn=1;var e;Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.LRUCache=Ee.LinkedMap=Ee.Touch=void 0;var i;(function(f){f.None=0,f.First=1,f.AsOld=f.First,f.Last=2,f.AsNew=f.Last})(i||(Ee.Touch=i={}));class d{constructor(){this[e]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(n){return this._map.has(n)}get(n,u=i.None){const o=this._map.get(n);if(o)return u!==i.None&&this.touch(o,u),o.value}set(n,u,o=i.None){let r=this._map.get(n);if(r)r.value=u,o!==i.None&&this.touch(r,o);else{switch(r={key:n,value:u,next:void 0,previous:void 0},o){case i.None:this.addItemLast(r);break;case i.First:this.addItemFirst(r);break;case i.Last:this.addItemLast(r);break;default:this.addItemLast(r);break}this._map.set(n,r),this._size++}return this}delete(n){return!!this.remove(n)}remove(n){const u=this._map.get(n);if(u)return this._map.delete(n),this.removeItem(u),this._size--,u.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const n=this._head;return this._map.delete(n.key),this.removeItem(n),this._size--,n.value}forEach(n,u){const o=this._state;let r=this._head;for(;r;){if(u?n.bind(u)(r.value,r.key,this):n(r.value,r.key,this),this._state!==o)throw new Error("LinkedMap got modified during iteration.");r=r.next}}keys(){const n=this._state;let u=this._head;const o={[Symbol.iterator]:()=>o,next:()=>{if(this._state!==n)throw new Error("LinkedMap got modified during iteration.");if(u){const r={value:u.key,done:!1};return u=u.next,r}else return{value:void 0,done:!0}}};return o}values(){const n=this._state;let u=this._head;const o={[Symbol.iterator]:()=>o,next:()=>{if(this._state!==n)throw new Error("LinkedMap got modified during iteration.");if(u){const r={value:u.value,done:!1};return u=u.next,r}else return{value:void 0,done:!0}}};return o}entries(){const n=this._state;let u=this._head;const o={[Symbol.iterator]:()=>o,next:()=>{if(this._state!==n)throw new Error("LinkedMap got modified during iteration.");if(u){const r={value:[u.key,u.value],done:!1};return u=u.next,r}else return{value:void 0,done:!0}}};return o}[(e=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(n){if(n>=this.size)return;if(n===0){this.clear();return}let u=this._head,o=this.size;for(;u&&o>n;)this._map.delete(u.key),u=u.next,o--;this._head=u,this._size=o,u&&(u.previous=void 0),this._state++}addItemFirst(n){if(!this._head&&!this._tail)this._tail=n;else if(this._head)n.next=this._head,this._head.previous=n;else throw new Error("Invalid list");this._head=n,this._state++}addItemLast(n){if(!this._head&&!this._tail)this._head=n;else if(this._tail)n.previous=this._tail,this._tail.next=n;else throw new Error("Invalid list");this._tail=n,this._state++}removeItem(n){if(n===this._head&&n===this._tail)this._head=void 0,this._tail=void 0;else if(n===this._head){if(!n.next)throw new Error("Invalid list");n.next.previous=void 0,this._head=n.next}else if(n===this._tail){if(!n.previous)throw new Error("Invalid list");n.previous.next=void 0,this._tail=n.previous}else{const u=n.next,o=n.previous;if(!u||!o)throw new Error("Invalid list");u.previous=o,o.next=u}n.next=void 0,n.previous=void 0,this._state++}touch(n,u){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(u!==i.First&&u!==i.Last)){if(u===i.First){if(n===this._head)return;const o=n.next,r=n.previous;n===this._tail?(r.next=void 0,this._tail=r):(o.previous=r,r.next=o),n.previous=void 0,n.next=this._head,this._head.previous=n,this._head=n,this._state++}else if(u===i.Last){if(n===this._tail)return;const o=n.next,r=n.previous;n===this._head?(o.previous=void 0,this._head=o):(o.previous=r,r.next=o),n.next=void 0,n.previous=this._tail,this._tail.next=n,this._tail=n,this._state++}}}toJSON(){const n=[];return this.forEach((u,o)=>{n.push([o,u])}),n}fromJSON(n){this.clear();for(const[u,o]of n)this.set(u,o)}}Ee.LinkedMap=d;class s extends d{constructor(n,u=1){super(),this._limit=n,this._ratio=Math.min(Math.max(0,u),1)}get limit(){return this._limit}set limit(n){this._limit=n,this.checkTrim()}get ratio(){return this._ratio}set ratio(n){this._ratio=Math.min(Math.max(0,n),1),this.checkTrim()}get(n,u=i.AsNew){return super.get(n,u)}peek(n){return super.get(n,i.None)}set(n,u){return super.set(n,u,i.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}return Ee.LRUCache=s,Ee}var Lt={},Rn;function Nr(){if(Rn)return Lt;Rn=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.Disposable=void 0;var e;return function(i){function d(s){return{dispose:s}}i.create=d}(e||(Lt.Disposable=e={})),Lt}var nt={},Tn;function Er(){if(Tn)return nt;Tn=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.SharedArrayReceiverStrategy=nt.SharedArraySenderStrategy=void 0;const e=mn();var i;(function(u){u.Continue=0,u.Cancelled=1})(i||(i={}));class d{constructor(){this.buffers=new Map}enableCancellation(o){if(o.id===null)return;const r=new SharedArrayBuffer(4),l=new Int32Array(r,0,1);l[0]=i.Continue,this.buffers.set(o.id,r),o.$cancellationData=r}async sendCancellation(o,r){const l=this.buffers.get(r);if(l===void 0)return;const m=new Int32Array(l,0,1);Atomics.store(m,0,i.Cancelled)}cleanup(o){this.buffers.delete(o)}dispose(){this.buffers.clear()}}nt.SharedArraySenderStrategy=d;class s{constructor(o){this.data=new Int32Array(o,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===i.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class f{constructor(o){this.token=new s(o)}cancel(){}dispose(){}}class n{constructor(){this.kind="request"}createCancellationTokenSource(o){const r=o.$cancellationData;return r===void 0?new e.CancellationTokenSource:new f(r)}}return nt.SharedArrayReceiverStrategy=n,nt}var Oe={},$t={},_n;function Pr(){if(_n)return $t;_n=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.Semaphore=void 0;const e=Xt();class i{constructor(s=1){if(s<=0)throw new Error("Capacity must be greater than 0");this._capacity=s,this._active=0,this._waiting=[]}lock(s){return new Promise((f,n)=>{this._waiting.push({thunk:s,resolve:f,reject:n}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,e.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const s=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const f=s.thunk();f instanceof Promise?f.then(n=>{this._active--,s.resolve(n),this.runNext()},n=>{this._active--,s.reject(n),this.runNext()}):(this._active--,s.resolve(f),this.runNext())}catch(f){this._active--,s.reject(f),this.runNext()}}}return $t.Semaphore=i,$t}var Pn;function Or(){if(Pn)return Oe;Pn=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.ReadableStreamMessageReader=Oe.AbstractMessageReader=Oe.MessageReader=void 0;const e=Xt(),i=nn(),d=rn(),s=Pr();var f;(function(r){function l(m){let p=m;return p&&i.func(p.listen)&&i.func(p.dispose)&&i.func(p.onError)&&i.func(p.onClose)&&i.func(p.onPartialMessage)}r.is=l})(f||(Oe.MessageReader=f={}));class n{constructor(){this.errorEmitter=new d.Emitter,this.closeEmitter=new d.Emitter,this.partialMessageEmitter=new d.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(l){this.errorEmitter.fire(this.asError(l))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(l){this.partialMessageEmitter.fire(l)}asError(l){return l instanceof Error?l:new Error(`Reader received error. Reason: ${i.string(l.message)?l.message:"unknown"}`)}}Oe.AbstractMessageReader=n;var u;(function(r){function l(m){let p,y;const v=new Map;let P;const B=new Map;if(m===void 0||typeof m=="string")p=m??"utf-8";else{if(p=m.charset??"utf-8",m.contentDecoder!==void 0&&(y=m.contentDecoder,v.set(y.name,y)),m.contentDecoders!==void 0)for(const I of m.contentDecoders)v.set(I.name,I);if(m.contentTypeDecoder!==void 0&&(P=m.contentTypeDecoder,B.set(P.name,P)),m.contentTypeDecoders!==void 0)for(const I of m.contentTypeDecoders)B.set(I.name,I)}return P===void 0&&(P=(0,e.default)().applicationJson.decoder,B.set(P.name,P)),{charset:p,contentDecoder:y,contentDecoders:v,contentTypeDecoder:P,contentTypeDecoders:B}}r.fromOptions=l})(u||(u={}));class o extends n{constructor(l,m){super(),this.readable=l,this.options=u.fromOptions(m),this.buffer=(0,e.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new s.Semaphore(1)}set partialMessageTimeout(l){this._partialMessageTimeout=l}get partialMessageTimeout(){return this._partialMessageTimeout}listen(l){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=l;const m=this.readable.onData(p=>{this.onData(p)});return this.readable.onError(p=>this.fireError(p)),this.readable.onClose(()=>this.fireClose()),m}onData(l){try{for(this.buffer.append(l);;){if(this.nextMessageLength===-1){const p=this.buffer.tryReadHeaders(!0);if(!p)return;const y=p.get("content-length");if(!y){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(p))}`));return}const v=parseInt(y);if(isNaN(v)){this.fireError(new Error(`Content-Length value must be a number. Got ${y}`));return}this.nextMessageLength=v}const m=this.buffer.tryReadBody(this.nextMessageLength);if(m===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const p=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(m):m,y=await this.options.contentTypeDecoder.decode(p,this.options);this.callback(y)}).catch(p=>{this.fireError(p)})}}catch(m){this.fireError(m)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,e.default)().timer.setTimeout((l,m)=>{this.partialMessageTimer=void 0,l===this.messageToken&&(this.firePartialMessage({messageToken:l,waitingTime:m}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}return Oe.ReadableStreamMessageReader=o,Oe}var je={},wn;function jr(){if(wn)return je;wn=1,Object.defineProperty(je,"__esModule",{value:!0}),je.WriteableStreamMessageWriter=je.AbstractMessageWriter=je.MessageWriter=void 0;const e=Xt(),i=nn(),d=Pr(),s=rn(),f="Content-Length: ",n=`\r
`;var u;(function(m){function p(y){let v=y;return v&&i.func(v.dispose)&&i.func(v.onClose)&&i.func(v.onError)&&i.func(v.write)}m.is=p})(u||(je.MessageWriter=u={}));class o{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(p,y,v){this.errorEmitter.fire([this.asError(p),y,v])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(p){return p instanceof Error?p:new Error(`Writer received error. Reason: ${i.string(p.message)?p.message:"unknown"}`)}}je.AbstractMessageWriter=o;var r;(function(m){function p(y){return y===void 0||typeof y=="string"?{charset:y??"utf-8",contentTypeEncoder:(0,e.default)().applicationJson.encoder}:{charset:y.charset??"utf-8",contentEncoder:y.contentEncoder,contentTypeEncoder:y.contentTypeEncoder??(0,e.default)().applicationJson.encoder}}m.fromOptions=p})(r||(r={}));class l extends o{constructor(p,y){super(),this.writable=p,this.options=r.fromOptions(y),this.errorCount=0,this.writeSemaphore=new d.Semaphore(1),this.writable.onError(v=>this.fireError(v)),this.writable.onClose(()=>this.fireClose())}async write(p){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(p,this.options).then(v=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(v):v).then(v=>{const P=[];return P.push(f,v.byteLength.toString(),n),P.push(n),this.doWrite(p,P,v)},v=>{throw this.fireError(v),v}))}async doWrite(p,y,v){try{return await this.writable.write(y.join(""),"ascii"),this.writable.write(v)}catch(P){return this.handleError(P,p),Promise.reject(P)}}handleError(p,y){this.errorCount++,this.fireError(p,y,this.errorCount)}end(){this.writable.end()}}return je.WriteableStreamMessageWriter=l,je}var At={},Sn;function Lr(){if(Sn)return At;Sn=1,Object.defineProperty(At,"__esModule",{value:!0}),At.AbstractMessageBuffer=void 0;const e=13,i=10,d=`\r
`;class s{constructor(n="utf-8"){this._encoding=n,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(n){const u=typeof n=="string"?this.fromString(n,this._encoding):n;this._chunks.push(u),this._totalLength+=u.byteLength}tryReadHeaders(n=!1){if(this._chunks.length===0)return;let u=0,o=0,r=0,l=0;e:for(;o<this._chunks.length;){const v=this._chunks[o];for(r=0;r<v.length;){switch(v[r]){case e:switch(u){case 0:u=1;break;case 2:u=3;break;default:u=0}break;case i:switch(u){case 1:u=2;break;case 3:u=4,r++;break e;default:u=0}break;default:u=0}r++}l+=v.byteLength,o++}if(u!==4)return;const m=this._read(l+r),p=new Map,y=this.toString(m,"ascii").split(d);if(y.length<2)return p;for(let v=0;v<y.length-2;v++){const P=y[v],B=P.indexOf(":");if(B===-1)throw new Error(`Message header must separate key and value using ':'
${P}`);const I=P.substr(0,B),C=P.substr(B+1).trim();p.set(n?I.toLowerCase():I,C)}return p}tryReadBody(n){if(!(this._totalLength<n))return this._read(n)}get numberOfBytes(){return this._totalLength}_read(n){if(n===0)return this.emptyBuffer();if(n>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===n){const l=this._chunks[0];return this._chunks.shift(),this._totalLength-=n,this.asNative(l)}if(this._chunks[0].byteLength>n){const l=this._chunks[0],m=this.asNative(l,n);return this._chunks[0]=l.slice(n),this._totalLength-=n,m}const u=this.allocNative(n);let o=0,r=0;for(;n>0;){const l=this._chunks[r];if(l.byteLength>n){const m=l.slice(0,n);u.set(m,o),o+=n,this._chunks[r]=l.slice(n),this._totalLength-=n,n-=n}else u.set(l,o),o+=l.byteLength,this._chunks.shift(),this._totalLength-=l.byteLength,n-=l.byteLength}return u}}return At.AbstractMessageBuffer=s,At}var an={},Dn;function $r(){return Dn||(Dn=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.ConnectionOptions=e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.RequestCancellationReceiverStrategy=e.IdCancellationReceiverStrategy=e.ConnectionStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=e.NullLogger=e.ProgressType=e.ProgressToken=void 0;const i=Xt(),d=nn(),s=Tr(),f=_r(),n=rn(),u=mn();var o;(function(a){a.type=new s.NotificationType("$/cancelRequest")})(o||(o={}));var r;(function(a){function T(w){return typeof w=="string"||typeof w=="number"}a.is=T})(r||(e.ProgressToken=r={}));var l;(function(a){a.type=new s.NotificationType("$/progress")})(l||(l={}));class m{constructor(){}}e.ProgressType=m;var p;(function(a){function T(w){return d.func(w)}a.is=T})(p||(p={})),e.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var y;(function(a){a[a.Off=0]="Off",a[a.Messages=1]="Messages",a[a.Compact=2]="Compact",a[a.Verbose=3]="Verbose"})(y||(e.Trace=y={}));var v;(function(a){a.Off="off",a.Messages="messages",a.Compact="compact",a.Verbose="verbose"})(v||(e.TraceValues=v={})),function(a){function T(R){if(!d.string(R))return a.Off;switch(R=R.toLowerCase(),R){case"off":return a.Off;case"messages":return a.Messages;case"compact":return a.Compact;case"verbose":return a.Verbose;default:return a.Off}}a.fromString=T;function w(R){switch(R){case a.Off:return"off";case a.Messages:return"messages";case a.Compact:return"compact";case a.Verbose:return"verbose";default:return"off"}}a.toString=w}(y||(e.Trace=y={}));var P;(function(a){a.Text="text",a.JSON="json"})(P||(e.TraceFormat=P={})),function(a){function T(w){return d.string(w)?(w=w.toLowerCase(),w==="json"?a.JSON:a.Text):a.Text}a.fromString=T}(P||(e.TraceFormat=P={}));var B;(function(a){a.type=new s.NotificationType("$/setTrace")})(B||(e.SetTraceNotification=B={}));var I;(function(a){a.type=new s.NotificationType("$/logTrace")})(I||(e.LogTraceNotification=I={}));var C;(function(a){a[a.Closed=1]="Closed",a[a.Disposed=2]="Disposed",a[a.AlreadyListening=3]="AlreadyListening"})(C||(e.ConnectionErrors=C={}));class k extends Error{constructor(T,w){super(w),this.code=T,Object.setPrototypeOf(this,k.prototype)}}e.ConnectionError=k;var $;(function(a){function T(w){const R=w;return R&&d.func(R.cancelUndispatched)}a.is=T})($||(e.ConnectionStrategy=$={}));var Q;(function(a){function T(w){const R=w;return R&&(R.kind===void 0||R.kind==="id")&&d.func(R.createCancellationTokenSource)&&(R.dispose===void 0||d.func(R.dispose))}a.is=T})(Q||(e.IdCancellationReceiverStrategy=Q={}));var ce;(function(a){function T(w){const R=w;return R&&R.kind==="request"&&d.func(R.createCancellationTokenSource)&&(R.dispose===void 0||d.func(R.dispose))}a.is=T})(ce||(e.RequestCancellationReceiverStrategy=ce={}));var J;(function(a){a.Message=Object.freeze({createCancellationTokenSource(w){return new u.CancellationTokenSource}});function T(w){return Q.is(w)||ce.is(w)}a.is=T})(J||(e.CancellationReceiverStrategy=J={}));var K;(function(a){a.Message=Object.freeze({sendCancellation(w,R){return w.sendNotification(o.type,{id:R})},cleanup(w){}});function T(w){const R=w;return R&&d.func(R.sendCancellation)&&d.func(R.cleanup)}a.is=T})(K||(e.CancellationSenderStrategy=K={}));var se;(function(a){a.Message=Object.freeze({receiver:J.Message,sender:K.Message});function T(w){const R=w;return R&&J.is(R.receiver)&&K.is(R.sender)}a.is=T})(se||(e.CancellationStrategy=se={}));var ne;(function(a){function T(w){const R=w;return R&&d.func(R.handleMessage)}a.is=T})(ne||(e.MessageStrategy=ne={}));var _e;(function(a){function T(w){const R=w;return R&&(se.is(R.cancellationStrategy)||$.is(R.connectionStrategy)||ne.is(R.messageStrategy))}a.is=T})(_e||(e.ConnectionOptions=_e={}));var U;(function(a){a[a.New=1]="New",a[a.Listening=2]="Listening",a[a.Closed=3]="Closed",a[a.Disposed=4]="Disposed"})(U||(U={}));function _(a,T,w,R){const S=w!==void 0?w:e.NullLogger;let ht=0,mt=0,gt=0;const pe="2.0";let ve;const we=new Map;let be;const Se=new Map,De=new Map;let Ce,ue=new f.LinkedMap,ae=new Map,ke=new Set,x=new Map,O=y.Off,le=P.Text,H,re=U.New;const qe=new n.Emitter,ze=new n.Emitter,Ue=new n.Emitter,Ve=new n.Emitter,Je=new n.Emitter,ie=R&&R.cancellationStrategy?R.cancellationStrategy:se.Message;function Ke(t){if(t===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+t.toString()}function yt(t){return t===null?"res-unknown-"+(++gt).toString():"res-"+t.toString()}function pt(){return"not-"+(++mt).toString()}function vt(t,h){s.Message.isRequest(h)?t.set(Ke(h.id),h):s.Message.isResponse(h)?t.set(yt(h.id),h):t.set(pt(),h)}function bt(t){}function Qe(){return re===U.Listening}function Ge(){return re===U.Closed}function he(){return re===U.Disposed}function Xe(){(re===U.New||re===U.Listening)&&(re=U.Closed,ze.fire(void 0))}function Rt(t){qe.fire([t,void 0,void 0])}function Tt(t){qe.fire(t)}a.onClose(Xe),a.onError(Rt),T.onClose(Xe),T.onError(Tt);function Ye(){Ce||ue.size===0||(Ce=(0,i.default)().timer.setImmediate(()=>{Ce=void 0,_t()}))}function Ze(t){s.Message.isRequest(t)?wt(t):s.Message.isNotification(t)?Dt(t):s.Message.isResponse(t)?St(t):kt(t)}function _t(){if(ue.size===0)return;const t=ue.shift();try{const h=R?.messageStrategy;ne.is(h)?h.handleMessage(t,Ze):Ze(t)}finally{Ye()}}const Pt=t=>{try{if(s.Message.isNotification(t)&&t.method===o.type.method){const h=t.params.id,g=Ke(h),b=ue.get(g);if(s.Message.isRequest(b)){const E=R?.connectionStrategy,F=E&&E.cancelUndispatched?E.cancelUndispatched(b,bt):void 0;if(F&&(F.error!==void 0||F.result!==void 0)){ue.delete(g),x.delete(h),F.id=b.id,Me(F,t.method,Date.now()),T.write(F).catch(()=>S.error("Sending response for canceled message failed."));return}}const L=x.get(h);if(L!==void 0){L.cancel(),Ne(t);return}else ke.add(h)}vt(ue,t)}finally{Ye()}};function wt(t){if(he())return;function h(D,A,M){const z={jsonrpc:pe,id:t.id};D instanceof s.ResponseError?z.error=D.toJson():z.result=D===void 0?null:D,Me(z,A,M),T.write(z).catch(()=>S.error("Sending response failed."))}function g(D,A,M){const z={jsonrpc:pe,id:t.id,error:D.toJson()};Me(z,A,M),T.write(z).catch(()=>S.error("Sending response failed."))}function b(D,A,M){D===void 0&&(D=null);const z={jsonrpc:pe,id:t.id,result:D};Me(z,A,M),T.write(z).catch(()=>S.error("Sending response failed."))}qt(t);const L=we.get(t.method);let E,F;L&&(E=L.type,F=L.handler);const W=Date.now();if(F||ve){const D=t.id??String(Date.now()),A=Q.is(ie.receiver)?ie.receiver.createCancellationTokenSource(D):ie.receiver.createCancellationTokenSource(t);t.id!==null&&ke.has(t.id)&&A.cancel(),t.id!==null&&x.set(D,A);try{let M;if(F)if(t.params===void 0){if(E!==void 0&&E.numberOfParams!==0){g(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${t.method} defines ${E.numberOfParams} params but received none.`),t.method,W);return}M=F(A.token)}else if(Array.isArray(t.params)){if(E!==void 0&&E.parameterStructures===s.ParameterStructures.byName){g(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${t.method} defines parameters by name but received parameters by position`),t.method,W);return}M=F(...t.params,A.token)}else{if(E!==void 0&&E.parameterStructures===s.ParameterStructures.byPosition){g(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${t.method} defines parameters by position but received parameters by name`),t.method,W);return}M=F(t.params,A.token)}else ve&&(M=ve(t.method,t.params,A.token));const z=M;M?z.then?z.then(V=>{x.delete(D),h(V,t.method,W)},V=>{x.delete(D),V instanceof s.ResponseError?g(V,t.method,W):V&&d.string(V.message)?g(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${t.method} failed with message: ${V.message}`),t.method,W):g(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${t.method} failed unexpectedly without providing any details.`),t.method,W)}):(x.delete(D),h(M,t.method,W)):(x.delete(D),b(M,t.method,W))}catch(M){x.delete(D),M instanceof s.ResponseError?h(M,t.method,W):M&&d.string(M.message)?g(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${t.method} failed with message: ${M.message}`),t.method,W):g(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${t.method} failed unexpectedly without providing any details.`),t.method,W)}}else g(new s.ResponseError(s.ErrorCodes.MethodNotFound,`Unhandled method ${t.method}`),t.method,W)}function St(t){if(!he())if(t.id===null)t.error?S.error(`Received response message without id: Error is: 
${JSON.stringify(t.error,void 0,4)}`):S.error("Received response message without id. No further error information provided.");else{const h=t.id,g=ae.get(h);if(Nt(t,g),g!==void 0){ae.delete(h);try{if(t.error){const b=t.error;g.reject(new s.ResponseError(b.code,b.message,b.data))}else if(t.result!==void 0)g.resolve(t.result);else throw new Error("Should never happen.")}catch(b){b.message?S.error(`Response handler '${g.method}' failed with message: ${b.message}`):S.error(`Response handler '${g.method}' failed unexpectedly.`)}}}}function Dt(t){if(he())return;let h,g;if(t.method===o.type.method){const b=t.params.id;ke.delete(b),Ne(t);return}else{const b=Se.get(t.method);b&&(g=b.handler,h=b.type)}if(g||be)try{if(Ne(t),g)if(t.params===void 0)h!==void 0&&h.numberOfParams!==0&&h.parameterStructures!==s.ParameterStructures.byName&&S.error(`Notification ${t.method} defines ${h.numberOfParams} params but received none.`),g();else if(Array.isArray(t.params)){const b=t.params;t.method===l.type.method&&b.length===2&&r.is(b[0])?g({token:b[0],value:b[1]}):(h!==void 0&&(h.parameterStructures===s.ParameterStructures.byName&&S.error(`Notification ${t.method} defines parameters by name but received parameters by position`),h.numberOfParams!==t.params.length&&S.error(`Notification ${t.method} defines ${h.numberOfParams} params but received ${b.length} arguments`)),g(...b))}else h!==void 0&&h.parameterStructures===s.ParameterStructures.byPosition&&S.error(`Notification ${t.method} defines parameters by position but received parameters by name`),g(t.params);else be&&be(t.method,t.params)}catch(b){b.message?S.error(`Notification handler '${t.method}' failed with message: ${b.message}`):S.error(`Notification handler '${t.method}' failed unexpectedly.`)}else Ue.fire(t)}function kt(t){if(!t){S.error("Received empty message.");return}S.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(t,null,4)}`);const h=t;if(d.string(h.id)||d.number(h.id)){const g=h.id,b=ae.get(g);b&&b.reject(new Error("The received response has neither a result nor an error property."))}}function oe(t){if(t!=null)switch(O){case y.Verbose:return JSON.stringify(t,null,4);case y.Compact:return JSON.stringify(t);default:return}}function Mt(t){if(!(O===y.Off||!H))if(le===P.Text){let h;(O===y.Verbose||O===y.Compact)&&t.params&&(h=`Params: ${oe(t.params)}

`),H.log(`Sending request '${t.method} - (${t.id})'.`,h)}else me("send-request",t)}function Ct(t){if(!(O===y.Off||!H))if(le===P.Text){let h;(O===y.Verbose||O===y.Compact)&&(t.params?h=`Params: ${oe(t.params)}

`:h=`No parameters provided.

`),H.log(`Sending notification '${t.method}'.`,h)}else me("send-notification",t)}function Me(t,h,g){if(!(O===y.Off||!H))if(le===P.Text){let b;(O===y.Verbose||O===y.Compact)&&(t.error&&t.error.data?b=`Error data: ${oe(t.error.data)}

`:t.result?b=`Result: ${oe(t.result)}

`:t.error===void 0&&(b=`No result returned.

`)),H.log(`Sending response '${h} - (${t.id})'. Processing request took ${Date.now()-g}ms`,b)}else me("send-response",t)}function qt(t){if(!(O===y.Off||!H))if(le===P.Text){let h;(O===y.Verbose||O===y.Compact)&&t.params&&(h=`Params: ${oe(t.params)}

`),H.log(`Received request '${t.method} - (${t.id})'.`,h)}else me("receive-request",t)}function Ne(t){if(!(O===y.Off||!H||t.method===I.type.method))if(le===P.Text){let h;(O===y.Verbose||O===y.Compact)&&(t.params?h=`Params: ${oe(t.params)}

`:h=`No parameters provided.

`),H.log(`Received notification '${t.method}'.`,h)}else me("receive-notification",t)}function Nt(t,h){if(!(O===y.Off||!H))if(le===P.Text){let g;if((O===y.Verbose||O===y.Compact)&&(t.error&&t.error.data?g=`Error data: ${oe(t.error.data)}

`:t.result?g=`Result: ${oe(t.result)}

`:t.error===void 0&&(g=`No result returned.

`)),h){const b=t.error?` Request failed: ${t.error.message} (${t.error.code}).`:"";H.log(`Received response '${h.method} - (${t.id})' in ${Date.now()-h.timerStart}ms.${b}`,g)}else H.log(`Received response ${t.id} without active response promise.`,g)}else me("receive-response",t)}function me(t,h){if(!H||O===y.Off)return;const g={isLSPMessage:!0,type:t,message:h,timestamp:Date.now()};H.log(g)}function Re(){if(Ge())throw new k(C.Closed,"Connection is closed.");if(he())throw new k(C.Disposed,"Connection is disposed.")}function Et(){if(Qe())throw new k(C.AlreadyListening,"Connection is already listening")}function Ot(){if(!Qe())throw new Error("Call listen() first.")}function Te(t){return t===void 0?null:t}function xe(t){if(t!==null)return t}function c(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function G(t,h){switch(t){case s.ParameterStructures.auto:return c(h)?xe(h):[Te(h)];case s.ParameterStructures.byName:if(!c(h))throw new Error("Received parameters by name but param is not an object literal.");return xe(h);case s.ParameterStructures.byPosition:return[Te(h)];default:throw new Error(`Unknown parameter structure ${t.toString()}`)}}function X(t,h){let g;const b=t.numberOfParams;switch(b){case 0:g=void 0;break;case 1:g=G(t.parameterStructures,h[0]);break;default:g=[];for(let L=0;L<h.length&&L<b;L++)g.push(Te(h[L]));if(h.length<b)for(let L=h.length;L<b;L++)g.push(null);break}return g}const j={sendNotification:(t,...h)=>{Re();let g,b;if(d.string(t)){g=t;const E=h[0];let F=0,W=s.ParameterStructures.auto;s.ParameterStructures.is(E)&&(F=1,W=E);let D=h.length;const A=D-F;switch(A){case 0:b=void 0;break;case 1:b=G(W,h[F]);break;default:if(W===s.ParameterStructures.byName)throw new Error(`Received ${A} parameters for 'by Name' notification parameter structure.`);b=h.slice(F,D).map(M=>Te(M));break}}else{const E=h;g=t.method,b=X(t,E)}const L={jsonrpc:pe,method:g,params:b};return Ct(L),T.write(L).catch(E=>{throw S.error("Sending notification failed."),E})},onNotification:(t,h)=>{Re();let g;return d.func(t)?be=t:h&&(d.string(t)?(g=t,Se.set(t,{type:void 0,handler:h})):(g=t.method,Se.set(t.method,{type:t,handler:h}))),{dispose:()=>{g!==void 0?Se.delete(g):be=void 0}}},onProgress:(t,h,g)=>{if(De.has(h))throw new Error(`Progress handler for token ${h} already registered`);return De.set(h,g),{dispose:()=>{De.delete(h)}}},sendProgress:(t,h,g)=>j.sendNotification(l.type,{token:h,value:g}),onUnhandledProgress:Ve.event,sendRequest:(t,...h)=>{Re(),Ot();let g,b,L;if(d.string(t)){g=t;const D=h[0],A=h[h.length-1];let M=0,z=s.ParameterStructures.auto;s.ParameterStructures.is(D)&&(M=1,z=D);let V=h.length;u.CancellationToken.is(A)&&(V=V-1,L=A);const ee=V-M;switch(ee){case 0:b=void 0;break;case 1:b=G(z,h[M]);break;default:if(z===s.ParameterStructures.byName)throw new Error(`Received ${ee} parameters for 'by Name' request parameter structure.`);b=h.slice(M,V).map(on=>Te(on));break}}else{const D=h;g=t.method,b=X(t,D);const A=t.numberOfParams;L=u.CancellationToken.is(D[A])?D[A]:void 0}const E=ht++;let F;L&&(F=L.onCancellationRequested(()=>{const D=ie.sender.sendCancellation(j,E);return D===void 0?(S.log(`Received no promise from cancellation strategy when cancelling id ${E}`),Promise.resolve()):D.catch(()=>{S.log(`Sending cancellation messages for id ${E} failed`)})}));const W={jsonrpc:pe,id:E,method:g,params:b};return Mt(W),typeof ie.sender.enableCancellation=="function"&&ie.sender.enableCancellation(W),new Promise(async(D,A)=>{const M=ee=>{D(ee),ie.sender.cleanup(E),F?.dispose()},z=ee=>{A(ee),ie.sender.cleanup(E),F?.dispose()},V={method:g,timerStart:Date.now(),resolve:M,reject:z};try{await T.write(W),ae.set(E,V)}catch(ee){throw S.error("Sending request failed."),V.reject(new s.ResponseError(s.ErrorCodes.MessageWriteError,ee.message?ee.message:"Unknown reason")),ee}})},onRequest:(t,h)=>{Re();let g=null;return p.is(t)?(g=void 0,ve=t):d.string(t)?(g=null,h!==void 0&&(g=t,we.set(t,{handler:h,type:void 0}))):h!==void 0&&(g=t.method,we.set(t.method,{type:t,handler:h})),{dispose:()=>{g!==null&&(g!==void 0?we.delete(g):ve=void 0)}}},hasPendingResponse:()=>ae.size>0,trace:async(t,h,g)=>{let b=!1,L=P.Text;g!==void 0&&(d.boolean(g)?b=g:(b=g.sendNotification||!1,L=g.traceFormat||P.Text)),O=t,le=L,O===y.Off?H=void 0:H=h,b&&!Ge()&&!he()&&await j.sendNotification(B.type,{value:y.toString(t)})},onError:qe.event,onClose:ze.event,onUnhandledNotification:Ue.event,onDispose:Je.event,end:()=>{T.end()},dispose:()=>{if(he())return;re=U.Disposed,Je.fire(void 0);const t=new s.ResponseError(s.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const h of ae.values())h.reject(t);ae=new Map,x=new Map,ke=new Set,ue=new f.LinkedMap,d.func(T.dispose)&&T.dispose(),d.func(a.dispose)&&a.dispose()},listen:()=>{Re(),Et(),re=U.Listening,a.listen(Pt)},inspect:()=>{(0,i.default)().console.log("inspect")}};return j.onNotification(I.type,t=>{if(O===y.Off||!H)return;const h=O===y.Verbose||O===y.Compact;H.log(t.message,h?t.verbose:void 0)}),j.onNotification(l.type,t=>{const h=De.get(t.token);h?h(t.value):Ve.fire(t)}),j}e.createMessageConnection=_}(an)),an}var kn;function fn(){return kn||(kn=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProgressType=e.ProgressToken=e.createMessageConnection=e.NullLogger=e.ConnectionOptions=e.ConnectionStrategy=e.AbstractMessageBuffer=e.WriteableStreamMessageWriter=e.AbstractMessageWriter=e.MessageWriter=e.ReadableStreamMessageReader=e.AbstractMessageReader=e.MessageReader=e.SharedArrayReceiverStrategy=e.SharedArraySenderStrategy=e.CancellationToken=e.CancellationTokenSource=e.Emitter=e.Event=e.Disposable=e.LRUCache=e.Touch=e.LinkedMap=e.ParameterStructures=e.NotificationType9=e.NotificationType8=e.NotificationType7=e.NotificationType6=e.NotificationType5=e.NotificationType4=e.NotificationType3=e.NotificationType2=e.NotificationType1=e.NotificationType0=e.NotificationType=e.ErrorCodes=e.ResponseError=e.RequestType9=e.RequestType8=e.RequestType7=e.RequestType6=e.RequestType5=e.RequestType4=e.RequestType3=e.RequestType2=e.RequestType1=e.RequestType0=e.RequestType=e.Message=e.RAL=void 0,e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=void 0;const i=Tr();Object.defineProperty(e,"Message",{enumerable:!0,get:function(){return i.Message}}),Object.defineProperty(e,"RequestType",{enumerable:!0,get:function(){return i.RequestType}}),Object.defineProperty(e,"RequestType0",{enumerable:!0,get:function(){return i.RequestType0}}),Object.defineProperty(e,"RequestType1",{enumerable:!0,get:function(){return i.RequestType1}}),Object.defineProperty(e,"RequestType2",{enumerable:!0,get:function(){return i.RequestType2}}),Object.defineProperty(e,"RequestType3",{enumerable:!0,get:function(){return i.RequestType3}}),Object.defineProperty(e,"RequestType4",{enumerable:!0,get:function(){return i.RequestType4}}),Object.defineProperty(e,"RequestType5",{enumerable:!0,get:function(){return i.RequestType5}}),Object.defineProperty(e,"RequestType6",{enumerable:!0,get:function(){return i.RequestType6}}),Object.defineProperty(e,"RequestType7",{enumerable:!0,get:function(){return i.RequestType7}}),Object.defineProperty(e,"RequestType8",{enumerable:!0,get:function(){return i.RequestType8}}),Object.defineProperty(e,"RequestType9",{enumerable:!0,get:function(){return i.RequestType9}}),Object.defineProperty(e,"ResponseError",{enumerable:!0,get:function(){return i.ResponseError}}),Object.defineProperty(e,"ErrorCodes",{enumerable:!0,get:function(){return i.ErrorCodes}}),Object.defineProperty(e,"NotificationType",{enumerable:!0,get:function(){return i.NotificationType}}),Object.defineProperty(e,"NotificationType0",{enumerable:!0,get:function(){return i.NotificationType0}}),Object.defineProperty(e,"NotificationType1",{enumerable:!0,get:function(){return i.NotificationType1}}),Object.defineProperty(e,"NotificationType2",{enumerable:!0,get:function(){return i.NotificationType2}}),Object.defineProperty(e,"NotificationType3",{enumerable:!0,get:function(){return i.NotificationType3}}),Object.defineProperty(e,"NotificationType4",{enumerable:!0,get:function(){return i.NotificationType4}}),Object.defineProperty(e,"NotificationType5",{enumerable:!0,get:function(){return i.NotificationType5}}),Object.defineProperty(e,"NotificationType6",{enumerable:!0,get:function(){return i.NotificationType6}}),Object.defineProperty(e,"NotificationType7",{enumerable:!0,get:function(){return i.NotificationType7}}),Object.defineProperty(e,"NotificationType8",{enumerable:!0,get:function(){return i.NotificationType8}}),Object.defineProperty(e,"NotificationType9",{enumerable:!0,get:function(){return i.NotificationType9}}),Object.defineProperty(e,"ParameterStructures",{enumerable:!0,get:function(){return i.ParameterStructures}});const d=_r();Object.defineProperty(e,"LinkedMap",{enumerable:!0,get:function(){return d.LinkedMap}}),Object.defineProperty(e,"LRUCache",{enumerable:!0,get:function(){return d.LRUCache}}),Object.defineProperty(e,"Touch",{enumerable:!0,get:function(){return d.Touch}});const s=Nr();Object.defineProperty(e,"Disposable",{enumerable:!0,get:function(){return s.Disposable}});const f=rn();Object.defineProperty(e,"Event",{enumerable:!0,get:function(){return f.Event}}),Object.defineProperty(e,"Emitter",{enumerable:!0,get:function(){return f.Emitter}});const n=mn();Object.defineProperty(e,"CancellationTokenSource",{enumerable:!0,get:function(){return n.CancellationTokenSource}}),Object.defineProperty(e,"CancellationToken",{enumerable:!0,get:function(){return n.CancellationToken}});const u=Er();Object.defineProperty(e,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return u.SharedArraySenderStrategy}}),Object.defineProperty(e,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return u.SharedArrayReceiverStrategy}});const o=Or();Object.defineProperty(e,"MessageReader",{enumerable:!0,get:function(){return o.MessageReader}}),Object.defineProperty(e,"AbstractMessageReader",{enumerable:!0,get:function(){return o.AbstractMessageReader}}),Object.defineProperty(e,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return o.ReadableStreamMessageReader}});const r=jr();Object.defineProperty(e,"MessageWriter",{enumerable:!0,get:function(){return r.MessageWriter}}),Object.defineProperty(e,"AbstractMessageWriter",{enumerable:!0,get:function(){return r.AbstractMessageWriter}}),Object.defineProperty(e,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return r.WriteableStreamMessageWriter}});const l=Lr();Object.defineProperty(e,"AbstractMessageBuffer",{enumerable:!0,get:function(){return l.AbstractMessageBuffer}});const m=$r();Object.defineProperty(e,"ConnectionStrategy",{enumerable:!0,get:function(){return m.ConnectionStrategy}}),Object.defineProperty(e,"ConnectionOptions",{enumerable:!0,get:function(){return m.ConnectionOptions}}),Object.defineProperty(e,"NullLogger",{enumerable:!0,get:function(){return m.NullLogger}}),Object.defineProperty(e,"createMessageConnection",{enumerable:!0,get:function(){return m.createMessageConnection}}),Object.defineProperty(e,"ProgressToken",{enumerable:!0,get:function(){return m.ProgressToken}}),Object.defineProperty(e,"ProgressType",{enumerable:!0,get:function(){return m.ProgressType}}),Object.defineProperty(e,"Trace",{enumerable:!0,get:function(){return m.Trace}}),Object.defineProperty(e,"TraceValues",{enumerable:!0,get:function(){return m.TraceValues}}),Object.defineProperty(e,"TraceFormat",{enumerable:!0,get:function(){return m.TraceFormat}}),Object.defineProperty(e,"SetTraceNotification",{enumerable:!0,get:function(){return m.SetTraceNotification}}),Object.defineProperty(e,"LogTraceNotification",{enumerable:!0,get:function(){return m.LogTraceNotification}}),Object.defineProperty(e,"ConnectionErrors",{enumerable:!0,get:function(){return m.ConnectionErrors}}),Object.defineProperty(e,"ConnectionError",{enumerable:!0,get:function(){return m.ConnectionError}}),Object.defineProperty(e,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return m.CancellationReceiverStrategy}}),Object.defineProperty(e,"CancellationSenderStrategy",{enumerable:!0,get:function(){return m.CancellationSenderStrategy}}),Object.defineProperty(e,"CancellationStrategy",{enumerable:!0,get:function(){return m.CancellationStrategy}}),Object.defineProperty(e,"MessageStrategy",{enumerable:!0,get:function(){return m.MessageStrategy}});const p=Xt();e.RAL=p.default}(sn)),sn}var Mn;function Ar(){if(Mn)return xt;Mn=1,Object.defineProperty(xt,"__esModule",{value:!0});const e=fn();class i extends e.AbstractMessageBuffer{constructor(r="utf-8"){super(r),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return i.emptyBuffer}fromString(r,l){return new TextEncoder().encode(r)}toString(r,l){return l==="ascii"?this.asciiDecoder.decode(r):new TextDecoder(l).decode(r)}asNative(r,l){return l===void 0?r:r.slice(0,l)}allocNative(r){return new Uint8Array(r)}}i.emptyBuffer=new Uint8Array(0);class d{constructor(r){this.socket=r,this._onData=new e.Emitter,this._messageListener=l=>{l.data.arrayBuffer().then(p=>{this._onData.fire(new Uint8Array(p))},()=>{(0,e.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(r){return this.socket.addEventListener("close",r),e.Disposable.create(()=>this.socket.removeEventListener("close",r))}onError(r){return this.socket.addEventListener("error",r),e.Disposable.create(()=>this.socket.removeEventListener("error",r))}onEnd(r){return this.socket.addEventListener("end",r),e.Disposable.create(()=>this.socket.removeEventListener("end",r))}onData(r){return this._onData.event(r)}}class s{constructor(r){this.socket=r}onClose(r){return this.socket.addEventListener("close",r),e.Disposable.create(()=>this.socket.removeEventListener("close",r))}onError(r){return this.socket.addEventListener("error",r),e.Disposable.create(()=>this.socket.removeEventListener("error",r))}onEnd(r){return this.socket.addEventListener("end",r),e.Disposable.create(()=>this.socket.removeEventListener("end",r))}write(r,l){if(typeof r=="string"){if(l!==void 0&&l!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${l}`);this.socket.send(r)}else this.socket.send(r);return Promise.resolve()}end(){this.socket.close()}}const f=new TextEncoder,n=Object.freeze({messageBuffer:Object.freeze({create:o=>new i(o)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(o,r)=>{if(r.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${r.charset}`);return Promise.resolve(f.encode(JSON.stringify(o,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(o,r)=>{if(!(o instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(r.charset).decode(o)))}})}),stream:Object.freeze({asReadableStream:o=>new d(o),asWritableStream:o=>new s(o)}),console,timer:Object.freeze({setTimeout(o,r,...l){const m=setTimeout(o,r,...l);return{dispose:()=>clearTimeout(m)}},setImmediate(o,...r){const l=setTimeout(o,0,...r);return{dispose:()=>clearTimeout(l)}},setInterval(o,r,...l){const m=setInterval(o,r,...l);return{dispose:()=>clearInterval(m)}}})});function u(){return n}return function(o){function r(){e.RAL.install(n)}o.install=r}(u||(u={})),xt.default=u,xt}var Cn;function jt(){return Cn||(Cn=1,function(e){var i=tt&&tt.__createBinding||(Object.create?function(r,l,m,p){p===void 0&&(p=m);var y=Object.getOwnPropertyDescriptor(l,m);(!y||("get"in y?!l.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return l[m]}}),Object.defineProperty(r,p,y)}:function(r,l,m,p){p===void 0&&(p=m),r[p]=l[m]}),d=tt&&tt.__exportStar||function(r,l){for(var m in r)m!=="default"&&!Object.prototype.hasOwnProperty.call(l,m)&&i(l,r,m)};Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.BrowserMessageWriter=e.BrowserMessageReader=void 0,Ar().default.install();const f=fn();d(fn(),e);class n extends f.AbstractMessageReader{constructor(l){super(),this._onData=new f.Emitter,this._messageListener=m=>{this._onData.fire(m.data)},l.addEventListener("error",m=>this.fireError(m)),l.onmessage=this._messageListener}listen(l){return this._onData.event(l)}}e.BrowserMessageReader=n;class u extends f.AbstractMessageWriter{constructor(l){super(),this.port=l,this.errorCount=0,l.addEventListener("error",m=>this.fireError(m))}write(l){try{return this.port.postMessage(l),Promise.resolve()}catch(m){return this.handleError(m,l),Promise.reject(m)}}handleError(l,m){this.errorCount++,this.fireError(l,m,this.errorCount)}end(){}}e.BrowserMessageWriter=u;function o(r,l,m,p){return m===void 0&&(m=f.NullLogger),f.ConnectionStrategy.is(p)&&(p={connectionStrategy:p}),(0,f.createMessageConnection)(r,l,m,p)}e.createMessageConnection=o}(tt)),tt}var cn,qn;function Nn(){return qn||(qn=1,cn=jt()),cn}var rt={};const gn=qr(Cr);var ge={},En;function Z(){if(En)return ge;En=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.ProtocolNotificationType=ge.ProtocolNotificationType0=ge.ProtocolRequestType=ge.ProtocolRequestType0=ge.RegistrationType=ge.MessageDirection=void 0;const e=jt();var i;(function(o){o.clientToServer="clientToServer",o.serverToClient="serverToClient",o.both="both"})(i||(ge.MessageDirection=i={}));class d{constructor(r){this.method=r}}ge.RegistrationType=d;class s extends e.RequestType0{constructor(r){super(r)}}ge.ProtocolRequestType0=s;class f extends e.RequestType{constructor(r){super(r,e.ParameterStructures.byName)}}ge.ProtocolRequestType=f;class n extends e.NotificationType0{constructor(r){super(r)}}ge.ProtocolNotificationType0=n;class u extends e.NotificationType{constructor(r){super(r,e.ParameterStructures.byName)}}return ge.ProtocolNotificationType=u,ge}var un={},te={},On;function yn(){if(On)return te;On=1,Object.defineProperty(te,"__esModule",{value:!0}),te.objectLiteral=te.typedArray=te.stringArray=te.array=te.func=te.error=te.number=te.string=te.boolean=void 0;function e(l){return l===!0||l===!1}te.boolean=e;function i(l){return typeof l=="string"||l instanceof String}te.string=i;function d(l){return typeof l=="number"||l instanceof Number}te.number=d;function s(l){return l instanceof Error}te.error=s;function f(l){return typeof l=="function"}te.func=f;function n(l){return Array.isArray(l)}te.array=n;function u(l){return n(l)&&l.every(m=>i(m))}te.stringArray=u;function o(l,m){return Array.isArray(l)&&l.every(m)}te.typedArray=o;function r(l){return l!==null&&typeof l=="object"}return te.objectLiteral=r,te}var It={},jn;function Ir(){if(jn)return It;jn=1,Object.defineProperty(It,"__esModule",{value:!0}),It.ImplementationRequest=void 0;const e=Z();var i;return function(d){d.method="textDocument/implementation",d.messageDirection=e.MessageDirection.clientToServer,d.type=new e.ProtocolRequestType(d.method)}(i||(It.ImplementationRequest=i={})),It}var Ft={},Ln;function Fr(){if(Ln)return Ft;Ln=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.TypeDefinitionRequest=void 0;const e=Z();var i;return function(d){d.method="textDocument/typeDefinition",d.messageDirection=e.MessageDirection.clientToServer,d.type=new e.ProtocolRequestType(d.method)}(i||(Ft.TypeDefinitionRequest=i={})),Ft}var it={},$n;function Wr(){if($n)return it;$n=1,Object.defineProperty(it,"__esModule",{value:!0}),it.DidChangeWorkspaceFoldersNotification=it.WorkspaceFoldersRequest=void 0;const e=Z();var i;(function(s){s.method="workspace/workspaceFolders",s.messageDirection=e.MessageDirection.serverToClient,s.type=new e.ProtocolRequestType0(s.method)})(i||(it.WorkspaceFoldersRequest=i={}));var d;return function(s){s.method="workspace/didChangeWorkspaceFolders",s.messageDirection=e.MessageDirection.clientToServer,s.type=new e.ProtocolNotificationType(s.method)}(d||(it.DidChangeWorkspaceFoldersNotification=d={})),it}var Wt={},An;function Br(){if(An)return Wt;An=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.ConfigurationRequest=void 0;const e=Z();var i;return function(d){d.method="workspace/configuration",d.messageDirection=e.MessageDirection.serverToClient,d.type=new e.ProtocolRequestType(d.method)}(i||(Wt.ConfigurationRequest=i={})),Wt}var ot={},In;function Hr(){if(In)return ot;In=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.ColorPresentationRequest=ot.DocumentColorRequest=void 0;const e=Z();var i;(function(s){s.method="textDocument/documentColor",s.messageDirection=e.MessageDirection.clientToServer,s.type=new e.ProtocolRequestType(s.method)})(i||(ot.DocumentColorRequest=i={}));var d;return function(s){s.method="textDocument/colorPresentation",s.messageDirection=e.MessageDirection.clientToServer,s.type=new e.ProtocolRequestType(s.method)}(d||(ot.ColorPresentationRequest=d={})),ot}var st={},Fn;function zr(){if(Fn)return st;Fn=1,Object.defineProperty(st,"__esModule",{value:!0}),st.FoldingRangeRefreshRequest=st.FoldingRangeRequest=void 0;const e=Z();var i;(function(s){s.method="textDocument/foldingRange",s.messageDirection=e.MessageDirection.clientToServer,s.type=new e.ProtocolRequestType(s.method)})(i||(st.FoldingRangeRequest=i={}));var d;return function(s){s.method="workspace/foldingRange/refresh",s.messageDirection=e.MessageDirection.serverToClient,s.type=new e.ProtocolRequestType0(s.method)}(d||(st.FoldingRangeRefreshRequest=d={})),st}var Bt={},Wn;function Ur(){if(Wn)return Bt;Wn=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.DeclarationRequest=void 0;const e=Z();var i;return function(d){d.method="textDocument/declaration",d.messageDirection=e.MessageDirection.clientToServer,d.type=new e.ProtocolRequestType(d.method)}(i||(Bt.DeclarationRequest=i={})),Bt}var Ht={},Bn;function Vr(){if(Bn)return Ht;Bn=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.SelectionRangeRequest=void 0;const e=Z();var i;return function(d){d.method="textDocument/selectionRange",d.messageDirection=e.MessageDirection.clientToServer,d.type=new e.ProtocolRequestType(d.method)}(i||(Ht.SelectionRangeRequest=i={})),Ht}var Le={},Hn;function Jr(){if(Hn)return Le;Hn=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.WorkDoneProgressCancelNotification=Le.WorkDoneProgressCreateRequest=Le.WorkDoneProgress=void 0;const e=jt(),i=Z();var d;(function(n){n.type=new e.ProgressType;function u(o){return o===n.type}n.is=u})(d||(Le.WorkDoneProgress=d={}));var s;(function(n){n.method="window/workDoneProgress/create",n.messageDirection=i.MessageDirection.serverToClient,n.type=new i.ProtocolRequestType(n.method)})(s||(Le.WorkDoneProgressCreateRequest=s={}));var f;return function(n){n.method="window/workDoneProgress/cancel",n.messageDirection=i.MessageDirection.clientToServer,n.type=new i.ProtocolNotificationType(n.method)}(f||(Le.WorkDoneProgressCancelNotification=f={})),Le}var $e={},zn;function Kr(){if(zn)return $e;zn=1,Object.defineProperty($e,"__esModule",{value:!0}),$e.CallHierarchyOutgoingCallsRequest=$e.CallHierarchyIncomingCallsRequest=$e.CallHierarchyPrepareRequest=void 0;const e=Z();var i;(function(f){f.method="textDocument/prepareCallHierarchy",f.messageDirection=e.MessageDirection.clientToServer,f.type=new e.ProtocolRequestType(f.method)})(i||($e.CallHierarchyPrepareRequest=i={}));var d;(function(f){f.method="callHierarchy/incomingCalls",f.messageDirection=e.MessageDirection.clientToServer,f.type=new e.ProtocolRequestType(f.method)})(d||($e.CallHierarchyIncomingCallsRequest=d={}));var s;return function(f){f.method="callHierarchy/outgoingCalls",f.messageDirection=e.MessageDirection.clientToServer,f.type=new e.ProtocolRequestType(f.method)}(s||($e.CallHierarchyOutgoingCallsRequest=s={})),$e}var ye={},Un;function Qr(){if(Un)return ye;Un=1,Object.defineProperty(ye,"__esModule",{value:!0}),ye.SemanticTokensRefreshRequest=ye.SemanticTokensRangeRequest=ye.SemanticTokensDeltaRequest=ye.SemanticTokensRequest=ye.SemanticTokensRegistrationType=ye.TokenFormat=void 0;const e=Z();var i;(function(o){o.Relative="relative"})(i||(ye.TokenFormat=i={}));var d;(function(o){o.method="textDocument/semanticTokens",o.type=new e.RegistrationType(o.method)})(d||(ye.SemanticTokensRegistrationType=d={}));var s;(function(o){o.method="textDocument/semanticTokens/full",o.messageDirection=e.MessageDirection.clientToServer,o.type=new e.ProtocolRequestType(o.method),o.registrationMethod=d.method})(s||(ye.SemanticTokensRequest=s={}));var f;(function(o){o.method="textDocument/semanticTokens/full/delta",o.messageDirection=e.MessageDirection.clientToServer,o.type=new e.ProtocolRequestType(o.method),o.registrationMethod=d.method})(f||(ye.SemanticTokensDeltaRequest=f={}));var n;(function(o){o.method="textDocument/semanticTokens/range",o.messageDirection=e.MessageDirection.clientToServer,o.type=new e.ProtocolRequestType(o.method),o.registrationMethod=d.method})(n||(ye.SemanticTokensRangeRequest=n={}));var u;return function(o){o.method="workspace/semanticTokens/refresh",o.messageDirection=e.MessageDirection.serverToClient,o.type=new e.ProtocolRequestType0(o.method)}(u||(ye.SemanticTokensRefreshRequest=u={})),ye}var zt={},Vn;function Gr(){if(Vn)return zt;Vn=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.ShowDocumentRequest=void 0;const e=Z();var i;return function(d){d.method="window/showDocument",d.messageDirection=e.MessageDirection.serverToClient,d.type=new e.ProtocolRequestType(d.method)}(i||(zt.ShowDocumentRequest=i={})),zt}var Ut={},Jn;function Xr(){if(Jn)return Ut;Jn=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.LinkedEditingRangeRequest=void 0;const e=Z();var i;return function(d){d.method="textDocument/linkedEditingRange",d.messageDirection=e.MessageDirection.clientToServer,d.type=new e.ProtocolRequestType(d.method)}(i||(Ut.LinkedEditingRangeRequest=i={})),Ut}var de={},Kn;function Yr(){if(Kn)return de;Kn=1,Object.defineProperty(de,"__esModule",{value:!0}),de.WillDeleteFilesRequest=de.DidDeleteFilesNotification=de.DidRenameFilesNotification=de.WillRenameFilesRequest=de.DidCreateFilesNotification=de.WillCreateFilesRequest=de.FileOperationPatternKind=void 0;const e=Z();var i;(function(r){r.file="file",r.folder="folder"})(i||(de.FileOperationPatternKind=i={}));var d;(function(r){r.method="workspace/willCreateFiles",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)})(d||(de.WillCreateFilesRequest=d={}));var s;(function(r){r.method="workspace/didCreateFiles",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolNotificationType(r.method)})(s||(de.DidCreateFilesNotification=s={}));var f;(function(r){r.method="workspace/willRenameFiles",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)})(f||(de.WillRenameFilesRequest=f={}));var n;(function(r){r.method="workspace/didRenameFiles",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolNotificationType(r.method)})(n||(de.DidRenameFilesNotification=n={}));var u;(function(r){r.method="workspace/didDeleteFiles",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolNotificationType(r.method)})(u||(de.DidDeleteFilesNotification=u={}));var o;return function(r){r.method="workspace/willDeleteFiles",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)}(o||(de.WillDeleteFilesRequest=o={})),de}var Ae={},Qn;function Zr(){if(Qn)return Ae;Qn=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.MonikerRequest=Ae.MonikerKind=Ae.UniquenessLevel=void 0;const e=Z();var i;(function(f){f.document="document",f.project="project",f.group="group",f.scheme="scheme",f.global="global"})(i||(Ae.UniquenessLevel=i={}));var d;(function(f){f.$import="import",f.$export="export",f.local="local"})(d||(Ae.MonikerKind=d={}));var s;return function(f){f.method="textDocument/moniker",f.messageDirection=e.MessageDirection.clientToServer,f.type=new e.ProtocolRequestType(f.method)}(s||(Ae.MonikerRequest=s={})),Ae}var Ie={},Gn;function xr(){if(Gn)return Ie;Gn=1,Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.TypeHierarchySubtypesRequest=Ie.TypeHierarchySupertypesRequest=Ie.TypeHierarchyPrepareRequest=void 0;const e=Z();var i;(function(f){f.method="textDocument/prepareTypeHierarchy",f.messageDirection=e.MessageDirection.clientToServer,f.type=new e.ProtocolRequestType(f.method)})(i||(Ie.TypeHierarchyPrepareRequest=i={}));var d;(function(f){f.method="typeHierarchy/supertypes",f.messageDirection=e.MessageDirection.clientToServer,f.type=new e.ProtocolRequestType(f.method)})(d||(Ie.TypeHierarchySupertypesRequest=d={}));var s;return function(f){f.method="typeHierarchy/subtypes",f.messageDirection=e.MessageDirection.clientToServer,f.type=new e.ProtocolRequestType(f.method)}(s||(Ie.TypeHierarchySubtypesRequest=s={})),Ie}var at={},Xn;function ei(){if(Xn)return at;Xn=1,Object.defineProperty(at,"__esModule",{value:!0}),at.InlineValueRefreshRequest=at.InlineValueRequest=void 0;const e=Z();var i;(function(s){s.method="textDocument/inlineValue",s.messageDirection=e.MessageDirection.clientToServer,s.type=new e.ProtocolRequestType(s.method)})(i||(at.InlineValueRequest=i={}));var d;return function(s){s.method="workspace/inlineValue/refresh",s.messageDirection=e.MessageDirection.serverToClient,s.type=new e.ProtocolRequestType0(s.method)}(d||(at.InlineValueRefreshRequest=d={})),at}var Fe={},Yn;function ti(){if(Yn)return Fe;Yn=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.InlayHintRefreshRequest=Fe.InlayHintResolveRequest=Fe.InlayHintRequest=void 0;const e=Z();var i;(function(f){f.method="textDocument/inlayHint",f.messageDirection=e.MessageDirection.clientToServer,f.type=new e.ProtocolRequestType(f.method)})(i||(Fe.InlayHintRequest=i={}));var d;(function(f){f.method="inlayHint/resolve",f.messageDirection=e.MessageDirection.clientToServer,f.type=new e.ProtocolRequestType(f.method)})(d||(Fe.InlayHintResolveRequest=d={}));var s;return function(f){f.method="workspace/inlayHint/refresh",f.messageDirection=e.MessageDirection.serverToClient,f.type=new e.ProtocolRequestType0(f.method)}(s||(Fe.InlayHintRefreshRequest=s={})),Fe}var Pe={},Zn;function ni(){if(Zn)return Pe;Zn=1,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.DiagnosticRefreshRequest=Pe.WorkspaceDiagnosticRequest=Pe.DocumentDiagnosticRequest=Pe.DocumentDiagnosticReportKind=Pe.DiagnosticServerCancellationData=void 0;const e=jt(),i=yn(),d=Z();var s;(function(r){function l(m){const p=m;return p&&i.boolean(p.retriggerRequest)}r.is=l})(s||(Pe.DiagnosticServerCancellationData=s={}));var f;(function(r){r.Full="full",r.Unchanged="unchanged"})(f||(Pe.DocumentDiagnosticReportKind=f={}));var n;(function(r){r.method="textDocument/diagnostic",r.messageDirection=d.MessageDirection.clientToServer,r.type=new d.ProtocolRequestType(r.method),r.partialResult=new e.ProgressType})(n||(Pe.DocumentDiagnosticRequest=n={}));var u;(function(r){r.method="workspace/diagnostic",r.messageDirection=d.MessageDirection.clientToServer,r.type=new d.ProtocolRequestType(r.method),r.partialResult=new e.ProgressType})(u||(Pe.WorkspaceDiagnosticRequest=u={}));var o;return function(r){r.method="workspace/diagnostic/refresh",r.messageDirection=d.MessageDirection.serverToClient,r.type=new d.ProtocolRequestType0(r.method)}(o||(Pe.DiagnosticRefreshRequest=o={})),Pe}var Y={},xn;function ri(){if(xn)return Y;xn=1,Object.defineProperty(Y,"__esModule",{value:!0}),Y.DidCloseNotebookDocumentNotification=Y.DidSaveNotebookDocumentNotification=Y.DidChangeNotebookDocumentNotification=Y.NotebookCellArrayChange=Y.DidOpenNotebookDocumentNotification=Y.NotebookDocumentSyncRegistrationType=Y.NotebookDocument=Y.NotebookCell=Y.ExecutionSummary=Y.NotebookCellKind=void 0;const e=gn,i=yn(),d=Z();var s;(function(v){v.Markup=1,v.Code=2;function P(B){return B===1||B===2}v.is=P})(s||(Y.NotebookCellKind=s={}));var f;(function(v){function P(C,k){const $={executionOrder:C};return(k===!0||k===!1)&&($.success=k),$}v.create=P;function B(C){const k=C;return i.objectLiteral(k)&&e.uinteger.is(k.executionOrder)&&(k.success===void 0||i.boolean(k.success))}v.is=B;function I(C,k){return C===k?!0:C==null||k===null||k===void 0?!1:C.executionOrder===k.executionOrder&&C.success===k.success}v.equals=I})(f||(Y.ExecutionSummary=f={}));var n;(function(v){function P(k,$){return{kind:k,document:$}}v.create=P;function B(k){const $=k;return i.objectLiteral($)&&s.is($.kind)&&e.DocumentUri.is($.document)&&($.metadata===void 0||i.objectLiteral($.metadata))}v.is=B;function I(k,$){const Q=new Set;return k.document!==$.document&&Q.add("document"),k.kind!==$.kind&&Q.add("kind"),k.executionSummary!==$.executionSummary&&Q.add("executionSummary"),(k.metadata!==void 0||$.metadata!==void 0)&&!C(k.metadata,$.metadata)&&Q.add("metadata"),(k.executionSummary!==void 0||$.executionSummary!==void 0)&&!f.equals(k.executionSummary,$.executionSummary)&&Q.add("executionSummary"),Q}v.diff=I;function C(k,$){if(k===$)return!0;if(k==null||$===null||$===void 0||typeof k!=typeof $||typeof k!="object")return!1;const Q=Array.isArray(k),ce=Array.isArray($);if(Q!==ce)return!1;if(Q&&ce){if(k.length!==$.length)return!1;for(let J=0;J<k.length;J++)if(!C(k[J],$[J]))return!1}if(i.objectLiteral(k)&&i.objectLiteral($)){const J=Object.keys(k),K=Object.keys($);if(J.length!==K.length||(J.sort(),K.sort(),!C(J,K)))return!1;for(let se=0;se<J.length;se++){const ne=J[se];if(!C(k[ne],$[ne]))return!1}}return!0}})(n||(Y.NotebookCell=n={}));var u;(function(v){function P(I,C,k,$){return{uri:I,notebookType:C,version:k,cells:$}}v.create=P;function B(I){const C=I;return i.objectLiteral(C)&&i.string(C.uri)&&e.integer.is(C.version)&&i.typedArray(C.cells,n.is)}v.is=B})(u||(Y.NotebookDocument=u={}));var o;(function(v){v.method="notebookDocument/sync",v.messageDirection=d.MessageDirection.clientToServer,v.type=new d.RegistrationType(v.method)})(o||(Y.NotebookDocumentSyncRegistrationType=o={}));var r;(function(v){v.method="notebookDocument/didOpen",v.messageDirection=d.MessageDirection.clientToServer,v.type=new d.ProtocolNotificationType(v.method),v.registrationMethod=o.method})(r||(Y.DidOpenNotebookDocumentNotification=r={}));var l;(function(v){function P(I){const C=I;return i.objectLiteral(C)&&e.uinteger.is(C.start)&&e.uinteger.is(C.deleteCount)&&(C.cells===void 0||i.typedArray(C.cells,n.is))}v.is=P;function B(I,C,k){const $={start:I,deleteCount:C};return k!==void 0&&($.cells=k),$}v.create=B})(l||(Y.NotebookCellArrayChange=l={}));var m;(function(v){v.method="notebookDocument/didChange",v.messageDirection=d.MessageDirection.clientToServer,v.type=new d.ProtocolNotificationType(v.method),v.registrationMethod=o.method})(m||(Y.DidChangeNotebookDocumentNotification=m={}));var p;(function(v){v.method="notebookDocument/didSave",v.messageDirection=d.MessageDirection.clientToServer,v.type=new d.ProtocolNotificationType(v.method),v.registrationMethod=o.method})(p||(Y.DidSaveNotebookDocumentNotification=p={}));var y;return function(v){v.method="notebookDocument/didClose",v.messageDirection=d.MessageDirection.clientToServer,v.type=new d.ProtocolNotificationType(v.method),v.registrationMethod=o.method}(y||(Y.DidCloseNotebookDocumentNotification=y={})),Y}var Vt={},er;function ii(){if(er)return Vt;er=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.InlineCompletionRequest=void 0;const e=Z();var i;return function(d){d.method="textDocument/inlineCompletion",d.messageDirection=e.MessageDirection.clientToServer,d.type=new e.ProtocolRequestType(d.method)}(i||(Vt.InlineCompletionRequest=i={})),Vt}var tr;function oi(){return tr||(tr=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WorkspaceSymbolRequest=e.CodeActionResolveRequest=e.CodeActionRequest=e.DocumentSymbolRequest=e.DocumentHighlightRequest=e.ReferencesRequest=e.DefinitionRequest=e.SignatureHelpRequest=e.SignatureHelpTriggerKind=e.HoverRequest=e.CompletionResolveRequest=e.CompletionRequest=e.CompletionTriggerKind=e.PublishDiagnosticsNotification=e.WatchKind=e.RelativePattern=e.FileChangeType=e.DidChangeWatchedFilesNotification=e.WillSaveTextDocumentWaitUntilRequest=e.WillSaveTextDocumentNotification=e.TextDocumentSaveReason=e.DidSaveTextDocumentNotification=e.DidCloseTextDocumentNotification=e.DidChangeTextDocumentNotification=e.TextDocumentContentChangeEvent=e.DidOpenTextDocumentNotification=e.TextDocumentSyncKind=e.TelemetryEventNotification=e.LogMessageNotification=e.ShowMessageRequest=e.ShowMessageNotification=e.MessageType=e.DidChangeConfigurationNotification=e.ExitNotification=e.ShutdownRequest=e.InitializedNotification=e.InitializeErrorCodes=e.InitializeRequest=e.WorkDoneProgressOptions=e.TextDocumentRegistrationOptions=e.StaticRegistrationOptions=e.PositionEncodingKind=e.FailureHandlingKind=e.ResourceOperationKind=e.UnregistrationRequest=e.RegistrationRequest=e.DocumentSelector=e.NotebookCellTextDocumentFilter=e.NotebookDocumentFilter=e.TextDocumentFilter=void 0,e.MonikerRequest=e.MonikerKind=e.UniquenessLevel=e.WillDeleteFilesRequest=e.DidDeleteFilesNotification=e.WillRenameFilesRequest=e.DidRenameFilesNotification=e.WillCreateFilesRequest=e.DidCreateFilesNotification=e.FileOperationPatternKind=e.LinkedEditingRangeRequest=e.ShowDocumentRequest=e.SemanticTokensRegistrationType=e.SemanticTokensRefreshRequest=e.SemanticTokensRangeRequest=e.SemanticTokensDeltaRequest=e.SemanticTokensRequest=e.TokenFormat=e.CallHierarchyPrepareRequest=e.CallHierarchyOutgoingCallsRequest=e.CallHierarchyIncomingCallsRequest=e.WorkDoneProgressCancelNotification=e.WorkDoneProgressCreateRequest=e.WorkDoneProgress=e.SelectionRangeRequest=e.DeclarationRequest=e.FoldingRangeRefreshRequest=e.FoldingRangeRequest=e.ColorPresentationRequest=e.DocumentColorRequest=e.ConfigurationRequest=e.DidChangeWorkspaceFoldersNotification=e.WorkspaceFoldersRequest=e.TypeDefinitionRequest=e.ImplementationRequest=e.ApplyWorkspaceEditRequest=e.ExecuteCommandRequest=e.PrepareRenameRequest=e.RenameRequest=e.PrepareSupportDefaultBehavior=e.DocumentOnTypeFormattingRequest=e.DocumentRangesFormattingRequest=e.DocumentRangeFormattingRequest=e.DocumentFormattingRequest=e.DocumentLinkResolveRequest=e.DocumentLinkRequest=e.CodeLensRefreshRequest=e.CodeLensResolveRequest=e.CodeLensRequest=e.WorkspaceSymbolResolveRequest=void 0,e.InlineCompletionRequest=e.DidCloseNotebookDocumentNotification=e.DidSaveNotebookDocumentNotification=e.DidChangeNotebookDocumentNotification=e.NotebookCellArrayChange=e.DidOpenNotebookDocumentNotification=e.NotebookDocumentSyncRegistrationType=e.NotebookDocument=e.NotebookCell=e.ExecutionSummary=e.NotebookCellKind=e.DiagnosticRefreshRequest=e.WorkspaceDiagnosticRequest=e.DocumentDiagnosticRequest=e.DocumentDiagnosticReportKind=e.DiagnosticServerCancellationData=e.InlayHintRefreshRequest=e.InlayHintResolveRequest=e.InlayHintRequest=e.InlineValueRefreshRequest=e.InlineValueRequest=e.TypeHierarchySupertypesRequest=e.TypeHierarchySubtypesRequest=e.TypeHierarchyPrepareRequest=void 0;const i=Z(),d=gn,s=yn(),f=Ir();Object.defineProperty(e,"ImplementationRequest",{enumerable:!0,get:function(){return f.ImplementationRequest}});const n=Fr();Object.defineProperty(e,"TypeDefinitionRequest",{enumerable:!0,get:function(){return n.TypeDefinitionRequest}});const u=Wr();Object.defineProperty(e,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return u.WorkspaceFoldersRequest}}),Object.defineProperty(e,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return u.DidChangeWorkspaceFoldersNotification}});const o=Br();Object.defineProperty(e,"ConfigurationRequest",{enumerable:!0,get:function(){return o.ConfigurationRequest}});const r=Hr();Object.defineProperty(e,"DocumentColorRequest",{enumerable:!0,get:function(){return r.DocumentColorRequest}}),Object.defineProperty(e,"ColorPresentationRequest",{enumerable:!0,get:function(){return r.ColorPresentationRequest}});const l=zr();Object.defineProperty(e,"FoldingRangeRequest",{enumerable:!0,get:function(){return l.FoldingRangeRequest}}),Object.defineProperty(e,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return l.FoldingRangeRefreshRequest}});const m=Ur();Object.defineProperty(e,"DeclarationRequest",{enumerable:!0,get:function(){return m.DeclarationRequest}});const p=Vr();Object.defineProperty(e,"SelectionRangeRequest",{enumerable:!0,get:function(){return p.SelectionRangeRequest}});const y=Jr();Object.defineProperty(e,"WorkDoneProgress",{enumerable:!0,get:function(){return y.WorkDoneProgress}}),Object.defineProperty(e,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return y.WorkDoneProgressCreateRequest}}),Object.defineProperty(e,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return y.WorkDoneProgressCancelNotification}});const v=Kr();Object.defineProperty(e,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return v.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(e,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return v.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(e,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return v.CallHierarchyPrepareRequest}});const P=Qr();Object.defineProperty(e,"TokenFormat",{enumerable:!0,get:function(){return P.TokenFormat}}),Object.defineProperty(e,"SemanticTokensRequest",{enumerable:!0,get:function(){return P.SemanticTokensRequest}}),Object.defineProperty(e,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return P.SemanticTokensDeltaRequest}}),Object.defineProperty(e,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return P.SemanticTokensRangeRequest}}),Object.defineProperty(e,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return P.SemanticTokensRefreshRequest}}),Object.defineProperty(e,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return P.SemanticTokensRegistrationType}});const B=Gr();Object.defineProperty(e,"ShowDocumentRequest",{enumerable:!0,get:function(){return B.ShowDocumentRequest}});const I=Xr();Object.defineProperty(e,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return I.LinkedEditingRangeRequest}});const C=Yr();Object.defineProperty(e,"FileOperationPatternKind",{enumerable:!0,get:function(){return C.FileOperationPatternKind}}),Object.defineProperty(e,"DidCreateFilesNotification",{enumerable:!0,get:function(){return C.DidCreateFilesNotification}}),Object.defineProperty(e,"WillCreateFilesRequest",{enumerable:!0,get:function(){return C.WillCreateFilesRequest}}),Object.defineProperty(e,"DidRenameFilesNotification",{enumerable:!0,get:function(){return C.DidRenameFilesNotification}}),Object.defineProperty(e,"WillRenameFilesRequest",{enumerable:!0,get:function(){return C.WillRenameFilesRequest}}),Object.defineProperty(e,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return C.DidDeleteFilesNotification}}),Object.defineProperty(e,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return C.WillDeleteFilesRequest}});const k=Zr();Object.defineProperty(e,"UniquenessLevel",{enumerable:!0,get:function(){return k.UniquenessLevel}}),Object.defineProperty(e,"MonikerKind",{enumerable:!0,get:function(){return k.MonikerKind}}),Object.defineProperty(e,"MonikerRequest",{enumerable:!0,get:function(){return k.MonikerRequest}});const $=xr();Object.defineProperty(e,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return $.TypeHierarchyPrepareRequest}}),Object.defineProperty(e,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return $.TypeHierarchySubtypesRequest}}),Object.defineProperty(e,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return $.TypeHierarchySupertypesRequest}});const Q=ei();Object.defineProperty(e,"InlineValueRequest",{enumerable:!0,get:function(){return Q.InlineValueRequest}}),Object.defineProperty(e,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return Q.InlineValueRefreshRequest}});const ce=ti();Object.defineProperty(e,"InlayHintRequest",{enumerable:!0,get:function(){return ce.InlayHintRequest}}),Object.defineProperty(e,"InlayHintResolveRequest",{enumerable:!0,get:function(){return ce.InlayHintResolveRequest}}),Object.defineProperty(e,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return ce.InlayHintRefreshRequest}});const J=ni();Object.defineProperty(e,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return J.DiagnosticServerCancellationData}}),Object.defineProperty(e,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return J.DocumentDiagnosticReportKind}}),Object.defineProperty(e,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return J.DocumentDiagnosticRequest}}),Object.defineProperty(e,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return J.WorkspaceDiagnosticRequest}}),Object.defineProperty(e,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return J.DiagnosticRefreshRequest}});const K=ri();Object.defineProperty(e,"NotebookCellKind",{enumerable:!0,get:function(){return K.NotebookCellKind}}),Object.defineProperty(e,"ExecutionSummary",{enumerable:!0,get:function(){return K.ExecutionSummary}}),Object.defineProperty(e,"NotebookCell",{enumerable:!0,get:function(){return K.NotebookCell}}),Object.defineProperty(e,"NotebookDocument",{enumerable:!0,get:function(){return K.NotebookDocument}}),Object.defineProperty(e,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return K.NotebookDocumentSyncRegistrationType}}),Object.defineProperty(e,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return K.DidOpenNotebookDocumentNotification}}),Object.defineProperty(e,"NotebookCellArrayChange",{enumerable:!0,get:function(){return K.NotebookCellArrayChange}}),Object.defineProperty(e,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return K.DidChangeNotebookDocumentNotification}}),Object.defineProperty(e,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return K.DidSaveNotebookDocumentNotification}}),Object.defineProperty(e,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return K.DidCloseNotebookDocumentNotification}});const se=ii();Object.defineProperty(e,"InlineCompletionRequest",{enumerable:!0,get:function(){return se.InlineCompletionRequest}});var ne;(function(c){function G(X){const j=X;return s.string(j)||s.string(j.language)||s.string(j.scheme)||s.string(j.pattern)}c.is=G})(ne||(e.TextDocumentFilter=ne={}));var _e;(function(c){function G(X){const j=X;return s.objectLiteral(j)&&(s.string(j.notebookType)||s.string(j.scheme)||s.string(j.pattern))}c.is=G})(_e||(e.NotebookDocumentFilter=_e={}));var U;(function(c){function G(X){const j=X;return s.objectLiteral(j)&&(s.string(j.notebook)||_e.is(j.notebook))&&(j.language===void 0||s.string(j.language))}c.is=G})(U||(e.NotebookCellTextDocumentFilter=U={}));var _;(function(c){function G(X){if(!Array.isArray(X))return!1;for(let j of X)if(!s.string(j)&&!ne.is(j)&&!U.is(j))return!1;return!0}c.is=G})(_||(e.DocumentSelector=_={}));var a;(function(c){c.method="client/registerCapability",c.messageDirection=i.MessageDirection.serverToClient,c.type=new i.ProtocolRequestType(c.method)})(a||(e.RegistrationRequest=a={}));var T;(function(c){c.method="client/unregisterCapability",c.messageDirection=i.MessageDirection.serverToClient,c.type=new i.ProtocolRequestType(c.method)})(T||(e.UnregistrationRequest=T={}));var w;(function(c){c.Create="create",c.Rename="rename",c.Delete="delete"})(w||(e.ResourceOperationKind=w={}));var R;(function(c){c.Abort="abort",c.Transactional="transactional",c.TextOnlyTransactional="textOnlyTransactional",c.Undo="undo"})(R||(e.FailureHandlingKind=R={}));var S;(function(c){c.UTF8="utf-8",c.UTF16="utf-16",c.UTF32="utf-32"})(S||(e.PositionEncodingKind=S={}));var ht;(function(c){function G(X){const j=X;return j&&s.string(j.id)&&j.id.length>0}c.hasId=G})(ht||(e.StaticRegistrationOptions=ht={}));var mt;(function(c){function G(X){const j=X;return j&&(j.documentSelector===null||_.is(j.documentSelector))}c.is=G})(mt||(e.TextDocumentRegistrationOptions=mt={}));var gt;(function(c){function G(j){const t=j;return s.objectLiteral(t)&&(t.workDoneProgress===void 0||s.boolean(t.workDoneProgress))}c.is=G;function X(j){const t=j;return t&&s.boolean(t.workDoneProgress)}c.hasWorkDoneProgress=X})(gt||(e.WorkDoneProgressOptions=gt={}));var pe;(function(c){c.method="initialize",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(pe||(e.InitializeRequest=pe={}));var ve;(function(c){c.unknownProtocolVersion=1})(ve||(e.InitializeErrorCodes=ve={}));var we;(function(c){c.method="initialized",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolNotificationType(c.method)})(we||(e.InitializedNotification=we={}));var be;(function(c){c.method="shutdown",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType0(c.method)})(be||(e.ShutdownRequest=be={}));var Se;(function(c){c.method="exit",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolNotificationType0(c.method)})(Se||(e.ExitNotification=Se={}));var De;(function(c){c.method="workspace/didChangeConfiguration",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolNotificationType(c.method)})(De||(e.DidChangeConfigurationNotification=De={}));var Ce;(function(c){c.Error=1,c.Warning=2,c.Info=3,c.Log=4,c.Debug=5})(Ce||(e.MessageType=Ce={}));var ue;(function(c){c.method="window/showMessage",c.messageDirection=i.MessageDirection.serverToClient,c.type=new i.ProtocolNotificationType(c.method)})(ue||(e.ShowMessageNotification=ue={}));var ae;(function(c){c.method="window/showMessageRequest",c.messageDirection=i.MessageDirection.serverToClient,c.type=new i.ProtocolRequestType(c.method)})(ae||(e.ShowMessageRequest=ae={}));var ke;(function(c){c.method="window/logMessage",c.messageDirection=i.MessageDirection.serverToClient,c.type=new i.ProtocolNotificationType(c.method)})(ke||(e.LogMessageNotification=ke={}));var x;(function(c){c.method="telemetry/event",c.messageDirection=i.MessageDirection.serverToClient,c.type=new i.ProtocolNotificationType(c.method)})(x||(e.TelemetryEventNotification=x={}));var O;(function(c){c.None=0,c.Full=1,c.Incremental=2})(O||(e.TextDocumentSyncKind=O={}));var le;(function(c){c.method="textDocument/didOpen",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolNotificationType(c.method)})(le||(e.DidOpenTextDocumentNotification=le={}));var H;(function(c){function G(j){let t=j;return t!=null&&typeof t.text=="string"&&t.range!==void 0&&(t.rangeLength===void 0||typeof t.rangeLength=="number")}c.isIncremental=G;function X(j){let t=j;return t!=null&&typeof t.text=="string"&&t.range===void 0&&t.rangeLength===void 0}c.isFull=X})(H||(e.TextDocumentContentChangeEvent=H={}));var re;(function(c){c.method="textDocument/didChange",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolNotificationType(c.method)})(re||(e.DidChangeTextDocumentNotification=re={}));var qe;(function(c){c.method="textDocument/didClose",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolNotificationType(c.method)})(qe||(e.DidCloseTextDocumentNotification=qe={}));var ze;(function(c){c.method="textDocument/didSave",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolNotificationType(c.method)})(ze||(e.DidSaveTextDocumentNotification=ze={}));var Ue;(function(c){c.Manual=1,c.AfterDelay=2,c.FocusOut=3})(Ue||(e.TextDocumentSaveReason=Ue={}));var Ve;(function(c){c.method="textDocument/willSave",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolNotificationType(c.method)})(Ve||(e.WillSaveTextDocumentNotification=Ve={}));var Je;(function(c){c.method="textDocument/willSaveWaitUntil",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Je||(e.WillSaveTextDocumentWaitUntilRequest=Je={}));var ie;(function(c){c.method="workspace/didChangeWatchedFiles",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolNotificationType(c.method)})(ie||(e.DidChangeWatchedFilesNotification=ie={}));var Ke;(function(c){c.Created=1,c.Changed=2,c.Deleted=3})(Ke||(e.FileChangeType=Ke={}));var yt;(function(c){function G(X){const j=X;return s.objectLiteral(j)&&(d.URI.is(j.baseUri)||d.WorkspaceFolder.is(j.baseUri))&&s.string(j.pattern)}c.is=G})(yt||(e.RelativePattern=yt={}));var pt;(function(c){c.Create=1,c.Change=2,c.Delete=4})(pt||(e.WatchKind=pt={}));var vt;(function(c){c.method="textDocument/publishDiagnostics",c.messageDirection=i.MessageDirection.serverToClient,c.type=new i.ProtocolNotificationType(c.method)})(vt||(e.PublishDiagnosticsNotification=vt={}));var bt;(function(c){c.Invoked=1,c.TriggerCharacter=2,c.TriggerForIncompleteCompletions=3})(bt||(e.CompletionTriggerKind=bt={}));var Qe;(function(c){c.method="textDocument/completion",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Qe||(e.CompletionRequest=Qe={}));var Ge;(function(c){c.method="completionItem/resolve",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Ge||(e.CompletionResolveRequest=Ge={}));var he;(function(c){c.method="textDocument/hover",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(he||(e.HoverRequest=he={}));var Xe;(function(c){c.Invoked=1,c.TriggerCharacter=2,c.ContentChange=3})(Xe||(e.SignatureHelpTriggerKind=Xe={}));var Rt;(function(c){c.method="textDocument/signatureHelp",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Rt||(e.SignatureHelpRequest=Rt={}));var Tt;(function(c){c.method="textDocument/definition",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Tt||(e.DefinitionRequest=Tt={}));var Ye;(function(c){c.method="textDocument/references",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Ye||(e.ReferencesRequest=Ye={}));var Ze;(function(c){c.method="textDocument/documentHighlight",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Ze||(e.DocumentHighlightRequest=Ze={}));var _t;(function(c){c.method="textDocument/documentSymbol",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(_t||(e.DocumentSymbolRequest=_t={}));var Pt;(function(c){c.method="textDocument/codeAction",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Pt||(e.CodeActionRequest=Pt={}));var wt;(function(c){c.method="codeAction/resolve",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(wt||(e.CodeActionResolveRequest=wt={}));var St;(function(c){c.method="workspace/symbol",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(St||(e.WorkspaceSymbolRequest=St={}));var Dt;(function(c){c.method="workspaceSymbol/resolve",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Dt||(e.WorkspaceSymbolResolveRequest=Dt={}));var kt;(function(c){c.method="textDocument/codeLens",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(kt||(e.CodeLensRequest=kt={}));var oe;(function(c){c.method="codeLens/resolve",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(oe||(e.CodeLensResolveRequest=oe={}));var Mt;(function(c){c.method="workspace/codeLens/refresh",c.messageDirection=i.MessageDirection.serverToClient,c.type=new i.ProtocolRequestType0(c.method)})(Mt||(e.CodeLensRefreshRequest=Mt={}));var Ct;(function(c){c.method="textDocument/documentLink",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Ct||(e.DocumentLinkRequest=Ct={}));var Me;(function(c){c.method="documentLink/resolve",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Me||(e.DocumentLinkResolveRequest=Me={}));var qt;(function(c){c.method="textDocument/formatting",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(qt||(e.DocumentFormattingRequest=qt={}));var Ne;(function(c){c.method="textDocument/rangeFormatting",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Ne||(e.DocumentRangeFormattingRequest=Ne={}));var Nt;(function(c){c.method="textDocument/rangesFormatting",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Nt||(e.DocumentRangesFormattingRequest=Nt={}));var me;(function(c){c.method="textDocument/onTypeFormatting",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(me||(e.DocumentOnTypeFormattingRequest=me={}));var Re;(function(c){c.Identifier=1})(Re||(e.PrepareSupportDefaultBehavior=Re={}));var Et;(function(c){c.method="textDocument/rename",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Et||(e.RenameRequest=Et={}));var Ot;(function(c){c.method="textDocument/prepareRename",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Ot||(e.PrepareRenameRequest=Ot={}));var Te;(function(c){c.method="workspace/executeCommand",c.messageDirection=i.MessageDirection.clientToServer,c.type=new i.ProtocolRequestType(c.method)})(Te||(e.ExecuteCommandRequest=Te={}));var xe;(function(c){c.method="workspace/applyEdit",c.messageDirection=i.MessageDirection.serverToClient,c.type=new i.ProtocolRequestType("workspace/applyEdit")})(xe||(e.ApplyWorkspaceEditRequest=xe={}))}(un)),un}var Jt={},nr;function si(){if(nr)return Jt;nr=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.createProtocolConnection=void 0;const e=jt();function i(d,s,f,n){return e.ConnectionStrategy.is(n)&&(n={connectionStrategy:n}),(0,e.createMessageConnection)(d,s,f,n)}return Jt.createProtocolConnection=i,Jt}var rr;function ai(){return rr||(rr=1,function(e){var i=rt&&rt.__createBinding||(Object.create?function(n,u,o,r){r===void 0&&(r=o);var l=Object.getOwnPropertyDescriptor(u,o);(!l||("get"in l?!u.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return u[o]}}),Object.defineProperty(n,r,l)}:function(n,u,o,r){r===void 0&&(r=o),n[r]=u[o]}),d=rt&&rt.__exportStar||function(n,u){for(var o in n)o!=="default"&&!Object.prototype.hasOwnProperty.call(u,o)&&i(u,n,o)};Object.defineProperty(e,"__esModule",{value:!0}),e.LSPErrorCodes=e.createProtocolConnection=void 0,d(jt(),e),d(gn,e),d(Z(),e),d(oi(),e);var s=si();Object.defineProperty(e,"createProtocolConnection",{enumerable:!0,get:function(){return s.createProtocolConnection}});var f;(function(n){n.lspReservedErrorRangeStart=-32899,n.RequestFailed=-32803,n.ServerCancelled=-32802,n.ContentModified=-32801,n.RequestCancelled=-32800,n.lspReservedErrorRangeEnd=-32800})(f||(e.LSPErrorCodes=f={}))}(rt)),rt}var ir;function vi(){return ir||(ir=1,function(e){var i=et&&et.__createBinding||(Object.create?function(n,u,o,r){r===void 0&&(r=o);var l=Object.getOwnPropertyDescriptor(u,o);(!l||("get"in l?!u.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return u[o]}}),Object.defineProperty(n,r,l)}:function(n,u,o,r){r===void 0&&(r=o),n[r]=u[o]}),d=et&&et.__exportStar||function(n,u){for(var o in n)o!=="default"&&!Object.prototype.hasOwnProperty.call(u,o)&&i(u,n,o)};Object.defineProperty(e,"__esModule",{value:!0}),e.createProtocolConnection=void 0;const s=Nn();d(Nn(),e),d(ai(),e);function f(n,u,o,r){return(0,s.createMessageConnection)(n,u,o,r)}e.createProtocolConnection=f}(et)),et}var We={},en={},or;function ft(){if(or)return en;or=1,Object.defineProperty(en,"__esModule",{value:!0});let e;function i(){if(e===void 0)throw new Error("No runtime abstraction layer installed");return e}return function(d){function s(f){if(f===void 0)throw new Error("No runtime abstraction layer provided");e=f}d.install=s}(i||(i={})),en.default=i,en}var fe={},sr;function Yt(){if(sr)return fe;sr=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.stringArray=fe.array=fe.func=fe.error=fe.number=fe.string=fe.boolean=void 0;function e(o){return o===!0||o===!1}fe.boolean=e;function i(o){return typeof o=="string"||o instanceof String}fe.string=i;function d(o){return typeof o=="number"||o instanceof Number}fe.number=d;function s(o){return o instanceof Error}fe.error=s;function f(o){return typeof o=="function"}fe.func=f;function n(o){return Array.isArray(o)}fe.array=n;function u(o){return n(o)&&o.every(r=>i(r))}return fe.stringArray=u,fe}var ct={},ar;function Zt(){if(ar)return ct;ar=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.Emitter=ct.Event=void 0;const e=ft();var i;(function(f){const n={dispose(){}};f.None=function(){return n}})(i||(ct.Event=i={}));class d{add(n,u=null,o){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(n),this._contexts.push(u),Array.isArray(o)&&o.push({dispose:()=>this.remove(n,u)})}remove(n,u=null){if(!this._callbacks)return;let o=!1;for(let r=0,l=this._callbacks.length;r<l;r++)if(this._callbacks[r]===n)if(this._contexts[r]===u){this._callbacks.splice(r,1),this._contexts.splice(r,1);return}else o=!0;if(o)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...n){if(!this._callbacks)return[];const u=[],o=this._callbacks.slice(0),r=this._contexts.slice(0);for(let l=0,m=o.length;l<m;l++)try{u.push(o[l].apply(r[l],n))}catch(p){(0,e.default)().console.error(p)}return u}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class s{constructor(n){this._options=n}get event(){return this._event||(this._event=(n,u,o)=>{this._callbacks||(this._callbacks=new d),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(n,u);const r={dispose:()=>{this._callbacks&&(this._callbacks.remove(n,u),r.dispose=s._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(o)&&o.push(r),r}),this._event}fire(n){this._callbacks&&this._callbacks.invoke.call(this._callbacks,n)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}return ct.Emitter=s,s._noop=function(){},ct}var Kt={},cr;function wr(){if(cr)return Kt;cr=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.Semaphore=void 0;const e=ft();class i{constructor(s=1){if(s<=0)throw new Error("Capacity must be greater than 0");this._capacity=s,this._active=0,this._waiting=[]}lock(s){return new Promise((f,n)=>{this._waiting.push({thunk:s,resolve:f,reject:n}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,e.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const s=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const f=s.thunk();f instanceof Promise?f.then(n=>{this._active--,s.resolve(n),this.runNext()},n=>{this._active--,s.reject(n),this.runNext()}):(this._active--,s.resolve(f),this.runNext())}catch(f){this._active--,s.reject(f),this.runNext()}}}return Kt.Semaphore=i,Kt}var ur;function Sr(){if(ur)return We;ur=1,Object.defineProperty(We,"__esModule",{value:!0}),We.ReadableStreamMessageReader=We.AbstractMessageReader=We.MessageReader=void 0;const e=ft(),i=Yt(),d=Zt(),s=wr();var f;(function(r){function l(m){let p=m;return p&&i.func(p.listen)&&i.func(p.dispose)&&i.func(p.onError)&&i.func(p.onClose)&&i.func(p.onPartialMessage)}r.is=l})(f||(We.MessageReader=f={}));class n{constructor(){this.errorEmitter=new d.Emitter,this.closeEmitter=new d.Emitter,this.partialMessageEmitter=new d.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(l){this.errorEmitter.fire(this.asError(l))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(l){this.partialMessageEmitter.fire(l)}asError(l){return l instanceof Error?l:new Error(`Reader received error. Reason: ${i.string(l.message)?l.message:"unknown"}`)}}We.AbstractMessageReader=n;var u;(function(r){function l(m){let p,y;const v=new Map;let P;const B=new Map;if(m===void 0||typeof m=="string")p=m??"utf-8";else{if(p=m.charset??"utf-8",m.contentDecoder!==void 0&&(y=m.contentDecoder,v.set(y.name,y)),m.contentDecoders!==void 0)for(const I of m.contentDecoders)v.set(I.name,I);if(m.contentTypeDecoder!==void 0&&(P=m.contentTypeDecoder,B.set(P.name,P)),m.contentTypeDecoders!==void 0)for(const I of m.contentTypeDecoders)B.set(I.name,I)}return P===void 0&&(P=(0,e.default)().applicationJson.decoder,B.set(P.name,P)),{charset:p,contentDecoder:y,contentDecoders:v,contentTypeDecoder:P,contentTypeDecoders:B}}r.fromOptions=l})(u||(u={}));class o extends n{constructor(l,m){super(),this.readable=l,this.options=u.fromOptions(m),this.buffer=(0,e.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new s.Semaphore(1)}set partialMessageTimeout(l){this._partialMessageTimeout=l}get partialMessageTimeout(){return this._partialMessageTimeout}listen(l){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=l;const m=this.readable.onData(p=>{this.onData(p)});return this.readable.onError(p=>this.fireError(p)),this.readable.onClose(()=>this.fireClose()),m}onData(l){try{for(this.buffer.append(l);;){if(this.nextMessageLength===-1){const p=this.buffer.tryReadHeaders(!0);if(!p)return;const y=p.get("content-length");if(!y){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(p))}`));return}const v=parseInt(y);if(isNaN(v)){this.fireError(new Error(`Content-Length value must be a number. Got ${y}`));return}this.nextMessageLength=v}const m=this.buffer.tryReadBody(this.nextMessageLength);if(m===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const p=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(m):m,y=await this.options.contentTypeDecoder.decode(p,this.options);this.callback(y)}).catch(p=>{this.fireError(p)})}}catch(m){this.fireError(m)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,e.default)().timer.setTimeout((l,m)=>{this.partialMessageTimer=void 0,l===this.messageToken&&(this.firePartialMessage({messageToken:l,waitingTime:m}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}return We.ReadableStreamMessageReader=o,We}var ci=Sr();class bi extends ci.AbstractMessageReader{socket;state="initial";callback;events=[];constructor(i){super(),this.socket=i,this.socket.onMessage(d=>this.readMessage(d)),this.socket.onError(d=>this.fireError(d)),this.socket.onClose((d,s)=>{if(d!==1e3){const f={name:""+d,message:`Error during socket reconnect: code = ${d}, reason = ${s}`};this.fireError(f)}this.fireClose()})}listen(i){if(this.state==="initial")for(this.state="listening",this.callback=i;this.events.length!==0;){const d=this.events.pop();d.message!==void 0?this.readMessage(d.message):d.error!==void 0?this.fireError(d.error):this.fireClose()}return{dispose:()=>{this.callback===i&&(this.state="initial",this.callback=void 0)}}}dispose(){super.dispose(),this.state="initial",this.callback=void 0,this.events.splice(0,this.events.length)}readMessage(i){if(this.state==="initial")this.events.splice(0,0,{message:i});else if(this.state==="listening")try{const d=JSON.parse(i);this.callback(d)}catch(d){const s={name:"400",message:`Error during message parsing, reason = ${typeof d=="object"?d.message:"unknown"}`};this.fireError(s)}}fireError(i){this.state==="initial"?this.events.splice(0,0,{error:i}):this.state==="listening"&&super.fireError(i)}fireClose(){this.state==="initial"?this.events.splice(0,0,{}):this.state==="listening"&&super.fireClose(),this.state="closed"}}var Be={},lr;function Dr(){if(lr)return Be;lr=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.WriteableStreamMessageWriter=Be.AbstractMessageWriter=Be.MessageWriter=void 0;const e=ft(),i=Yt(),d=wr(),s=Zt(),f="Content-Length: ",n=`\r
`;var u;(function(m){function p(y){let v=y;return v&&i.func(v.dispose)&&i.func(v.onClose)&&i.func(v.onError)&&i.func(v.write)}m.is=p})(u||(Be.MessageWriter=u={}));class o{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(p,y,v){this.errorEmitter.fire([this.asError(p),y,v])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(p){return p instanceof Error?p:new Error(`Writer received error. Reason: ${i.string(p.message)?p.message:"unknown"}`)}}Be.AbstractMessageWriter=o;var r;(function(m){function p(y){return y===void 0||typeof y=="string"?{charset:y??"utf-8",contentTypeEncoder:(0,e.default)().applicationJson.encoder}:{charset:y.charset??"utf-8",contentEncoder:y.contentEncoder,contentTypeEncoder:y.contentTypeEncoder??(0,e.default)().applicationJson.encoder}}m.fromOptions=p})(r||(r={}));class l extends o{constructor(p,y){super(),this.writable=p,this.options=r.fromOptions(y),this.errorCount=0,this.writeSemaphore=new d.Semaphore(1),this.writable.onError(v=>this.fireError(v)),this.writable.onClose(()=>this.fireClose())}async write(p){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(p,this.options).then(v=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(v):v).then(v=>{const P=[];return P.push(f,v.byteLength.toString(),n),P.push(n),this.doWrite(p,P,v)},v=>{throw this.fireError(v),v}))}async doWrite(p,y,v){try{return await this.writable.write(y.join(""),"ascii"),this.writable.write(v)}catch(P){return this.handleError(P,p),Promise.reject(P)}}handleError(p,y){this.errorCount++,this.fireError(p,y,this.errorCount)}end(){this.writable.end()}}return Be.WriteableStreamMessageWriter=l,Be}var ui=Dr();class Ri extends ui.AbstractMessageWriter{errorCount=0;socket;constructor(i){super(),this.socket=i}end(){}async write(i){try{const d=JSON.stringify(i);this.socket.send(d)}catch(d){this.errorCount++,this.fireError(d,i,this.errorCount)}}}var ut={},tn={},ln={},N={},dr;function kr(){if(dr)return N;dr=1,Object.defineProperty(N,"__esModule",{value:!0}),N.Message=N.NotificationType9=N.NotificationType8=N.NotificationType7=N.NotificationType6=N.NotificationType5=N.NotificationType4=N.NotificationType3=N.NotificationType2=N.NotificationType1=N.NotificationType0=N.NotificationType=N.RequestType9=N.RequestType8=N.RequestType7=N.RequestType6=N.RequestType5=N.RequestType4=N.RequestType3=N.RequestType2=N.RequestType1=N.RequestType=N.RequestType0=N.AbstractMessageSignature=N.ParameterStructures=N.ResponseError=N.ErrorCodes=void 0;const e=Yt();var i;(function(_){_.ParseError=-32700,_.InvalidRequest=-32600,_.MethodNotFound=-32601,_.InvalidParams=-32602,_.InternalError=-32603,_.jsonrpcReservedErrorRangeStart=-32099,_.serverErrorStart=-32099,_.MessageWriteError=-32099,_.MessageReadError=-32098,_.PendingResponseRejected=-32097,_.ConnectionInactive=-32096,_.ServerNotInitialized=-32002,_.UnknownErrorCode=-32001,_.jsonrpcReservedErrorRangeEnd=-32e3,_.serverErrorEnd=-32e3})(i||(N.ErrorCodes=i={}));class d extends Error{constructor(a,T,w){super(T),this.code=e.number(a)?a:i.UnknownErrorCode,this.data=w,Object.setPrototypeOf(this,d.prototype)}toJson(){const a={code:this.code,message:this.message};return this.data!==void 0&&(a.data=this.data),a}}N.ResponseError=d;class s{constructor(a){this.kind=a}static is(a){return a===s.auto||a===s.byName||a===s.byPosition}toString(){return this.kind}}N.ParameterStructures=s,s.auto=new s("auto"),s.byPosition=new s("byPosition"),s.byName=new s("byName");class f{constructor(a,T){this.method=a,this.numberOfParams=T}get parameterStructures(){return s.auto}}N.AbstractMessageSignature=f;class n extends f{constructor(a){super(a,0)}}N.RequestType0=n;class u extends f{constructor(a,T=s.auto){super(a,1),this._parameterStructures=T}get parameterStructures(){return this._parameterStructures}}N.RequestType=u;class o extends f{constructor(a,T=s.auto){super(a,1),this._parameterStructures=T}get parameterStructures(){return this._parameterStructures}}N.RequestType1=o;class r extends f{constructor(a){super(a,2)}}N.RequestType2=r;class l extends f{constructor(a){super(a,3)}}N.RequestType3=l;class m extends f{constructor(a){super(a,4)}}N.RequestType4=m;class p extends f{constructor(a){super(a,5)}}N.RequestType5=p;class y extends f{constructor(a){super(a,6)}}N.RequestType6=y;class v extends f{constructor(a){super(a,7)}}N.RequestType7=v;class P extends f{constructor(a){super(a,8)}}N.RequestType8=P;class B extends f{constructor(a){super(a,9)}}N.RequestType9=B;class I extends f{constructor(a,T=s.auto){super(a,1),this._parameterStructures=T}get parameterStructures(){return this._parameterStructures}}N.NotificationType=I;class C extends f{constructor(a){super(a,0)}}N.NotificationType0=C;class k extends f{constructor(a,T=s.auto){super(a,1),this._parameterStructures=T}get parameterStructures(){return this._parameterStructures}}N.NotificationType1=k;class $ extends f{constructor(a){super(a,2)}}N.NotificationType2=$;class Q extends f{constructor(a){super(a,3)}}N.NotificationType3=Q;class ce extends f{constructor(a){super(a,4)}}N.NotificationType4=ce;class J extends f{constructor(a){super(a,5)}}N.NotificationType5=J;class K extends f{constructor(a){super(a,6)}}N.NotificationType6=K;class se extends f{constructor(a){super(a,7)}}N.NotificationType7=se;class ne extends f{constructor(a){super(a,8)}}N.NotificationType8=ne;class _e extends f{constructor(a){super(a,9)}}N.NotificationType9=_e;var U;return function(_){function a(R){const S=R;return S&&e.string(S.method)&&(e.string(S.id)||e.number(S.id))}_.isRequest=a;function T(R){const S=R;return S&&e.string(S.method)&&R.id===void 0}_.isNotification=T;function w(R){const S=R;return S&&(S.result!==void 0||!!S.error)&&(e.string(S.id)||e.number(S.id)||S.id===null)}_.isResponse=w}(U||(N.Message=U={})),N}var He={},fr;function Mr(){if(fr)return He;fr=1;var e;Object.defineProperty(He,"__esModule",{value:!0}),He.LRUCache=He.LinkedMap=He.Touch=void 0;var i;(function(f){f.None=0,f.First=1,f.AsOld=f.First,f.Last=2,f.AsNew=f.Last})(i||(He.Touch=i={}));class d{constructor(){this[e]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(n){return this._map.has(n)}get(n,u=i.None){const o=this._map.get(n);if(o)return u!==i.None&&this.touch(o,u),o.value}set(n,u,o=i.None){let r=this._map.get(n);if(r)r.value=u,o!==i.None&&this.touch(r,o);else{switch(r={key:n,value:u,next:void 0,previous:void 0},o){case i.None:this.addItemLast(r);break;case i.First:this.addItemFirst(r);break;case i.Last:this.addItemLast(r);break;default:this.addItemLast(r);break}this._map.set(n,r),this._size++}return this}delete(n){return!!this.remove(n)}remove(n){const u=this._map.get(n);if(u)return this._map.delete(n),this.removeItem(u),this._size--,u.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const n=this._head;return this._map.delete(n.key),this.removeItem(n),this._size--,n.value}forEach(n,u){const o=this._state;let r=this._head;for(;r;){if(u?n.bind(u)(r.value,r.key,this):n(r.value,r.key,this),this._state!==o)throw new Error("LinkedMap got modified during iteration.");r=r.next}}keys(){const n=this._state;let u=this._head;const o={[Symbol.iterator]:()=>o,next:()=>{if(this._state!==n)throw new Error("LinkedMap got modified during iteration.");if(u){const r={value:u.key,done:!1};return u=u.next,r}else return{value:void 0,done:!0}}};return o}values(){const n=this._state;let u=this._head;const o={[Symbol.iterator]:()=>o,next:()=>{if(this._state!==n)throw new Error("LinkedMap got modified during iteration.");if(u){const r={value:u.value,done:!1};return u=u.next,r}else return{value:void 0,done:!0}}};return o}entries(){const n=this._state;let u=this._head;const o={[Symbol.iterator]:()=>o,next:()=>{if(this._state!==n)throw new Error("LinkedMap got modified during iteration.");if(u){const r={value:[u.key,u.value],done:!1};return u=u.next,r}else return{value:void 0,done:!0}}};return o}[(e=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(n){if(n>=this.size)return;if(n===0){this.clear();return}let u=this._head,o=this.size;for(;u&&o>n;)this._map.delete(u.key),u=u.next,o--;this._head=u,this._size=o,u&&(u.previous=void 0),this._state++}addItemFirst(n){if(!this._head&&!this._tail)this._tail=n;else if(this._head)n.next=this._head,this._head.previous=n;else throw new Error("Invalid list");this._head=n,this._state++}addItemLast(n){if(!this._head&&!this._tail)this._head=n;else if(this._tail)n.previous=this._tail,this._tail.next=n;else throw new Error("Invalid list");this._tail=n,this._state++}removeItem(n){if(n===this._head&&n===this._tail)this._head=void 0,this._tail=void 0;else if(n===this._head){if(!n.next)throw new Error("Invalid list");n.next.previous=void 0,this._head=n.next}else if(n===this._tail){if(!n.previous)throw new Error("Invalid list");n.previous.next=void 0,this._tail=n.previous}else{const u=n.next,o=n.previous;if(!u||!o)throw new Error("Invalid list");u.previous=o,o.next=u}n.next=void 0,n.previous=void 0,this._state++}touch(n,u){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(u!==i.First&&u!==i.Last)){if(u===i.First){if(n===this._head)return;const o=n.next,r=n.previous;n===this._tail?(r.next=void 0,this._tail=r):(o.previous=r,r.next=o),n.previous=void 0,n.next=this._head,this._head.previous=n,this._head=n,this._state++}else if(u===i.Last){if(n===this._tail)return;const o=n.next,r=n.previous;n===this._head?(o.previous=void 0,this._head=o):(o.previous=r,r.next=o),n.next=void 0,n.previous=this._tail,this._tail.next=n,this._tail=n,this._state++}}}toJSON(){const n=[];return this.forEach((u,o)=>{n.push([o,u])}),n}fromJSON(n){this.clear();for(const[u,o]of n)this.set(u,o)}}He.LinkedMap=d;class s extends d{constructor(n,u=1){super(),this._limit=n,this._ratio=Math.min(Math.max(0,u),1)}get limit(){return this._limit}set limit(n){this._limit=n,this.checkTrim()}get ratio(){return this._ratio}set ratio(n){this._ratio=Math.min(Math.max(0,n),1),this.checkTrim()}get(n,u=i.AsNew){return super.get(n,u)}peek(n){return super.get(n,i.None)}set(n,u){return super.set(n,u,i.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}return He.LRUCache=s,He}var Qt={},hr;function li(){if(hr)return Qt;hr=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.Disposable=void 0;var e;return function(i){function d(s){return{dispose:s}}i.create=d}(e||(Qt.Disposable=e={})),Qt}var lt={},mr;function pn(){if(mr)return lt;mr=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.CancellationTokenSource=lt.CancellationToken=void 0;const e=ft(),i=Yt(),d=Zt();var s;(function(o){o.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:d.Event.None}),o.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:d.Event.None});function r(l){const m=l;return m&&(m===o.None||m===o.Cancelled||i.boolean(m.isCancellationRequested)&&!!m.onCancellationRequested)}o.is=r})(s||(lt.CancellationToken=s={}));const f=Object.freeze(function(o,r){const l=(0,e.default)().timer.setTimeout(o.bind(r),0);return{dispose(){l.dispose()}}});class n{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?f:(this._emitter||(this._emitter=new d.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class u{get token(){return this._token||(this._token=new n),this._token}cancel(){this._token?this._token.cancel():this._token=s.Cancelled}dispose(){this._token?this._token instanceof n&&this._token.dispose():this._token=s.None}}return lt.CancellationTokenSource=u,lt}var dt={},gr;function di(){if(gr)return dt;gr=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.SharedArrayReceiverStrategy=dt.SharedArraySenderStrategy=void 0;const e=pn();var i;(function(u){u.Continue=0,u.Cancelled=1})(i||(i={}));class d{constructor(){this.buffers=new Map}enableCancellation(o){if(o.id===null)return;const r=new SharedArrayBuffer(4),l=new Int32Array(r,0,1);l[0]=i.Continue,this.buffers.set(o.id,r),o.$cancellationData=r}async sendCancellation(o,r){const l=this.buffers.get(r);if(l===void 0)return;const m=new Int32Array(l,0,1);Atomics.store(m,0,i.Cancelled)}cleanup(o){this.buffers.delete(o)}dispose(){this.buffers.clear()}}dt.SharedArraySenderStrategy=d;class s{constructor(o){this.data=new Int32Array(o,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===i.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class f{constructor(o){this.token=new s(o)}cancel(){}dispose(){}}class n{constructor(){this.kind="request"}createCancellationTokenSource(o){const r=o.$cancellationData;return r===void 0?new e.CancellationTokenSource:new f(r)}}return dt.SharedArrayReceiverStrategy=n,dt}var Gt={},yr;function fi(){if(yr)return Gt;yr=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.AbstractMessageBuffer=void 0;const e=13,i=10,d=`\r
`;class s{constructor(n="utf-8"){this._encoding=n,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(n){const u=typeof n=="string"?this.fromString(n,this._encoding):n;this._chunks.push(u),this._totalLength+=u.byteLength}tryReadHeaders(n=!1){if(this._chunks.length===0)return;let u=0,o=0,r=0,l=0;e:for(;o<this._chunks.length;){const v=this._chunks[o];for(r=0;r<v.length;){switch(v[r]){case e:switch(u){case 0:u=1;break;case 2:u=3;break;default:u=0}break;case i:switch(u){case 1:u=2;break;case 3:u=4,r++;break e;default:u=0}break;default:u=0}r++}l+=v.byteLength,o++}if(u!==4)return;const m=this._read(l+r),p=new Map,y=this.toString(m,"ascii").split(d);if(y.length<2)return p;for(let v=0;v<y.length-2;v++){const P=y[v],B=P.indexOf(":");if(B===-1)throw new Error(`Message header must separate key and value using ':'
${P}`);const I=P.substr(0,B),C=P.substr(B+1).trim();p.set(n?I.toLowerCase():I,C)}return p}tryReadBody(n){if(!(this._totalLength<n))return this._read(n)}get numberOfBytes(){return this._totalLength}_read(n){if(n===0)return this.emptyBuffer();if(n>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===n){const l=this._chunks[0];return this._chunks.shift(),this._totalLength-=n,this.asNative(l)}if(this._chunks[0].byteLength>n){const l=this._chunks[0],m=this.asNative(l,n);return this._chunks[0]=l.slice(n),this._totalLength-=n,m}const u=this.allocNative(n);let o=0,r=0;for(;n>0;){const l=this._chunks[r];if(l.byteLength>n){const m=l.slice(0,n);u.set(m,o),o+=n,this._chunks[r]=l.slice(n),this._totalLength-=n,n-=n}else u.set(l,o),o+=l.byteLength,this._chunks.shift(),this._totalLength-=l.byteLength,n-=l.byteLength}return u}}return Gt.AbstractMessageBuffer=s,Gt}var dn={},pr;function hi(){return pr||(pr=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.ConnectionOptions=e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.RequestCancellationReceiverStrategy=e.IdCancellationReceiverStrategy=e.ConnectionStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=e.NullLogger=e.ProgressType=e.ProgressToken=void 0;const i=ft(),d=Yt(),s=kr(),f=Mr(),n=Zt(),u=pn();var o;(function(a){a.type=new s.NotificationType("$/cancelRequest")})(o||(o={}));var r;(function(a){function T(w){return typeof w=="string"||typeof w=="number"}a.is=T})(r||(e.ProgressToken=r={}));var l;(function(a){a.type=new s.NotificationType("$/progress")})(l||(l={}));class m{constructor(){}}e.ProgressType=m;var p;(function(a){function T(w){return d.func(w)}a.is=T})(p||(p={})),e.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var y;(function(a){a[a.Off=0]="Off",a[a.Messages=1]="Messages",a[a.Compact=2]="Compact",a[a.Verbose=3]="Verbose"})(y||(e.Trace=y={}));var v;(function(a){a.Off="off",a.Messages="messages",a.Compact="compact",a.Verbose="verbose"})(v||(e.TraceValues=v={})),function(a){function T(R){if(!d.string(R))return a.Off;switch(R=R.toLowerCase(),R){case"off":return a.Off;case"messages":return a.Messages;case"compact":return a.Compact;case"verbose":return a.Verbose;default:return a.Off}}a.fromString=T;function w(R){switch(R){case a.Off:return"off";case a.Messages:return"messages";case a.Compact:return"compact";case a.Verbose:return"verbose";default:return"off"}}a.toString=w}(y||(e.Trace=y={}));var P;(function(a){a.Text="text",a.JSON="json"})(P||(e.TraceFormat=P={})),function(a){function T(w){return d.string(w)?(w=w.toLowerCase(),w==="json"?a.JSON:a.Text):a.Text}a.fromString=T}(P||(e.TraceFormat=P={}));var B;(function(a){a.type=new s.NotificationType("$/setTrace")})(B||(e.SetTraceNotification=B={}));var I;(function(a){a.type=new s.NotificationType("$/logTrace")})(I||(e.LogTraceNotification=I={}));var C;(function(a){a[a.Closed=1]="Closed",a[a.Disposed=2]="Disposed",a[a.AlreadyListening=3]="AlreadyListening"})(C||(e.ConnectionErrors=C={}));class k extends Error{constructor(T,w){super(w),this.code=T,Object.setPrototypeOf(this,k.prototype)}}e.ConnectionError=k;var $;(function(a){function T(w){const R=w;return R&&d.func(R.cancelUndispatched)}a.is=T})($||(e.ConnectionStrategy=$={}));var Q;(function(a){function T(w){const R=w;return R&&(R.kind===void 0||R.kind==="id")&&d.func(R.createCancellationTokenSource)&&(R.dispose===void 0||d.func(R.dispose))}a.is=T})(Q||(e.IdCancellationReceiverStrategy=Q={}));var ce;(function(a){function T(w){const R=w;return R&&R.kind==="request"&&d.func(R.createCancellationTokenSource)&&(R.dispose===void 0||d.func(R.dispose))}a.is=T})(ce||(e.RequestCancellationReceiverStrategy=ce={}));var J;(function(a){a.Message=Object.freeze({createCancellationTokenSource(w){return new u.CancellationTokenSource}});function T(w){return Q.is(w)||ce.is(w)}a.is=T})(J||(e.CancellationReceiverStrategy=J={}));var K;(function(a){a.Message=Object.freeze({sendCancellation(w,R){return w.sendNotification(o.type,{id:R})},cleanup(w){}});function T(w){const R=w;return R&&d.func(R.sendCancellation)&&d.func(R.cleanup)}a.is=T})(K||(e.CancellationSenderStrategy=K={}));var se;(function(a){a.Message=Object.freeze({receiver:J.Message,sender:K.Message});function T(w){const R=w;return R&&J.is(R.receiver)&&K.is(R.sender)}a.is=T})(se||(e.CancellationStrategy=se={}));var ne;(function(a){function T(w){const R=w;return R&&d.func(R.handleMessage)}a.is=T})(ne||(e.MessageStrategy=ne={}));var _e;(function(a){function T(w){const R=w;return R&&(se.is(R.cancellationStrategy)||$.is(R.connectionStrategy)||ne.is(R.messageStrategy))}a.is=T})(_e||(e.ConnectionOptions=_e={}));var U;(function(a){a[a.New=1]="New",a[a.Listening=2]="Listening",a[a.Closed=3]="Closed",a[a.Disposed=4]="Disposed"})(U||(U={}));function _(a,T,w,R){const S=w!==void 0?w:e.NullLogger;let ht=0,mt=0,gt=0;const pe="2.0";let ve;const we=new Map;let be;const Se=new Map,De=new Map;let Ce,ue=new f.LinkedMap,ae=new Map,ke=new Set,x=new Map,O=y.Off,le=P.Text,H,re=U.New;const qe=new n.Emitter,ze=new n.Emitter,Ue=new n.Emitter,Ve=new n.Emitter,Je=new n.Emitter,ie=R&&R.cancellationStrategy?R.cancellationStrategy:se.Message;function Ke(t){if(t===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+t.toString()}function yt(t){return t===null?"res-unknown-"+(++gt).toString():"res-"+t.toString()}function pt(){return"not-"+(++mt).toString()}function vt(t,h){s.Message.isRequest(h)?t.set(Ke(h.id),h):s.Message.isResponse(h)?t.set(yt(h.id),h):t.set(pt(),h)}function bt(t){}function Qe(){return re===U.Listening}function Ge(){return re===U.Closed}function he(){return re===U.Disposed}function Xe(){(re===U.New||re===U.Listening)&&(re=U.Closed,ze.fire(void 0))}function Rt(t){qe.fire([t,void 0,void 0])}function Tt(t){qe.fire(t)}a.onClose(Xe),a.onError(Rt),T.onClose(Xe),T.onError(Tt);function Ye(){Ce||ue.size===0||(Ce=(0,i.default)().timer.setImmediate(()=>{Ce=void 0,_t()}))}function Ze(t){s.Message.isRequest(t)?wt(t):s.Message.isNotification(t)?Dt(t):s.Message.isResponse(t)?St(t):kt(t)}function _t(){if(ue.size===0)return;const t=ue.shift();try{const h=R?.messageStrategy;ne.is(h)?h.handleMessage(t,Ze):Ze(t)}finally{Ye()}}const Pt=t=>{try{if(s.Message.isNotification(t)&&t.method===o.type.method){const h=t.params.id,g=Ke(h),b=ue.get(g);if(s.Message.isRequest(b)){const E=R?.connectionStrategy,F=E&&E.cancelUndispatched?E.cancelUndispatched(b,bt):void 0;if(F&&(F.error!==void 0||F.result!==void 0)){ue.delete(g),x.delete(h),F.id=b.id,Me(F,t.method,Date.now()),T.write(F).catch(()=>S.error("Sending response for canceled message failed."));return}}const L=x.get(h);if(L!==void 0){L.cancel(),Ne(t);return}else ke.add(h)}vt(ue,t)}finally{Ye()}};function wt(t){if(he())return;function h(D,A,M){const z={jsonrpc:pe,id:t.id};D instanceof s.ResponseError?z.error=D.toJson():z.result=D===void 0?null:D,Me(z,A,M),T.write(z).catch(()=>S.error("Sending response failed."))}function g(D,A,M){const z={jsonrpc:pe,id:t.id,error:D.toJson()};Me(z,A,M),T.write(z).catch(()=>S.error("Sending response failed."))}function b(D,A,M){D===void 0&&(D=null);const z={jsonrpc:pe,id:t.id,result:D};Me(z,A,M),T.write(z).catch(()=>S.error("Sending response failed."))}qt(t);const L=we.get(t.method);let E,F;L&&(E=L.type,F=L.handler);const W=Date.now();if(F||ve){const D=t.id??String(Date.now()),A=Q.is(ie.receiver)?ie.receiver.createCancellationTokenSource(D):ie.receiver.createCancellationTokenSource(t);t.id!==null&&ke.has(t.id)&&A.cancel(),t.id!==null&&x.set(D,A);try{let M;if(F)if(t.params===void 0){if(E!==void 0&&E.numberOfParams!==0){g(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${t.method} defines ${E.numberOfParams} params but received none.`),t.method,W);return}M=F(A.token)}else if(Array.isArray(t.params)){if(E!==void 0&&E.parameterStructures===s.ParameterStructures.byName){g(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${t.method} defines parameters by name but received parameters by position`),t.method,W);return}M=F(...t.params,A.token)}else{if(E!==void 0&&E.parameterStructures===s.ParameterStructures.byPosition){g(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${t.method} defines parameters by position but received parameters by name`),t.method,W);return}M=F(t.params,A.token)}else ve&&(M=ve(t.method,t.params,A.token));const z=M;M?z.then?z.then(V=>{x.delete(D),h(V,t.method,W)},V=>{x.delete(D),V instanceof s.ResponseError?g(V,t.method,W):V&&d.string(V.message)?g(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${t.method} failed with message: ${V.message}`),t.method,W):g(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${t.method} failed unexpectedly without providing any details.`),t.method,W)}):(x.delete(D),h(M,t.method,W)):(x.delete(D),b(M,t.method,W))}catch(M){x.delete(D),M instanceof s.ResponseError?h(M,t.method,W):M&&d.string(M.message)?g(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${t.method} failed with message: ${M.message}`),t.method,W):g(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${t.method} failed unexpectedly without providing any details.`),t.method,W)}}else g(new s.ResponseError(s.ErrorCodes.MethodNotFound,`Unhandled method ${t.method}`),t.method,W)}function St(t){if(!he())if(t.id===null)t.error?S.error(`Received response message without id: Error is: 
${JSON.stringify(t.error,void 0,4)}`):S.error("Received response message without id. No further error information provided.");else{const h=t.id,g=ae.get(h);if(Nt(t,g),g!==void 0){ae.delete(h);try{if(t.error){const b=t.error;g.reject(new s.ResponseError(b.code,b.message,b.data))}else if(t.result!==void 0)g.resolve(t.result);else throw new Error("Should never happen.")}catch(b){b.message?S.error(`Response handler '${g.method}' failed with message: ${b.message}`):S.error(`Response handler '${g.method}' failed unexpectedly.`)}}}}function Dt(t){if(he())return;let h,g;if(t.method===o.type.method){const b=t.params.id;ke.delete(b),Ne(t);return}else{const b=Se.get(t.method);b&&(g=b.handler,h=b.type)}if(g||be)try{if(Ne(t),g)if(t.params===void 0)h!==void 0&&h.numberOfParams!==0&&h.parameterStructures!==s.ParameterStructures.byName&&S.error(`Notification ${t.method} defines ${h.numberOfParams} params but received none.`),g();else if(Array.isArray(t.params)){const b=t.params;t.method===l.type.method&&b.length===2&&r.is(b[0])?g({token:b[0],value:b[1]}):(h!==void 0&&(h.parameterStructures===s.ParameterStructures.byName&&S.error(`Notification ${t.method} defines parameters by name but received parameters by position`),h.numberOfParams!==t.params.length&&S.error(`Notification ${t.method} defines ${h.numberOfParams} params but received ${b.length} arguments`)),g(...b))}else h!==void 0&&h.parameterStructures===s.ParameterStructures.byPosition&&S.error(`Notification ${t.method} defines parameters by position but received parameters by name`),g(t.params);else be&&be(t.method,t.params)}catch(b){b.message?S.error(`Notification handler '${t.method}' failed with message: ${b.message}`):S.error(`Notification handler '${t.method}' failed unexpectedly.`)}else Ue.fire(t)}function kt(t){if(!t){S.error("Received empty message.");return}S.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(t,null,4)}`);const h=t;if(d.string(h.id)||d.number(h.id)){const g=h.id,b=ae.get(g);b&&b.reject(new Error("The received response has neither a result nor an error property."))}}function oe(t){if(t!=null)switch(O){case y.Verbose:return JSON.stringify(t,null,4);case y.Compact:return JSON.stringify(t);default:return}}function Mt(t){if(!(O===y.Off||!H))if(le===P.Text){let h;(O===y.Verbose||O===y.Compact)&&t.params&&(h=`Params: ${oe(t.params)}

`),H.log(`Sending request '${t.method} - (${t.id})'.`,h)}else me("send-request",t)}function Ct(t){if(!(O===y.Off||!H))if(le===P.Text){let h;(O===y.Verbose||O===y.Compact)&&(t.params?h=`Params: ${oe(t.params)}

`:h=`No parameters provided.

`),H.log(`Sending notification '${t.method}'.`,h)}else me("send-notification",t)}function Me(t,h,g){if(!(O===y.Off||!H))if(le===P.Text){let b;(O===y.Verbose||O===y.Compact)&&(t.error&&t.error.data?b=`Error data: ${oe(t.error.data)}

`:t.result?b=`Result: ${oe(t.result)}

`:t.error===void 0&&(b=`No result returned.

`)),H.log(`Sending response '${h} - (${t.id})'. Processing request took ${Date.now()-g}ms`,b)}else me("send-response",t)}function qt(t){if(!(O===y.Off||!H))if(le===P.Text){let h;(O===y.Verbose||O===y.Compact)&&t.params&&(h=`Params: ${oe(t.params)}

`),H.log(`Received request '${t.method} - (${t.id})'.`,h)}else me("receive-request",t)}function Ne(t){if(!(O===y.Off||!H||t.method===I.type.method))if(le===P.Text){let h;(O===y.Verbose||O===y.Compact)&&(t.params?h=`Params: ${oe(t.params)}

`:h=`No parameters provided.

`),H.log(`Received notification '${t.method}'.`,h)}else me("receive-notification",t)}function Nt(t,h){if(!(O===y.Off||!H))if(le===P.Text){let g;if((O===y.Verbose||O===y.Compact)&&(t.error&&t.error.data?g=`Error data: ${oe(t.error.data)}

`:t.result?g=`Result: ${oe(t.result)}

`:t.error===void 0&&(g=`No result returned.

`)),h){const b=t.error?` Request failed: ${t.error.message} (${t.error.code}).`:"";H.log(`Received response '${h.method} - (${t.id})' in ${Date.now()-h.timerStart}ms.${b}`,g)}else H.log(`Received response ${t.id} without active response promise.`,g)}else me("receive-response",t)}function me(t,h){if(!H||O===y.Off)return;const g={isLSPMessage:!0,type:t,message:h,timestamp:Date.now()};H.log(g)}function Re(){if(Ge())throw new k(C.Closed,"Connection is closed.");if(he())throw new k(C.Disposed,"Connection is disposed.")}function Et(){if(Qe())throw new k(C.AlreadyListening,"Connection is already listening")}function Ot(){if(!Qe())throw new Error("Call listen() first.")}function Te(t){return t===void 0?null:t}function xe(t){if(t!==null)return t}function c(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function G(t,h){switch(t){case s.ParameterStructures.auto:return c(h)?xe(h):[Te(h)];case s.ParameterStructures.byName:if(!c(h))throw new Error("Received parameters by name but param is not an object literal.");return xe(h);case s.ParameterStructures.byPosition:return[Te(h)];default:throw new Error(`Unknown parameter structure ${t.toString()}`)}}function X(t,h){let g;const b=t.numberOfParams;switch(b){case 0:g=void 0;break;case 1:g=G(t.parameterStructures,h[0]);break;default:g=[];for(let L=0;L<h.length&&L<b;L++)g.push(Te(h[L]));if(h.length<b)for(let L=h.length;L<b;L++)g.push(null);break}return g}const j={sendNotification:(t,...h)=>{Re();let g,b;if(d.string(t)){g=t;const E=h[0];let F=0,W=s.ParameterStructures.auto;s.ParameterStructures.is(E)&&(F=1,W=E);let D=h.length;const A=D-F;switch(A){case 0:b=void 0;break;case 1:b=G(W,h[F]);break;default:if(W===s.ParameterStructures.byName)throw new Error(`Received ${A} parameters for 'by Name' notification parameter structure.`);b=h.slice(F,D).map(M=>Te(M));break}}else{const E=h;g=t.method,b=X(t,E)}const L={jsonrpc:pe,method:g,params:b};return Ct(L),T.write(L).catch(E=>{throw S.error("Sending notification failed."),E})},onNotification:(t,h)=>{Re();let g;return d.func(t)?be=t:h&&(d.string(t)?(g=t,Se.set(t,{type:void 0,handler:h})):(g=t.method,Se.set(t.method,{type:t,handler:h}))),{dispose:()=>{g!==void 0?Se.delete(g):be=void 0}}},onProgress:(t,h,g)=>{if(De.has(h))throw new Error(`Progress handler for token ${h} already registered`);return De.set(h,g),{dispose:()=>{De.delete(h)}}},sendProgress:(t,h,g)=>j.sendNotification(l.type,{token:h,value:g}),onUnhandledProgress:Ve.event,sendRequest:(t,...h)=>{Re(),Ot();let g,b,L;if(d.string(t)){g=t;const D=h[0],A=h[h.length-1];let M=0,z=s.ParameterStructures.auto;s.ParameterStructures.is(D)&&(M=1,z=D);let V=h.length;u.CancellationToken.is(A)&&(V=V-1,L=A);const ee=V-M;switch(ee){case 0:b=void 0;break;case 1:b=G(z,h[M]);break;default:if(z===s.ParameterStructures.byName)throw new Error(`Received ${ee} parameters for 'by Name' request parameter structure.`);b=h.slice(M,V).map(on=>Te(on));break}}else{const D=h;g=t.method,b=X(t,D);const A=t.numberOfParams;L=u.CancellationToken.is(D[A])?D[A]:void 0}const E=ht++;let F;L&&(F=L.onCancellationRequested(()=>{const D=ie.sender.sendCancellation(j,E);return D===void 0?(S.log(`Received no promise from cancellation strategy when cancelling id ${E}`),Promise.resolve()):D.catch(()=>{S.log(`Sending cancellation messages for id ${E} failed`)})}));const W={jsonrpc:pe,id:E,method:g,params:b};return Mt(W),typeof ie.sender.enableCancellation=="function"&&ie.sender.enableCancellation(W),new Promise(async(D,A)=>{const M=ee=>{D(ee),ie.sender.cleanup(E),F?.dispose()},z=ee=>{A(ee),ie.sender.cleanup(E),F?.dispose()},V={method:g,timerStart:Date.now(),resolve:M,reject:z};try{ae.set(E,V),await T.write(W)}catch(ee){throw ae.delete(E),V.reject(new s.ResponseError(s.ErrorCodes.MessageWriteError,ee.message?ee.message:"Unknown reason")),S.error("Sending request failed."),ee}})},onRequest:(t,h)=>{Re();let g=null;return p.is(t)?(g=void 0,ve=t):d.string(t)?(g=null,h!==void 0&&(g=t,we.set(t,{handler:h,type:void 0}))):h!==void 0&&(g=t.method,we.set(t.method,{type:t,handler:h})),{dispose:()=>{g!==null&&(g!==void 0?we.delete(g):ve=void 0)}}},hasPendingResponse:()=>ae.size>0,trace:async(t,h,g)=>{let b=!1,L=P.Text;g!==void 0&&(d.boolean(g)?b=g:(b=g.sendNotification||!1,L=g.traceFormat||P.Text)),O=t,le=L,O===y.Off?H=void 0:H=h,b&&!Ge()&&!he()&&await j.sendNotification(B.type,{value:y.toString(t)})},onError:qe.event,onClose:ze.event,onUnhandledNotification:Ue.event,onDispose:Je.event,end:()=>{T.end()},dispose:()=>{if(he())return;re=U.Disposed,Je.fire(void 0);const t=new s.ResponseError(s.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const h of ae.values())h.reject(t);ae=new Map,x=new Map,ke=new Set,ue=new f.LinkedMap,d.func(T.dispose)&&T.dispose(),d.func(a.dispose)&&a.dispose()},listen:()=>{Re(),Et(),re=U.Listening,a.listen(Pt)},inspect:()=>{(0,i.default)().console.log("inspect")}};return j.onNotification(I.type,t=>{if(O===y.Off||!H)return;const h=O===y.Verbose||O===y.Compact;H.log(t.message,h?t.verbose:void 0)}),j.onNotification(l.type,t=>{const h=De.get(t.token);h?h(t.value):Ve.fire(t)}),j}e.createMessageConnection=_}(dn)),dn}var vr;function hn(){return vr||(vr=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProgressType=e.ProgressToken=e.createMessageConnection=e.NullLogger=e.ConnectionOptions=e.ConnectionStrategy=e.AbstractMessageBuffer=e.WriteableStreamMessageWriter=e.AbstractMessageWriter=e.MessageWriter=e.ReadableStreamMessageReader=e.AbstractMessageReader=e.MessageReader=e.SharedArrayReceiverStrategy=e.SharedArraySenderStrategy=e.CancellationToken=e.CancellationTokenSource=e.Emitter=e.Event=e.Disposable=e.LRUCache=e.Touch=e.LinkedMap=e.ParameterStructures=e.NotificationType9=e.NotificationType8=e.NotificationType7=e.NotificationType6=e.NotificationType5=e.NotificationType4=e.NotificationType3=e.NotificationType2=e.NotificationType1=e.NotificationType0=e.NotificationType=e.ErrorCodes=e.ResponseError=e.RequestType9=e.RequestType8=e.RequestType7=e.RequestType6=e.RequestType5=e.RequestType4=e.RequestType3=e.RequestType2=e.RequestType1=e.RequestType0=e.RequestType=e.Message=e.RAL=void 0,e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=void 0;const i=kr();Object.defineProperty(e,"Message",{enumerable:!0,get:function(){return i.Message}}),Object.defineProperty(e,"RequestType",{enumerable:!0,get:function(){return i.RequestType}}),Object.defineProperty(e,"RequestType0",{enumerable:!0,get:function(){return i.RequestType0}}),Object.defineProperty(e,"RequestType1",{enumerable:!0,get:function(){return i.RequestType1}}),Object.defineProperty(e,"RequestType2",{enumerable:!0,get:function(){return i.RequestType2}}),Object.defineProperty(e,"RequestType3",{enumerable:!0,get:function(){return i.RequestType3}}),Object.defineProperty(e,"RequestType4",{enumerable:!0,get:function(){return i.RequestType4}}),Object.defineProperty(e,"RequestType5",{enumerable:!0,get:function(){return i.RequestType5}}),Object.defineProperty(e,"RequestType6",{enumerable:!0,get:function(){return i.RequestType6}}),Object.defineProperty(e,"RequestType7",{enumerable:!0,get:function(){return i.RequestType7}}),Object.defineProperty(e,"RequestType8",{enumerable:!0,get:function(){return i.RequestType8}}),Object.defineProperty(e,"RequestType9",{enumerable:!0,get:function(){return i.RequestType9}}),Object.defineProperty(e,"ResponseError",{enumerable:!0,get:function(){return i.ResponseError}}),Object.defineProperty(e,"ErrorCodes",{enumerable:!0,get:function(){return i.ErrorCodes}}),Object.defineProperty(e,"NotificationType",{enumerable:!0,get:function(){return i.NotificationType}}),Object.defineProperty(e,"NotificationType0",{enumerable:!0,get:function(){return i.NotificationType0}}),Object.defineProperty(e,"NotificationType1",{enumerable:!0,get:function(){return i.NotificationType1}}),Object.defineProperty(e,"NotificationType2",{enumerable:!0,get:function(){return i.NotificationType2}}),Object.defineProperty(e,"NotificationType3",{enumerable:!0,get:function(){return i.NotificationType3}}),Object.defineProperty(e,"NotificationType4",{enumerable:!0,get:function(){return i.NotificationType4}}),Object.defineProperty(e,"NotificationType5",{enumerable:!0,get:function(){return i.NotificationType5}}),Object.defineProperty(e,"NotificationType6",{enumerable:!0,get:function(){return i.NotificationType6}}),Object.defineProperty(e,"NotificationType7",{enumerable:!0,get:function(){return i.NotificationType7}}),Object.defineProperty(e,"NotificationType8",{enumerable:!0,get:function(){return i.NotificationType8}}),Object.defineProperty(e,"NotificationType9",{enumerable:!0,get:function(){return i.NotificationType9}}),Object.defineProperty(e,"ParameterStructures",{enumerable:!0,get:function(){return i.ParameterStructures}});const d=Mr();Object.defineProperty(e,"LinkedMap",{enumerable:!0,get:function(){return d.LinkedMap}}),Object.defineProperty(e,"LRUCache",{enumerable:!0,get:function(){return d.LRUCache}}),Object.defineProperty(e,"Touch",{enumerable:!0,get:function(){return d.Touch}});const s=li();Object.defineProperty(e,"Disposable",{enumerable:!0,get:function(){return s.Disposable}});const f=Zt();Object.defineProperty(e,"Event",{enumerable:!0,get:function(){return f.Event}}),Object.defineProperty(e,"Emitter",{enumerable:!0,get:function(){return f.Emitter}});const n=pn();Object.defineProperty(e,"CancellationTokenSource",{enumerable:!0,get:function(){return n.CancellationTokenSource}}),Object.defineProperty(e,"CancellationToken",{enumerable:!0,get:function(){return n.CancellationToken}});const u=di();Object.defineProperty(e,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return u.SharedArraySenderStrategy}}),Object.defineProperty(e,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return u.SharedArrayReceiverStrategy}});const o=Sr();Object.defineProperty(e,"MessageReader",{enumerable:!0,get:function(){return o.MessageReader}}),Object.defineProperty(e,"AbstractMessageReader",{enumerable:!0,get:function(){return o.AbstractMessageReader}}),Object.defineProperty(e,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return o.ReadableStreamMessageReader}});const r=Dr();Object.defineProperty(e,"MessageWriter",{enumerable:!0,get:function(){return r.MessageWriter}}),Object.defineProperty(e,"AbstractMessageWriter",{enumerable:!0,get:function(){return r.AbstractMessageWriter}}),Object.defineProperty(e,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return r.WriteableStreamMessageWriter}});const l=fi();Object.defineProperty(e,"AbstractMessageBuffer",{enumerable:!0,get:function(){return l.AbstractMessageBuffer}});const m=hi();Object.defineProperty(e,"ConnectionStrategy",{enumerable:!0,get:function(){return m.ConnectionStrategy}}),Object.defineProperty(e,"ConnectionOptions",{enumerable:!0,get:function(){return m.ConnectionOptions}}),Object.defineProperty(e,"NullLogger",{enumerable:!0,get:function(){return m.NullLogger}}),Object.defineProperty(e,"createMessageConnection",{enumerable:!0,get:function(){return m.createMessageConnection}}),Object.defineProperty(e,"ProgressToken",{enumerable:!0,get:function(){return m.ProgressToken}}),Object.defineProperty(e,"ProgressType",{enumerable:!0,get:function(){return m.ProgressType}}),Object.defineProperty(e,"Trace",{enumerable:!0,get:function(){return m.Trace}}),Object.defineProperty(e,"TraceValues",{enumerable:!0,get:function(){return m.TraceValues}}),Object.defineProperty(e,"TraceFormat",{enumerable:!0,get:function(){return m.TraceFormat}}),Object.defineProperty(e,"SetTraceNotification",{enumerable:!0,get:function(){return m.SetTraceNotification}}),Object.defineProperty(e,"LogTraceNotification",{enumerable:!0,get:function(){return m.LogTraceNotification}}),Object.defineProperty(e,"ConnectionErrors",{enumerable:!0,get:function(){return m.ConnectionErrors}}),Object.defineProperty(e,"ConnectionError",{enumerable:!0,get:function(){return m.ConnectionError}}),Object.defineProperty(e,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return m.CancellationReceiverStrategy}}),Object.defineProperty(e,"CancellationSenderStrategy",{enumerable:!0,get:function(){return m.CancellationSenderStrategy}}),Object.defineProperty(e,"CancellationStrategy",{enumerable:!0,get:function(){return m.CancellationStrategy}}),Object.defineProperty(e,"MessageStrategy",{enumerable:!0,get:function(){return m.MessageStrategy}});const p=ft();e.RAL=p.default}(ln)),ln}var br;function mi(){if(br)return tn;br=1,Object.defineProperty(tn,"__esModule",{value:!0});const e=hn();class i extends e.AbstractMessageBuffer{constructor(r="utf-8"){super(r),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return i.emptyBuffer}fromString(r,l){return new TextEncoder().encode(r)}toString(r,l){return l==="ascii"?this.asciiDecoder.decode(r):new TextDecoder(l).decode(r)}asNative(r,l){return l===void 0?r:r.slice(0,l)}allocNative(r){return new Uint8Array(r)}}i.emptyBuffer=new Uint8Array(0);class d{constructor(r){this.socket=r,this._onData=new e.Emitter,this._messageListener=l=>{l.data.arrayBuffer().then(p=>{this._onData.fire(new Uint8Array(p))},()=>{(0,e.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(r){return this.socket.addEventListener("close",r),e.Disposable.create(()=>this.socket.removeEventListener("close",r))}onError(r){return this.socket.addEventListener("error",r),e.Disposable.create(()=>this.socket.removeEventListener("error",r))}onEnd(r){return this.socket.addEventListener("end",r),e.Disposable.create(()=>this.socket.removeEventListener("end",r))}onData(r){return this._onData.event(r)}}class s{constructor(r){this.socket=r}onClose(r){return this.socket.addEventListener("close",r),e.Disposable.create(()=>this.socket.removeEventListener("close",r))}onError(r){return this.socket.addEventListener("error",r),e.Disposable.create(()=>this.socket.removeEventListener("error",r))}onEnd(r){return this.socket.addEventListener("end",r),e.Disposable.create(()=>this.socket.removeEventListener("end",r))}write(r,l){if(typeof r=="string"){if(l!==void 0&&l!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${l}`);this.socket.send(r)}else this.socket.send(r);return Promise.resolve()}end(){this.socket.close()}}const f=new TextEncoder,n=Object.freeze({messageBuffer:Object.freeze({create:o=>new i(o)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(o,r)=>{if(r.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${r.charset}`);return Promise.resolve(f.encode(JSON.stringify(o,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(o,r)=>{if(!(o instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(r.charset).decode(o)))}})}),stream:Object.freeze({asReadableStream:o=>new d(o),asWritableStream:o=>new s(o)}),console,timer:Object.freeze({setTimeout(o,r,...l){const m=setTimeout(o,r,...l);return{dispose:()=>clearTimeout(m)}},setImmediate(o,...r){const l=setTimeout(o,0,...r);return{dispose:()=>clearTimeout(l)}},setInterval(o,r,...l){const m=setInterval(o,r,...l);return{dispose:()=>clearInterval(m)}}})});function u(){return n}return function(o){function r(){e.RAL.install(n)}o.install=r}(u||(u={})),tn.default=u,tn}var Rr;function gi(){return Rr||(Rr=1,function(e){var i=ut&&ut.__createBinding||(Object.create?function(r,l,m,p){p===void 0&&(p=m);var y=Object.getOwnPropertyDescriptor(l,m);(!y||("get"in y?!l.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return l[m]}}),Object.defineProperty(r,p,y)}:function(r,l,m,p){p===void 0&&(p=m),r[p]=l[m]}),d=ut&&ut.__exportStar||function(r,l){for(var m in r)m!=="default"&&!Object.prototype.hasOwnProperty.call(l,m)&&i(l,r,m)};Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.BrowserMessageWriter=e.BrowserMessageReader=void 0,mi().default.install();const f=hn();d(hn(),e);class n extends f.AbstractMessageReader{constructor(l){super(),this._onData=new f.Emitter,this._messageListener=m=>{this._onData.fire(m.data)},l.addEventListener("error",m=>this.fireError(m)),l.onmessage=this._messageListener}listen(l){return this._onData.event(l)}}e.BrowserMessageReader=n;class u extends f.AbstractMessageWriter{constructor(l){super(),this.port=l,this.errorCount=0,l.addEventListener("error",m=>this.fireError(m))}write(l){try{return this.port.postMessage(l),Promise.resolve()}catch(m){return this.handleError(m,l),Promise.reject(m)}}handleError(l,m){this.errorCount++,this.fireError(l,m,this.errorCount)}end(){}}e.BrowserMessageWriter=u;function o(r,l,m,p){return m===void 0&&(m=f.NullLogger),f.ConnectionStrategy.is(p)&&(p={connectionStrategy:p}),(0,f.createMessageConnection)(r,l,m,p)}e.createMessageConnection=o}(ut)),ut}gi();function Ti(e){return{send:i=>e.send(i),onMessage:i=>{e.onmessage=d=>i(d.data)},onError:i=>{e.onerror=d=>{Object.hasOwn(d,"message")&&i(d.message)}},onClose:i=>{e.onclose=d=>i(d.code,d.reason)},dispose:()=>e.close()}}export{Ri as W,bi as a,vi as r,Ti as t};
